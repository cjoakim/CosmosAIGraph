import time

from pysrc.services.ai_conversation import AiConversation
from pysrc.services.cosmos_vcore_service import CosmosVCoreService
from pysrc.services.config_service import ConfigService
from pysrc.util.fs import FS

# pytest tests/test_cosmos_vcore_service.py
# an actual Cosmos DB Mongo vCore account is used in these tests

def test_conn_str_config():
    ConfigService.set_standard_unit_test_env_vars()
    conn_str = ConfigService.mongo_vcore_conn_str()
    assert conn_str.startswith("mongodb+srv://")
    assert ".mongocluster.cosmos.azure.com" in conn_str


def test_meta_and_crud_operations():
    ConfigService.set_standard_unit_test_env_vars()
    opts = dict()
    opts["conn_string"] = ConfigService.mongo_vcore_conn_str()
    vcore = CosmosVCoreService(opts)
    assert "pymongo.mongo_client.MongoClient" in str(type(vcore.get_client()))

    epoch = int(time.time())
    new_dbname = "tempdb_{}".format(epoch)
    new_collname = "tempcoll_{}".format(epoch)

    try:
        # test initial state:
        # the 'unittests' collection in 'dev' database is assumed to exist.
        dbs = vcore.list_databases()
        assert "dev" in dbs
        vcore.set_db("dev")
        vcore.set_coll("unittests")
        colls = vcore.list_collections()
        assert "unittests" in colls

        # create a temporary database with a temporary collection
        vcore.set_db(new_dbname)
        vcore.set_coll(new_collname)

        # create a document in the temporary collection, read it back and verify
        doc = dict()
        doc["name"] = "testvalue"
        vcore.insert_doc(doc)
        assert vcore.count_docs({}) == 1
        cursor, docs = vcore.find({}), list()
        for doc in cursor:
            docs.append(doc)
        assert len(docs) == 1
        assert docs[0]["name"] == "testvalue"

        # index retrieval and creation
        indexes = vcore.get_coll_indexes(new_collname)
        assert indexes == {"_id_": {"key": [("_id", 1)], "v": 2}}
        vcore.create_simple_index("name")
        indexes = vcore.get_coll_indexes(new_collname)
        assert indexes == {
            "_id_": {"v": 2, "key": [("_id", 1)]},
            "name_1": {"v": 2, "key": [("name", 1)]},
        }

        # veriify that the new database and collection exist
        assert new_dbname in vcore.list_databases()
        assert new_collname in vcore.list_collections()

        # verify that document deletion works
        vcore.delete_many({})
        assert vcore.count_docs({}) == 0

        db_stats = vcore.command_db_stats()
        FS.write_json(db_stats, "tmp/test_cosmos_vcore_service_db_stats.json")
        assert type(db_stats) == dict

        coll_stats = vcore.command_coll_stats(new_collname)
        FS.write_json(coll_stats, "tmp/test_cosmos_vcore_service_coll_stats.json")
        assert type(coll_stats) == dict

        commands = vcore.command_list_commands()
        FS.write_json(commands, "tmp/test_cosmos_vcore_service_commands.json")
        assert type(commands) == dict

        shard_info = vcore.get_shard_info()
        FS.write_json(shard_info, "tmp/test_cosmos_vcore_shard_info.json")
        assert type(shard_info) == dict

        indexes = vcore.get_coll_indexes(new_collname)
        if indexes is not None:
            FS.write_json(indexes, "tmp/test_cosmos_vcore_indexes.json")
            assert type(indexes) == dict

        # cleanup - delete the temporary container and db
        # we want the test to fail if these operations do not succeed
        vcore.delete_container(new_collname)
        assert new_collname not in vcore.list_collections()
        vcore.delete_database(new_dbname)
        assert new_dbname not in vcore.list_databases()
    except Exception as excp:
        print(str(excp))
        vcore.delete_database(new_dbname)
        assert False

    try:
        # cleanup any previous remnant tempdb_ databases with no test assertions
        remnant_dblist = vcore.list_databases()
        FS.write_json(remnant_dblist, "tmp/test_cosmos_vcore_remnant_dblist.json")
        for dbname in remnant_dblist:
            if dbname.startswith("tempdb_"):
                vcore.delete_database(dbname)
    except Exception as excp:
        pass


def test_search_documents_like_library():
    ConfigService.set_standard_unit_test_env_vars()
    opts = dict()
    opts["conn_string"] = ConfigService.mongo_vcore_conn_str()
    vcore = CosmosVCoreService(opts)
    vcore.set_db(ConfigService.graph_source_db())
    vcore.set_coll(ConfigService.documents_container())

    search_result = vcore.search_documents_like_library("pypi", "flask")
    FS.write_json(search_result, "tmp/test_search_documents_like_library.json")

    assert search_result["error"] is None
    assert search_result["doc"] is not None
    assert search_result["count"] > 0
    for doc in search_result["results"]:
        assert doc["_id"] is not None
        assert doc["libtype"] is not None
        assert doc["libname"] is not None
        assert doc["url"] is not None
        assert len(doc["embeddings"]) == 1536

def test_ai_conversation():
    ConfigService.set_standard_unit_test_env_vars()
    opts = dict()
    opts["conn_string"] = ConfigService.mongo_vcore_conn_str()
    vcore = CosmosVCoreService(opts)
    vcore.set_db(ConfigService.graph_source_db())
    vcore.set_coll("conversations")

    conv1 = AiConversation()
    conv1.add_user_message("this is a user message")
    conv1.add_system_message("this is a system message")
    conv1.add_assistant_message("this is an assistant message")
    conv1.add_tool_message("this is an assistant message")
    jstr = conv1.serialize()
    print(jstr)

    bool = vcore.save_conversation(conv1)
    vcore.delete_many({})
    count = vcore.count_docs({})
    assert count == 0

    assert bool is True
    for n in range(0,5):
        bool = vcore.save_conversation(conv1)
        assert bool is True
    count = vcore.count_docs({})
    assert count == 1

    conv2 = vcore.load_conversation(conv1.get_conversation_id())
    assert conv1.get_conversation_id() == conv2.get_conversation_id()
    assert conv1.get_message_count() == conv2.get_message_count()

    conv2.add_user_message("this is another user message")
    bool = vcore.save_conversation(conv2)
    assert bool is True

def test_vector_search():
    ConfigService.set_standard_unit_test_env_vars()
    opts = dict()
    opts["conn_string"] = ConfigService.mongo_vcore_conn_str()
    vcore = CosmosVCoreService(opts)
    vcore.set_db(ConfigService.graph_source_db())
    vcore.set_coll(ConfigService.documents_container())

    text = "four score and seven years ago our fathers brought forth on this continent, a new nation, conceived in Liberty, and dedicated to the proposition"
    vs_result = vcore.vector_search(sample_embeddings())
    FS.write_json(vs_result, "tmp/test_vector_search.json")

    assert vs_result["k"] == 10
    assert vs_result["embeddings_attr"] == "embeddings"
    assert vs_result["count"] > 0
    for doc in vs_result["results"]:
        assert doc["_id"] is not None
        assert doc["libtype"] is not None
        assert doc["libname"] is not None
        assert doc["url"] is not None
        assert len(doc["embeddings"]) == 1536

def sample_embeddings():
    return [
        0.0030290345,
        -0.00155827,
        0.004954154,
        -0.01405472,
        0.013785473,
        0.008817856,
        0.00067816715,
        -0.011840159,
        -0.00062978675,
        -0.017029906,
        0.005687854,
        0.0060412413,
        -0.02985955,
        0.016760658,
        -0.007303339,
        -0.0068018655,
        0.0143239675,
        -0.018712703,
        -0.004940692,
        -0.0008876754,
        -0.009571749,
        -0.008663039,
        -0.009605405,
        -0.006953317,
        -0.04294498,
        0.0074985432,
        -0.005220036,
        -0.016787583,
        0.0061388435,
        -0.018739628,
        0.038610093,
        -0.009585212,
        -0.034867555,
        0.015885603,
        0.006822059,
        -0.005529671,
        0.014768226,
        -0.007962995,
        0.009854459,
        -0.0026335772,
        0.030209571,
        0.031717356,
        0.00663022,
        -0.007572586,
        -0.023814943,
        -0.002993696,
        0.0046344227,
        -0.026480494,
        -0.005694585,
        0.008999598,
        0.016706808,
        0.035944544,
        0.01938582,
        -0.009551556,
        0.022185996,
        -0.013448914,
        -0.008912093,
        0.02000509,
        -0.0022196092,
        -0.004580573,
        0.0027900774,
        -0.0009448905,
        -0.033063594,
        -0.0051089716,
        -0.003124954,
        0.019924317,
        0.0104131475,
        0.032444324,
        -0.00016428306,
        0.0061792303,
        0.027220923,
        0.01513171,
        0.005819112,
        -0.00029512052,
        0.027234387,
        0.021109005,
        -0.01739339,
        0.014539366,
        -0.017554939,
        -0.009228459,
        -0.005711413,
        -0.02470346,
        -0.013442182,
        0.019735843,
        0.014256656,
        0.018281907,
        0.010291986,
        0.017514551,
        -0.008932286,
        -0.008918824,
        -0.00047286594,
        0.018389605,
        0.008023576,
        0.032713573,
        -0.021216704,
        0.004641154,
        0.003739175,
        0.041006397,
        0.0120690195,
        -0.01546827,
        -0.027705569,
        0.013018117,
        0.0037997556,
        -0.018443454,
        -0.02362647,
        -0.0074312314,
        0.024205351,
        -0.017299153,
        0.025349654,
        0.0143778175,
        -0.015347108,
        0.02629202,
        0.0038098523,
        -0.029967248,
        -0.0028220506,
        0.013947021,
        0.0009179658,
        -0.023814943,
        0.008413984,
        -0.018456917,
        0.007599511,
        0.015737517,
        0.0243669,
        -0.013644118,
        0.02749017,
        -0.0052099396,
        -0.01694913,
        0.0028658032,
        -0.009369814,
        -0.014606678,
        0.026574729,
        0.02334376,
        0.0037997556,
        -0.015024011,
        -0.015549044,
        0.008864975,
        -0.024811158,
        -0.002445104,
        0.0018443455,
        -0.0018292003,
        0.012560396,
        0.032309704,
        -0.0154144205,
        -0.012836375,
        0.0076870164,
        0.024582298,
        -0.007108134,
        -0.028405612,
        -0.007895684,
        -0.0034278575,
        0.030128798,
        -0.011772848,
        -0.014889387,
        -0.010042933,
        0.0068018655,
        0.008548609,
        -0.010110244,
        0.013051773,
        0.006549446,
        0.014633602,
        -0.0015061033,
        0.024865009,
        0.004005057,
        -0.016612573,
        0.010944911,
        0.019681994,
        0.010581427,
        -0.002047964,
        -0.019103112,
        0.016397174,
        0.0062229834,
        0.01723184,
        -0.01342872,
        0.004052175,
        0.017191455,
        0.00024947466,
        -0.0176761,
        0.016154852,
        -0.027274773,
        0.008346673,
        -0.013401795,
        -0.0098679215,
        0.0032865026,
        0.043483473,
        -0.017703025,
        -0.029159507,
        -0.010318911,
        -0.0007803971,
        0.012647902,
        0.0036920565,
        0.01659911,
        0.025753524,
        0.00747835,
        -0.01308543,
        -0.6220695,
        -0.016518336,
        0.012210375,
        -0.03150196,
        -0.008878437,
        0.0031215884,
        -0.01331429,
        0.009645793,
        -0.014283581,
        0.0102852555,
        -0.01365758,
        0.038825493,
        0.005903252,
        -0.0015767808,
        -0.009598674,
        -0.018551154,
        0.01672027,
        -0.025026556,
        -0.007781253,
        -0.008972674,
        -0.024070729,
        0.033225145,
        -0.03443676,
        0.031421185,
        -0.011456482,
        0.019480057,
        0.03801775,
        -0.019372359,
        0.00731007,
        0.011119923,
        -0.030774992,
        0.013469107,
        0.024757309,
        -0.01167188,
        0.03801775,
        -0.011059342,
        -0.026534343,
        0.022926426,
        0.026722817,
        0.054872643,
        0.0027463248,
        0.00016480892,
        0.010668932,
        0.018914638,
        -0.02062436,
        -0.0044223904,
        0.035836846,
        -0.0071417904,
        -0.0017652541,
        -0.016289474,
        0.024770772,
        -0.009982351,
        0.005331101,
        0.0020328187,
        0.020368574,
        0.00012799774,
        0.02051666,
        -0.0108506745,
        -0.002628529,
        -0.008265899,
        -0.00028439268,
        0.021809049,
        -0.009470781,
        -0.016235625,
        -0.01575098,
        0.004742122,
        0.006663876,
        -0.0074985432,
        0.025578514,
        -0.02357262,
        0.019480057,
        0.0024249104,
        -0.019116573,
        -0.025955461,
        0.024824621,
        0.04124872,
        0.033575166,
        0.0201801,
        -0.0054253372,
        0.0006331524,
        0.01983008,
        0.011840159,
        -0.016639497,
        -0.019641606,
        0.053068686,
        -0.014297043,
        -0.021835973,
        -0.014350893,
        0.0025561687,
        0.0012343316,
        0.0128633,
        0.011227622,
        -0.02051666,
        -0.011718998,
        -0.015656743,
        0.012419041,
        -0.016222162,
        0.0013496032,
        -0.0061354777,
        -0.034894478,
        -0.0034598305,
        -0.016787583,
        -0.0075120055,
        -0.011523793,
        0.050564684,
        0.022751415,
        0.0043618097,
        0.019601218,
        0.011826697,
        -0.024272664,
        0.0007724038,
        -0.022334082,
        -0.008265899,
        0.013125816,
        0.02516118,
        -0.025901612,
        0.024797697,
        -0.024784233,
        0.008622652,
        -0.017581863,
        0.005166187,
        -0.009760222,
        0.005213305,
        0.009591943,
        -0.0061051873,
        0.021526339,
        0.0040589063,
        0.007296608,
        -0.024461137,
        -0.00055532303,
        0.018053045,
        0.0143778175,
        -0.0027648355,
        -0.0043146913,
        0.032713573,
        0.029105656,
        -0.0011947858,
        -0.0032461153,
        0.0242592,
        -0.00923519,
        -0.010870868,
        0.004907036,
        -0.006556177,
        -0.008360135,
        0.010567965,
        -0.020260876,
        -0.017137604,
        -0.008764006,
        0.006475403,
        -0.00070761616,
        -0.016006764,
        -0.008858243,
        -0.008535147,
        0.021957135,
        0.012802719,
        0.00219605,
        0.012910418,
        -0.011523793,
        -0.0045334552,
        -0.009363082,
        -0.00026272668,
        0.017703025,
        -0.01672027,
        -0.005257058,
        -0.027342085,
        -0.004206992,
        -0.0107766315,
        0.024434213,
        0.009470781,
        -0.051183954,
        -0.000903662,
        -0.013321021,
        -0.0073369946,
        0.0072898767,
        0.0031535616,
        0.023357222,
        -0.01552212,
        -0.00071140245,
        0.000032630483,
        -0.014148957,
        -0.0027244482,
        0.013448914,
        -0.013920097,
        -0.0015431248,
        0.020772446,
        0.012890225,
        -0.0041060247,
        0.03699461,
        -0.026655504,
        -0.0026958408,
        0.0098679215,
        -0.0032545293,
        -0.0032629434,
        0.031232713,
        -0.014270118,
        -0.0036180136,
        -0.0092486525,
        -0.00014598263,
        -0.0027278138,
        0.036186866,
        -0.005122434,
        0.024501525,
        -0.0004960044,
        -0.021122467,
        -0.0065258867,
        -0.03467908,
        0.025336191,
        -0.0068658115,
        0.019372359,
        -0.000710561,
        0.0121296,
        0.0058494024,
        -0.042729583,
        -0.033359766,
        0.00075894146,
        0.011523793,
        -0.004011788,
        0.0034345887,
        -0.018174207,
        0.0067513813,
        0.0039007233,
        0.017097218,
        0.008037038,
        -0.008710157,
        -0.0017265497,
        -0.011146847,
        -0.005166187,
        0.009531362,
        -0.0009238555,
        -0.05010696,
        -0.018120358,
        0.016733734,
        -0.008568802,
        -0.0062095206,
        0.043887347,
        -0.0065191556,
        0.018672315,
        -0.051937845,
        0.038448546,
        -0.012769063,
        0.026924752,
        -0.00467481,
        0.022751415,
        0.0002827099,
        0.000279765,
        0.0053681224,
        0.03933706,
        0.016195238,
        -0.03540605,
        0.0011140116,
        -0.0014329016,
        -0.014297043,
        -0.013623924,
        -0.0052873483,
        0.03540605,
        0.0071889088,
        -0.001313423,
        -0.0076533607,
        0.01552212,
        0.02249563,
        0.012546934,
        -0.005593617,
        0.029428754,
        0.0058292085,
        0.024609223,
        -0.015333646,
        -0.026642041,
        -0.045341283,
        0.00025284025,
        -0.015818292,
        -0.023545695,
        -0.026386257,
        -0.003846874,
        -0.01834922,
        0.016464485,
        0.00043921,
        -0.014243194,
        0.03761388,
        0.0003895675,
        -0.0010702589,
        -0.03257895,
        -0.009477513,
        0.017379927,
        -0.009524631,
        0.010716051,
        -0.023653394,
        -0.028190214,
        0.033009745,
        -0.010392955,
        -0.00276147,
        -0.021714812,
        -0.015993303,
        -0.017299153,
        0.016585646,
        -0.022118684,
        -0.009342888,
        0.027449785,
        -0.011409364,
        -0.028136365,
        -0.0067177257,
        0.018281907,
        0.0078014466,
        -0.010971837,
        -0.007572586,
        0.02816329,
        -0.0026655504,
        0.0012730359,
        -0.022226382,
        -0.009766954,
        -0.015993303,
        0.015037474,
        0.0064854994,
        0.006000854,
        -0.03712923,
        -0.003846874,
        0.012284418,
        0.035163727,
        0.0014631919,
        0.032713573,
        0.0067008976,
        -0.01762225,
        -0.020772446,
        0.0023979857,
        0.002122007,
        0.040602524,
        -0.015427883,
        0.024326513,
        0.0052873483,
        -0.02182251,
        -0.022966813,
        0.0023811578,
        0.008999598,
        0.00991504,
        0.010911255,
        -0.005371488,
        -0.0026756471,
        -0.0019436305,
        0.012896956,
        0.01592599,
        0.014472054,
        -0.01048719,
        -0.01490285,
        -0.009167878,
        -0.01677412,
        -0.00008839943,
        -0.02940183,
        0.033225145,
        0.0040824655,
        0.025766987,
        0.015845217,
        0.026561268,
        0.027947892,
        -0.004119487,
        0.0014724473,
        0.007660092,
        0.012513278,
        -0.0053815846,
        0.019601218,
        -0.019560833,
        0.026588192,
        0.006633586,
        0.021028232,
        -0.0031300024,
        0.033252068,
        0.022078296,
        0.0013024849,
        -0.011429557,
        0.005610445,
        -0.007902415,
        -0.011032417,
        -0.01790496,
        0.017528012,
        -0.012311343,
        -0.022010984,
        0.029213356,
        0.023936104,
        -0.03955246,
        -0.0016642862,
        0.02357262,
        -0.004681541,
        0.026399719,
        -0.015764441,
        -0.017958809,
        -0.058157463,
        -0.00691293,
        0.0020900338,
        -0.014472054,
        0.003830046,
        0.0016205335,
        0.015549044,
        0.004742122,
        0.015333646,
        -0.024178427,
        -0.0052738856,
        0.013549881,
        -0.054818794,
        0.000082825165,
        -0.005984026,
        0.0073571885,
        0.0064215534,
        -0.011860353,
        -0.0019251198,
        -0.0018022755,
        0.0023828405,
        0.028324839,
        -0.015279797,
        -0.01721838,
        -0.039767858,
        0.0026150665,
        -0.0060446067,
        0.01462014,
        -0.019399283,
        -0.009019792,
        0.015939454,
        -0.014027796,
        -0.008905361,
        -0.009114029,
        -0.012883494,
        -0.003614648,
        0.030774992,
        0.029671077,
        0.008750544,
        0.011914203,
        -0.007599511,
        0.0043651755,
        -0.033386692,
        -0.020826295,
        -0.014256656,
        0.0036281103,
        0.0006382007,
        0.009127491,
        0.0062196176,
        -0.008777469,
        0.016962593,
        0.019116573,
        -0.007296608,
        0.015656743,
        0.01070932,
        0.017999196,
        0.026103547,
        -0.0045401864,
        0.010157363,
        0.013233515,
        -0.022684103,
        -0.0022027812,
        -0.03898704,
        0.03354824,
        0.020328188,
        0.004769047,
        0.018497305,
        -0.00552294,
        -0.01387971,
        -0.020839758,
        -0.0011476675,
        0.027382473,
        0.014970162,
        -0.0012991193,
        -0.0032494809,
        -0.0030525937,
        -0.022199458,
        -0.024272664,
        0.0053243698,
        -0.021943673,
        -0.008629383,
        -0.014741302,
        -0.00014608781,
        0.02067821,
        -0.001782082,
        -0.013866247,
        -0.03212123,
        -0.0058628647,
        -0.015710592,
        0.0037088846,
        0.018564615,
        -0.0024753944,
        0.0046310574,
        -0.029832624,
        -0.025793912,
        -0.01269502,
        0.007458156,
        0.018254982,
        -0.015858678,
        0.018685777,
        0.04283728,
        0.021835973,
        0.0047522187,
        0.02221292,
        0.006741285,
        0.013469107,
        -0.025188105,
        -0.013381601,
        -0.013933559,
        0.011140116,
        0.002776615,
        0.009167878,
        0.040144805,
        -0.007094672,
        -0.010170825,
        0.002808588,
        0.007996651,
        0.0066874353,
        0.020126252,
        -0.012688289,
        -0.01382586,
        -0.03381749,
        0.009625599,
        -0.008629383,
        0.02108208,
        -0.04617595,
        -0.014889387,
        -0.029509528,
        -0.0043449816,
        0.003830046,
        0.021862898,
        0.028836409,
        -0.027894042,
        -0.00017501088,
        0.03960631,
        0.0023138458,
        -0.014472054,
        -0.009571749,
        -0.025201568,
        -0.016316399,
        -0.0034362713,
        0.014781688,
        0.024488062,
        -0.010830482,
        0.019426208,
        -0.010345836,
        0.040144805,
        0.025578514,
        -0.002768201,
        0.015320184,
        0.007767791,
        -0.011072804,
        -0.032713573,
        -0.03370979,
        -0.028971033,
        -0.023262985,
        -0.0017130873,
        -0.003325207,
        0.01608754,
        -0.0071687154,
        -0.014593216,
        0.013812398,
        -0.01564328,
        0.03607917,
        0.022818727,
        0.045314357,
        0.029940324,
        -0.0012334902,
        -0.0065864674,
        -0.016181776,
        -0.011806504,
        -0.01603369,
        -0.0029061905,
        0.012984461,
        0.00019488893,
        -0.018605003,
        0.0050281975,
        0.011301665,
        -0.0040891967,
        -0.008562071,
        0.039229363,
        0.016868357,
        0.0026992064,
        -0.021553263,
        -0.006192693,
        -0.012075751,
        0.022643717,
        -0.0064989617,
        -0.0003209935,
        0.00583594,
        -0.0109045245,
        -0.012270955,
        0.0005296603,
        0.0018022755,
        -0.0011501918,
        0.042029537,
        -0.017649176,
        0.02419189,
        -0.02272449,
        -0.029051807,
        0.008420716,
        0.016181776,
        0.032767422,
        0.01387971,
        0.014458592,
        0.03586377,
        0.011456482,
        -0.0042305514,
        0.0100496635,
        -0.0034413198,
        0.026938215,
        -0.008851512,
        -0.02827099,
        -0.0073302635,
        -0.0016760657,
        0.033225145,
        -0.0010719417,
        -0.0022179263,
        -0.02288604,
        -0.027234387,
        -0.00053512945,
        0.0057316064,
        -0.01694913,
        -0.00991504,
        -0.033521317,
        -0.009423663,
        0.0009061862,
        -0.011079535,
        -0.0066605103,
        0.00399496,
        -0.040440977,
        -0.026655504,
        -0.030478818,
        -0.0071552526,
        0.00091628294,
        -0.0058561335,
        -0.011409364,
        0.021687888,
        0.032552026,
        -0.04216416,
        0.011994977,
        0.023828406,
        0.0023003835,
        -0.01762225,
        0.026117008,
        -0.01965507,
        0.0088313185,
        0.021903286,
        0.010366029,
        -0.011840159,
        -0.02565929,
        0.026992064,
        0.022562942,
        0.025605438,
        -0.022993738,
        0.004085831,
        0.008164931,
        0.009322695,
        -0.018712703,
        -0.008306286,
        0.010911255,
        0.0009970572,
        0.0010231406,
        0.010817019,
        0.015562506,
        0.0016255819,
        0.0065124244,
        0.010864138,
        0.0008775786,
        -0.012614246,
        -0.03376364,
        -0.008407254,
        0.0005111496,
        -0.00022023605,
        0.0071619838,
        -0.021351328,
        -0.013334483,
        -0.017689561,
        0.007451425,
        0.005421972,
        0.0023424535,
        -0.006532618,
        0.0055633266,
        0.017716486,
        0.013462376,
        -0.020368574,
        -0.00855534,
        -0.042998828,
        -0.018456917,
        -0.018739628,
        -0.010588159,
        -0.022172533,
        0.025807375,
        0.005304176,
        -0.016114464,
        -0.006640317,
        -0.0063979942,
        -0.040710226,
        0.008467834,
        -0.01354315,
        0.013334483,
        0.010271792,
        0.0088851685,
        0.013321021,
        0.022912964,
        0.009733298,
        0.023020662,
        0.010016007,
        -0.009625599,
        -0.0108506745,
        0.0046209604,
        -0.0079764575,
        -0.024205351,
        -0.037210006,
        -0.0006276833,
        0.009827535,
        -0.0038637018,
        0.007565855,
        0.026278557,
        -0.002685744,
        -0.007747597,
        -0.03529835,
        -0.016801044,
        0.016276013,
        0.010339105,
        0.029617228,
        -0.012385386,
        -0.02260333,
        0.02913258,
        0.016020227,
        0.025928536,
        -0.022455243,
        0.004573842,
        -0.0123046115,
        0.0016121195,
        -0.011140116,
        -0.03672536,
        0.003266309,
        -0.012493085,
        0.020395499,
        -0.02442075,
        0.024286127,
        0.022670642,
        -0.0095179,
        0.007909146,
        -0.009625599,
        0.009524631,
        -0.035675295,
        0.018591542,
        0.0034934864,
        -0.007054285,
        0.007841834,
        0.0037829275,
        0.015091323,
        -0.003414395,
        -0.02323606,
        -0.0074648876,
        -0.015508657,
        -0.02555159,
        0.019089649,
        0.0131056225,
        -0.010938181,
        0.010002545,
        0.014472054,
        -0.00067353947,
        -0.008299555,
        -0.022037908,
        0.0050753155,
        0.00060664833,
        -0.009645793,
        -0.0042372826,
        0.0036752287,
        -0.04165259,
        0.026642041,
        0.018106895,
        0.006175865,
        0.012311343,
        0.22024447,
        -0.0026907923,
        0.031394262,
        0.014068183,
        0.020207027,
        0.027732493,
        0.010978567,
        0.00504166,
        -0.015549044,
        0.028297914,
        0.0069802417,
        -0.0059402734,
        -0.018887714,
        0.0033588628,
        -0.0079764575,
        0.013866247,
        -0.011934396,
        -0.04970309,
        -0.0134893,
        -0.00079259736,
        0.007835102,
        -0.008864975,
        -0.011900741,
        -0.0042709387,
        0.023276448,
        0.011395901,
        -0.0065931985,
        0.021889823,
        0.02454191,
        0.0021842704,
        -0.011315127,
        -0.0016205335,
        0.0058393055,
        0.015575969,
        -0.037533104,
        -0.0050281975,
        0.007956265,
        -0.0026739645,
        0.016989518,
        0.0016592378,
        -0.027813269,
        0.003927648,
        0.013671042,
        -0.03669844,
        0.011914203,
        -0.02108208,
        -0.024313051,
        -0.014889387,
        0.005509477,
        0.0014085011,
        0.002105179,
        -0.0034833897,
        0.027570946,
        -0.007559124,
        0.0006243177,
        0.0029987441,
        0.004583939,
        0.0070744785,
        0.015091323,
        -0.0021152757,
        -0.002702572,
        0.021203242,
        -0.030613443,
        0.0032276046,
        -0.04975694,
        0.008265899,
        -0.037586953,
        0.00075852073,
        -0.011469944,
        0.0023087976,
        -0.011294933,
        0.010157363,
        -0.020422423,
        0.017164528,
        -0.000016091746,
        -0.01880694,
        0.011577643,
        -0.0012090896,
        0.035271425,
        0.053526405,
        -0.015683668,
        -0.011469944,
        0.0043517128,
        0.002983599,
        0.009033254,
        -0.019183885,
        0.042810354,
        -0.005994123,
        -0.0053815846,
        -0.010998761,
        -0.00087084743,
        -0.008238974,
        0.017528012,
        -0.015333646,
        0.029374905,
        0.013078698,
        -0.014498979,
        0.035056025,
        -0.022536017,
        0.03672536,
        -0.014539366,
        0.052449416,
        0.014916312,
        0.00866977,
        -0.0149567,
        -0.012546934,
        -0.017177992,
        0.029321054,
        0.0065056933,
        -0.039821707,
        -0.007269683,
        -0.026790127,
        0.012048827,
        -0.0068759085,
        0.017958809,
        0.010911255,
        -0.018685777,
        0.009147684,
        -0.021109005,
        0.008252436,
        -0.015724055,
        -0.011308395,
        0.006199424,
        -0.01790496,
        0.0041464115,
        0.0012360144,
        -0.04458739,
        0.0073975753,
        -0.0028641205,
        -0.0034396371,
        0.02747671,
        -0.031528883,
        -0.0052032084,
        0.012439235,
        0.012149794,
        0.000044778175,
        -0.014270118,
        0.0025040018,
        0.016397174,
        0.011362245,
        -0.029159507,
        0.0016853212,
        -0.003648304,
        -0.0067109945,
        0.0015944501,
        -0.015091323,
        -0.006081628,
        -0.015562506,
        0.0033033304,
        0.0009549873,
        -0.0117593855,
        -0.010897793,
        -0.014310505,
        -0.013785473,
        0.017837647,
        -0.015589431,
        -0.008636114,
        -0.025874685,
        0.038529318,
        0.014633602,
        -0.012573859,
        -0.0021522974,
        0.013623924,
        0.010473728,
        -0.016383711,
        -0.017608788,
        -0.17048752,
        0.022387931,
        0.006438381,
        -0.035271425,
        0.045314357,
        -0.010938181,
        0.012782526,
        -0.008764006,
        -0.00351368,
        -0.0056642946,
        0.016693346,
        -0.019237734,
        -0.025201568,
        -0.018995412,
        -0.011624762,
        0.0045974012,
        -0.0038737985,
        0.028836409,
        0.020947456,
        -0.002667233,
        0.032040454,
        -0.03053267,
        0.023828406,
        -0.0020513295,
        0.0044526807,
        0.005058488,
        -0.012533472,
        -0.008185125,
        -0.022468705,
        -0.0137787415,
        -0.023586083,
        0.014175882,
        0.026305482,
        0.0058393055,
        0.018739628,
        -0.0063979942,
        0.010022739,
        -0.025268879,
        0.001283974,
        0.027234387,
        0.028190214,
        0.022226382,
        0.035163727,
        -0.017595325,
        -0.023586083,
        0.024676535,
        0.026655504,
        -0.009396738,
        -0.006539349,
        0.00045519657,
        0.02011279,
        -0.020368574,
        -0.0094303945,
        0.00063189026,
        0.0028859968,
        -0.001807324,
        0.000032761953,
        0.0012587322,
        0.010042933,
        -0.017864572,
        0.0011543988,
        -0.017124142,
        0.01518556,
        -0.019331971,
        -0.039202437,
        -0.022199458,
        -0.018564615,
        0.024555374,
        -0.005341198,
        -0.0009045034,
        0.016154852,
        -0.008602458,
        -0.0042743045,
        0.014404742,
        -0.006573005,
        0.03042497,
        -0.007774522,
        0.032713573,
        0.024689997,
        -0.009571749,
        0.0014152323,
        0.009275577,
        0.020139715,
        -0.017016442,
        0.011779578,
        0.0029465775,
        -0.023276448,
        -0.0129777305,
        -0.023384146,
        0.0026924752,
        0.031259637,
        -0.025470816,
        -0.008097619,
        -0.0038569707,
        -0.0038334115,
        0.014162419,
        0.008905361,
        -0.0005006321,
        -0.0036617662,
        -0.012506547,
        0.018066509,
        0.0036516695,
        -0.03632149,
        0.012984461,
        0.04585285,
        0.031071164,
        -0.027503634,
        0.014270118,
        0.039875556,
        0.0008325638,
        -0.01841653,
        0.01739339,
        0.021499414,
        0.012513278,
        -0.01864539,
        0.028917184,
        0.010022739,
        -0.012876762,
        0.010076588,
        -0.03037112,
        0.018268444,
        -0.0097400285,
        -0.018443454,
        0.020530123,
        -0.0057551656,
        -0.018389605,
        -0.08842088,
        -0.042379558,
        0.012944074,
        0.015199022,
        -0.022307158,
        0.025026556,
        -0.008225512,
        -0.0044560465,
        -0.011550718,
        0.008265899,
        -0.0013689554,
        -0.0041699708,
        -0.011988246,
        0.00071603013,
        0.011988246,
        -0.005603714,
        0.008710157,
        0.00038809504,
        -0.004940692,
        -0.012176719,
        -0.0022398029,
        -0.0022717759,
        0.016558722,
        0.003931014,
        0.0017686196,
        0.017770337,
        -0.038663942,
        -0.003564164,
        -0.005973929,
        0.01966853,
        0.0010298718,
        -0.0060479725,
        -0.006532618,
        -0.02215907,
        0.007087941,
        -0.008871705,
        -0.0459067,
        -0.025740063,
        0.04294498,
        -0.01949352,
        0.0030071582,
        -0.023276448,
        0.018053045,
        -0.010177556,
        -0.021660963,
        0.005603714,
        -0.01659911,
        0.009618867,
        0.008750544,
        -0.025941998,
        -0.022468705,
        -0.027005525,
        -0.010958374,
        -0.031528883,
        0.022657178,
        -0.010157363,
        0.013280634,
        0.0035035834,
        -0.003931014,
        -0.0073975753,
        0.014148957,
        -0.0018140551,
        -0.00046192776,
        -0.00086916465,
        0.0017265497,
        0.021364791,
        -0.0022313888,
        -0.013112354,
        0.026924752,
        0.006364338,
        0.0018157379,
        0.011066073,
        -0.01002947,
        0.02277834,
        -0.024434213,
        -0.011678611,
        -0.00031741758,
        -0.019170424,
        -0.004227186,
        -0.0057518003,
        -0.014135495,
        -0.0079764575,
        -0.036186866,
        -0.0020412328,
        0.0018426627,
        0.027301699,
        0.01772995,
        0.02685744,
        0.03088269,
        -0.037506178,
        0.01654526,
        0.0007976458,
        0.031017315,
        0.005149359,
        -0.013152741,
        -0.018026121,
        0.006010951,
        -0.008817856,
        -0.002303749,
        0.04017173,
        -0.021795586,
        -0.020018553,
        -0.08578226,
        -0.0009760223,
        0.016006764,
        -0.017474163,
        0.0075120055,
        -0.03791005,
        -0.014593216,
        -0.022239845,
        0.011981514,
        0.0020782542,
        -0.022468705,
        0.011140116,
        0.008811125,
        -0.0049272296,
        -0.013637386,
        -0.0045704767,
        0.039229363,
        -0.005421972,
        0.010891062,
        0.011113191,
        -0.020435886,
        -0.02374763,
        0.0037189813,
        -0.012876762,
        -0.024770772,
        0.009921771,
        -0.0029667711,
        0.042702656,
        -0.0007437963,
        -0.034706004,
        0.006939855,
        -0.007269683,
        -0.005802284,
        -0.017864572,
        -0.01723184,
        -0.006606661,
        0.0055397674,
        0.0015481733,
        0.003648304,
        0.007209102,
        -0.008023576,
        -0.029051807,
        0.03451753,
        -0.00010822488,
        -0.0021825877,
        -0.01490285,
        0.012459429,
        -0.023182211,
        0.025134256,
        0.021095542,
        0.036886908,
        0.0190358,
        -0.01138917,
        -0.0048430897,
        -0.0013100575,
        -0.012196912,
        -0.0022482167,
        -0.0024737115,
        -0.035675295,
        -0.008461103,
        0.035836846,
        0.020651285,
        -0.013233515,
        -0.011039148,
        0.01031218,
        -0.0031199055,
        -0.040037107,
        -0.02629202,
        0.006448478,
        -0.01490285,
        -0.019978166,
        -0.0055666924,
        0.022737952,
        0.0027564215,
        0.020435886,
        -0.0037492716,
        -0.04453354,
        -0.0053075417,
        -0.021539802,
        0.03898704,
        0.04647212,
        -0.012190182,
        -0.028055592,
        0.005570058,
        0.0298057,
        -0.0078485655,
        -0.011718998,
        -0.0055397674,
        -0.0032461153,
        0.017824186,
        -0.037883125,
        0.00031173814,
        0.0040925625,
        0.019305047,
        0.030694216,
        0.005990757,
        -0.012802719,
        -0.0021809048,
        0.008851512,
        -0.015899066,
        -0.00682879,
        -0.0113218585,
        0.005859499,
        -0.011348783,
        -0.028997958,
        -0.017043367,
        0.013751817,
        -0.03438291,
        -0.0011762751,
        0.029267205,
        0.012849838,
        -0.017177992,
        0.004755584,
        0.0033975672,
        -0.050133888,
        0.01410857,
        -0.001915023,
        -0.0034598305,
        -0.011597836,
        -0.0010635277,
        0.011039148,
        0.023963029,
        0.010278524,
        -0.021028232,
        -0.0035877232,
        0.015602893,
        0.0055902516,
        -0.011483407,
        -0.0020025284,
        0.004876746,
        -0.020745521,
        0.0069667795,
        -0.027355548,
        -0.009450587,
        0.0046041324,
        -0.023989953,
        -0.008245706,
        -0.012836375,
        0.009356352,
        0.0702736,
        0.0055397674,
        -0.015024011,
        0.0024434212,
        0.013374871,
        0.0002522092,
        -0.0042608418,
        -0.014270118,
        0.020328188,
        -0.015024011,
        0.0060412413,
        0.0049911756,
        -0.022805264,
        -0.042244934,
        -0.013529688,
        -0.01721838,
        -0.033655938,
        0.005694585,
        -0.02221292,
        0.023693781,
        0.010291986,
        0.020583972,
        -0.014270118,
        0.0027328623,
        -0.032309704,
        -0.008286092,
        0.01864539,
        0.0030239862,
        0.003786293,
        -0.047629885,
        0.017878035,
        0.017070293,
        -0.022482168,
        -0.008299555,
        0.026749741,
        0.028944109,
        -0.0009305867,
        0.0018174207,
        0.027463246,
        0.025995847,
        0.0018460283,
        0.013273902,
        -0.03707538,
        -0.030478818,
        -0.018322293,
        -0.00239462,
        -0.000016525591,
        -0.03667151,
        -0.020987844
    ]