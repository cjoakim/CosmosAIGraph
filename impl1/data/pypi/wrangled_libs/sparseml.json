{
  "classifiers": [
    "development status :: 5 - production/stable",
    "intended audience :: developers",
    "intended audience :: education",
    "intended audience :: information technology",
    "intended audience :: science/research",
    "license :: osi approved :: apache software license",
    "operating system :: posix :: linux",
    "programming language :: python :: 3",
    "programming language :: python :: 3 :: only",
    "topic :: scientific/engineering",
    "topic :: scientific/engineering :: artificial intelligence",
    "topic :: scientific/engineering :: mathematics",
    "topic :: software development",
    "topic :: software development :: libraries :: python modules"
  ],
  "description": "<!--\ncopyright (c) 2021 - present / neuralmagic, inc. all rights reserved.\n\nlicensed under the apache license, version 2.0 (the \"license\");\nyou may not use this file except in compliance with the license.\nyou may obtain a copy of the license at\n\n   http://www.apache.org/licenses/license-2.0\n\nunless required by applicable law or agreed to in writing,\nsoftware distributed under the license is distributed on an \"as is\" basis,\nwithout warranties or conditions of any kind, either express or implied.\nsee the license for the specific language governing permissions and\nlimitations under the license.\n-->\n\n<h1><img alt=\"tool icon\" src=\"https://raw.githubusercontent.com/neuralmagic/sparseml/main/docs/source/icon-sparseml.png\" />&nbsp;&nbsp;sparseml</h1>\n\n<h3>libraries for applying sparsification recipes to neural networks with a few lines of code, enabling faster and smaller models</h3>\n\n<p>\n    <a href=\"https://docs.neuralmagic.com/sparseml/\">\n        <img alt=\"documentation\" src=\"https://img.shields.io/badge/documentation-darkred?&style=for-the-badge&logo=read-the-docs\" height=25>\n    </a>\n    <a href=\"https://join.slack.com/t/discuss-neuralmagic/shared_invite/zt-q1a1cnvo-yboicsiw3l1dmqpjbedurq/\">\n        <img src=\"https://img.shields.io/badge/slack-purple?style=for-the-badge&logo=slack\" height=25>\n    </a>\n    <a href=\"https://github.com/neuralmagic/sparseml/issues\">\n        <img src=\"https://img.shields.io/badge/support%20forums-navy?style=for-the-badge&logo=github\" height=25>\n    </a>\n    <a href=\"https://github.com/neuralmagic/sparseml/actions/workflows/test-check.yaml\">\n        <img alt=\"main\" src=\"https://img.shields.io/github/workflow/status/neuralmagic/sparseml/test%20checks/main?label=build&style=for-the-badge\" height=25>\n    </a>\n    <a href=\"https://github.com/neuralmagic/sparseml/releases\">\n        <img alt=\"github release\" src=\"https://img.shields.io/github/release/neuralmagic/sparseml.svg?style=for-the-badge\" height=25>\n    </a>\n    <a href=\"https://github.com/neuralmagic/sparseml/blob/main/license\">\n        <img alt=\"github\" src=\"https://img.shields.io/github/license/neuralmagic/sparseml.svg?color=lightgray&style=for-the-badge\" height=25>\n    </a>\n    <a href=\"https://github.com/neuralmagic/sparseml/blob/main/code_of_conduct.md\">\n        <img alt=\"contributor covenant\" src=\"https://img.shields.io/badge/contributor%20covenant-v2.1%20adopted-ff69b4.svg?color=yellow&style=for-the-badge\" height=25>\n    </a>\n    <a href=\"https://www.youtube.com/channel/uco8do_wmgybwcrnj_dxr4ea\">\n        <img src=\"https://img.shields.io/badge/-youtube-red?&style=for-the-badge&logo=youtube&logocolor=white\" height=25>\n    </a>\n     <a href=\"https://medium.com/limitlessai\">\n        <img src=\"https://img.shields.io/badge/medium-%2312100e.svg?&style=for-the-badge&logo=medium&logocolor=white\" height=25>\n    </a>\n    <a href=\"https://twitter.com/neuralmagic\">\n        <img src=\"https://img.shields.io/twitter/follow/neuralmagic?color=darkgreen&label=follow&style=social\" height=25>\n    </a>\n</p>\n\n## overview\n\nsparseml is an open-source model optimization toolkit that enables you to create inference-optimized sparse models using pruning, quantization, and distillation algorithms. models optimized with sparseml can then be exported to the onnx and deployed with [deepsparse](https://github.com/neuralmagic/deepsparse/) for gpu-class performance on cpu hardware.\n\n<p align=\"center\">\n   <img alt=\"sparseml flow\" src=\"docs/images/sparseml-workflow.png\" width=\"60%\" />\n</p>\n\n## workflows\n\nsparseml enables you to create a sparse model trained on your dataset in two ways:\n- **sparse transfer learning** enables you to fine-tune a pre-sparsified model from [sparsezoo](https://sparsezoo.neuralmagic.com/) (an open-source repository of sparse models such as bert, yolov5, and resnet-50) onto your dataset, while maintaining sparsity. this pathway works just like typical fine-tuning you are used to in training cv and nlp models, and is strongly preferred for if your model architecture is available in sparsezoo.\n\n- **sparsification from scratch** enables you to apply state-of-the-art pruning (like gradual magnitude pruning or obs pruning) and quantization (like quantization aware training) algorithms to arbitrary pytorch and hugging face models. this pathway requires more experimentation, but allows you to create a sparse version of any model. \n\n## integrations\n\n<p>\n    <a href=\"integrations/torchvision\">\n        <img src=\"https://docs.neuralmagic.com/docs/source/highlights/sparseml/pytorch-torchvision.png\" width=\"136px\" />\n    </a>\n    <a href=\"integrations/ultralytics-yolov5\">\n        <img src=\"https://docs.neuralmagic.com/docs/source/highlights/sparseml/ultralytics-yolov5.png\" width=\"136px\" />\n    </a>\n    <a href=\"integrations/ultralytics-yolov8\">\n        <img src=\"docs/images/ultralytics-yolov8.png\" width=\"136px\" />\n    </a>\n    <a href=\"integrations/huggingface-transformers\">\n        <img src=\"https://docs.neuralmagic.com/docs/source/highlights/sparseml/huggingface-transformers.png\" width=\"136px\" />\n    </a>\n</p>\n\n## tutorials\n\n### pytorch\n- [sparse transfer learning with the cli](integrations/torchvision/tutorials/sparse-transfer-learning.md)\n- [sparse transfer learning with the python api](integrations/torchvision/tutorials/docs-torchvision-python-transfer-imagenette.ipynb)\n- [sparsify from scratch with the python api](integrations/torchvision/tutorials/docs-torchvision-sparsify-from-scratch-resnet50-beans.ipynb)\n\n### hugging face transformers\n- [sparse transfer learning overview with the python api](integrations/huggingface-transformers/tutorials/sparse-transfer-learning-bert-python.md)\n- [sparse transfer learning overview with the cli](integrations/huggingface-transformers/tutorials/sparse-transfer-learning-bert.md)\n- [sparse transfer learning for sentiment analysis](integrations/huggingface-transformers/tutorials/sentiment-analysis/sentiment-analysis-cli.md), [for text classification](integrations/huggingface-transformers/tutorials/text-classification/text-classification-cli.md), [for token classification](integrations/huggingface-transformers/tutorials/token-classification/token-classification-cli.md), [for question answering](integrations/huggingface-transformers/tutorials/question-answering/question-answering-cli.md)\n\n### ultralytics yolov5\n- [sparse transfer learning with the cli](integrations/ultralytics-yolov5/tutorials/sparse-transfer-learning.md)\n- [sparsify from scratch with the cli](integrations/ultralytics-yolov5/tutorials/sparsify-from-scratch.md)\n\n### ultralytics yolov8\n- [sparse transfer learning with the cli](integrations/ultralytics-yolov8/tutorials/sparse-transfer-learning.md)\n\n### additional examples\n\n- [pytorch](integrations/torchvision#tutorials)\n- [hugging face transformers](integrations/huggingface-transformers#tutorials)\n- [ultralytics yolov5](integrations/ultralytics-yolov5#tutorials)\n- [ultralytics yolov8](integrations/ultralytics-yolov8#tutorials)\n\n## installation\n\nthis repository is tested on python 3.8-3.11, and linux/debian systems.\n\nit is recommended to install in a [virtual environment](https://docs.python.org/3/library/venv.html) to keep your system in order.\ncurrently supported ml frameworks are the following: `torch>=1.1.0,<=2.0`, `tensorflow>=1.8.0,<2.0.0`, `tensorflow.keras >= 2.2.0`.\n\ninstall with pip using:\n\n```bash\npip install sparseml\n```\n\nmore information on installation such as optional dependencies and requirements can be found [here](https://docs.neuralmagic.com/get-started/install/sparseml).\n\n## quick tour\n\n### recipes\n\nto enable flexibility, ease of use, and repeatability, sparseml uses a declarative interface called `recipes` for specifying the sparsity-related algorithms and hyperparamters that should be applied by sparseml.\n\n`recipes` are yaml-files formatted as a list of `modifiers`, which encode the instructions for sparseml. example `modifiers` can be anything from setting the learning rate to encoding the hyperparameters of the gradual magnitude pruning algorithm. the sparseml system parses the `recipes` into a native format for each framework and applies the modifications to the model and training pipeline.\n\n### python api\n\nbecause of the declarative, recipe-based approach, you can add sparseml to your existing pytorch training pipelines. the `schedulemodifiermanager` class is responsible for parsing the yaml `recipes` and overriding standard pytorch model and optimizer objects, encoding the logic of the sparsity algorithms from the recipe. once you call `manager.modify`, you can then use the model and optimizer as usual, as sparseml abstracts away the complexity of the sparsification algorithms.\n\nthe workflow looks like this:\n\n```python\nmodel = model()            # model definition\noptimizer = optimizer()    # optimizer definition\ntrain_data = traindata()   # train data definition\nbatch_size = batch_size    # training batch size\nsteps_per_epoch = len(train_data) // batch_size\n\nfrom sparseml.pytorch.optim import scheduledmodifiermanager\nmanager = scheduledmodifiermanager.from_yaml(path_to_recipe)\noptimizer = manager.modify(model, optimizer, steps_per_epoch)\n\n# typical pytorch training loop, using your model/optimizer as usual\n\nmanager.finalize(model)\n```\n\n- check out the [pytorch integration docs](integrations/torchvision) for full usage examples of the python api.\n- check out the [hugging face integration docs](integrations/huggingface-transformers) for details of using sparseml with the hugging face `trainer`.\n\n### sparseml cli\n\nin addition to the code-level api, sparseml offers pre-made training pipelines for common nlp and cv tasks via the cli interface. the cli enables you to kick-off training runs with various utilities like dataset loading and pre-processing, checkpoint saving, metric reporting, and logging handled for you. this makes it easy to get up and running in common training pathways.\n\nfor instance, we can use the following to kick off a yolov5 sparse transfer learning run onto the voc dataset (using sparsezoo stubs to pull down a sparse model checkpoint and transfer learning recipe):\n\n```bash\nsparseml.yolov5.train \\\n  --weights zoo:cv/detection/yolov5-s/pytorch/ultralytics/coco/pruned75_quant-none?recipe_type=transfer_learn \\\n  --recipe zoo:cv/detection/yolov5-s/pytorch/ultralytics/coco/pruned75_quant-none?recipe_type=transfer_learn \\\n  --data voc.yaml \\\n  --hyp hyps/hyp.finetune.yaml --cfg yolov5s.yaml --patience 0\n```\n\n- [yolov5 cli](integrations/ultralytics-yolov5/tutorials/sparse-transfer-learning.md)\n- [yolov8 cli](integrations/ultralytics-yolov8/tutorials/sparse-transfer-learning.md)\n- [hugging face cli](integrations/huggingface-transformers/tutorials/sparse-transfer-learning-bert.md)\n- [torchvision cli](integrations/torchvision/tutorials/sparse-transfer-learning.md)\n\n### additional resources \n\nmore information on the codebase and contained processes can be found in the sparseml docs:\n- [examples and tutorials](integrations)\n- [sparsification code](https://docs.neuralmagic.com/get-started/sparsify-a-model)\n- [sparsification recipes](https://docs.neuralmagic.com/user-guides/recipes)\n- [exporting to onnx](https://docs.neuralmagic.com/user-guides/onnx-export)\n\n## resources\n\n### learning more\n\n- documentation: [sparseml,](https://docs.neuralmagic.com/sparseml/) [sparsezoo,](https://docs.neuralmagic.com/sparsezoo/) [sparsify,](https://docs.neuralmagic.com/sparsify/) [deepsparse](https://docs.neuralmagic.com/deepsparse/)\n- neural magic: [blog,](https://www.neuralmagic.com/blog/) [resources](https://www.neuralmagic.com/resources/)\n\n### release history\n\nofficial builds are hosted on pypi\n\n- stable: [sparseml](https://pypi.org/project/sparseml/)\n- nightly (dev): [sparseml-nightly](https://pypi.org/project/sparseml-nightly/)\n\nadditionally, more information can be found via [github releases.](https://github.com/neuralmagic/sparseml/releases)\n\n### license\n\nthe project is licensed under the [apache license version 2.0.](https://github.com/neuralmagic/sparseml/blob/main/license)\n\n## community\n\n### contribute\n\nwe appreciate contributions to the code, examples, integrations, and documentation as well as bug reports and feature requests! [learn how here.](https://github.com/neuralmagic/sparseml/blob/main/contributing.md)\n\n### join\n\nfor user help or questions about sparseml, sign up or log in to our [**neural magic community slack**](https://join.slack.com/t/discuss-neuralmagic/shared_invite/zt-q1a1cnvo-yboicsiw3l1dmqpjbedurq). we are growing the community member by member and happy to see you there. bugs, feature requests, or additional questions can also be posted to our [github issue queue.](https://github.com/neuralmagic/sparseml/issues)\n\nyou can get the latest news, webinar and event invites, research papers, and other ml performance tidbits by [subscribing](https://neuralmagic.com/subscribe/) to the neural magic community.\n\nfor more general questions about neural magic, please fill out this [form.](http://neuralmagic.com/contact/)\n\n### cite\n\nfind this project useful in your research or other communications? please consider citing:\n\n```bibtex\n@inproceedings{\n    pmlr-v119-kurtz20a, \n    title = {inducing and exploiting activation sparsity for fast inference on deep neural networks}, \n    author = {kurtz, mark and kopinsky, justin and gelashvili, rati and matveev, alexander and carr, john and goin, michael and leiserson, william and moore, sage and nell, bill and shavit, nir and alistarh, dan}, \n    booktitle = {proceedings of the 37th international conference on machine learning}, \n    pages = {5533--5543}, \n    year = {2020}, \n    editor = {hal daum\u00e9 iii and aarti singh}, \n    volume = {119}, \n    series = {proceedings of machine learning research}, \n    address = {virtual}, \n    month = {13--18 jul}, \n    publisher = {pmlr}, \n    pdf = {http://proceedings.mlr.press/v119/kurtz20a/kurtz20a.pdf},\n    url = {http://proceedings.mlr.press/v119/kurtz20a.html}, \n    abstract = {optimizing convolutional neural networks for fast inference has recently become an extremely active area of research. one of the go-to solutions in this context is weight pruning, which aims to reduce computational and memory footprint by removing large subsets of the connections in a neural network. surprisingly, much less attention has been given to exploiting sparsity in the activation maps, which tend to be naturally sparse in many settings thanks to the structure of rectified linear (relu) activation functions. in this paper, we present an in-depth analysis of methods for maximizing the sparsity of the activations in a trained neural network, and show that, when coupled with an efficient sparse-input convolution algorithm, we can leverage this sparsity for significant performance gains. to induce highly sparse activation maps without accuracy loss, we introduce a new regularization technique, coupled with a new threshold-based sparsification method based on a parameterized activation function called forced-activation-threshold rectified linear unit (fatrelu). we examine the impact of our methods on popular image classification models, showing that most architectures can adapt to significantly sparser activation maps without any accuracy loss. our second contribution is showing that these these compression gains can be translated into inference speedups: we provide a new algorithm to enable fast convolution operations over networks with sparse activations, and show that it can enable significant speedups for end-to-end inference on a range of popular models on the large-scale imagenet image classification task on modern intel cpus, with little or no retraining cost.} \n}\n```\n\n```bibtex\n@misc{\n    singh2020woodfisher,\n    title={woodfisher: efficient second-order approximation for neural network compression}, \n    author={sidak pal singh and dan alistarh},\n    year={2020},\n    eprint={2004.14340},\n    archiveprefix={arxiv},\n    primaryclass={cs.lg}\n}\n```\n\n\n",
  "docs_url": null,
  "keywords": "inference,machine learning,neural network,computer vision,nlp,cv,deep learning,torch,pytorch,tensorflow,keras,sparsity,pruning,deep learning libraries,onnx,quantization,automl",
  "license": "apache",
  "name": "sparseml",
  "package_url": "https://pypi.org/project/sparseml/",
  "project_url": "https://pypi.org/project/sparseml/",
  "project_urls": {
    "Homepage": "https://github.com/neuralmagic/sparseml"
  },
  "release_url": "https://pypi.org/project/sparseml/1.6.1/",
  "requires_dist": [
    "sparsezoo ~=1.6.0",
    "setuptools <=59.5.0",
    "jupyter >=1.0.0",
    "ipywidgets >=7.0.0",
    "pyyaml >=5.0.0",
    "progressbar2 >=3.0.0",
    "numpy >=1.0.0",
    "matplotlib >=3.0.0",
    "merge-args >=0.1.0",
    "onnx <1.15.0,>=1.5.0",
    "pandas >=0.25.0",
    "packaging >=20.0",
    "psutil >=5.0.0",
    "pydantic <2.0.0,>=1.8.2",
    "requests >=2.0.0",
    "scikit-image >=0.15.0",
    "scikit-learn >=0.24.2",
    "tqdm >=4.0.0",
    "toposort >=1.0",
    "GPUtil >=1.4.0",
    "protobuf <=3.20.3,>=3.12.2",
    "click !=8.0.0,>=7.1.2",
    "scipy <1.9.2,>=1.8 ; python_version <= \"3.9\"",
    "scipy >=1.0.0 ; python_version > \"3.9\"",
    "open-clip-torch ==2.20.0 ; extra == 'clip'",
    "deepsparse ~=1.6.0 ; extra == 'deepsparse'",
    "deepsparse-ent ~=1.6.0 ; extra == 'deepsparse-ent'",
    "beautifulsoup4 ==4.9.3 ; extra == 'dev'",
    "black ==22.12.0 ; extra == 'dev'",
    "flake8 ==3.9.2 ; extra == 'dev'",
    "isort ==5.8.0 ; extra == 'dev'",
    "wheel >=0.36.2 ; extra == 'dev'",
    "pytest >=6.0.0 ; extra == 'dev'",
    "pytest-mock >=3.6.0 ; extra == 'dev'",
    "flaky ~=3.7.0 ; extra == 'dev'",
    "tensorboard <2.9,>=1.0 ; extra == 'dev'",
    "tensorboardX >=1.0 ; extra == 'dev'",
    "m2r2 >=0.2.7 ; extra == 'docs'",
    "mistune <3,>=2.0.3 ; extra == 'docs'",
    "myst-parser ~=0.14.0 ; extra == 'docs'",
    "rinohtype ~=0.4.2 ; extra == 'docs'",
    "sphinx ~=3.5.0 ; extra == 'docs'",
    "sphinx-copybutton ~=0.3.0 ; extra == 'docs'",
    "sphinx-markdown-tables ~=0.0.15 ; extra == 'docs'",
    "sphinx-multiversion ~=0.2.4 ; extra == 'docs'",
    "sphinx-pydantic ~=0.1.0 ; extra == 'docs'",
    "sphinx-rtd-theme ~=0.5.0 ; extra == 'docs'",
    "docutils <0.17 ; extra == 'docs'",
    "onnxruntime >=1.0.0 ; extra == 'onnxruntime'",
    "openpifpaf ==0.13.6 ; extra == 'openpifpaf'",
    "tensorflow ~=2.2.0 ; extra == 'tf_keras'",
    "keras2onnx >=1.0.0 ; extra == 'tf_keras'",
    "tensorflow <2.0.0 ; extra == 'tf_v1'",
    "tensorboard <2.0.0 ; extra == 'tf_v1'",
    "tf2onnx <1.6,>=1.0.0 ; extra == 'tf_v1'",
    "tensorflow-gpu <2.0.0 ; extra == 'tf_v1_gpu'",
    "tensorboard <2.0.0 ; extra == 'tf_v1_gpu'",
    "tf2onnx <1.6,>=1.0.0 ; extra == 'tf_v1_gpu'",
    "torch <2.2,>=1.7.0 ; extra == 'torch'",
    "gputils ; extra == 'torch'",
    "torch <2.2,>=1.7.0 ; extra == 'torch_all'",
    "gputils ; extra == 'torch_all'",
    "torchvision <0.17,>=0.3.0 ; extra == 'torch_all'",
    "torchaudio <=2.0.1 ; extra == 'torch_all'",
    "torch <2.2,>=1.7.0 ; extra == 'torchvision'",
    "gputils ; extra == 'torchvision'",
    "torchvision <0.17,>=0.3.0 ; extra == 'torchvision'",
    "opencv-python <=4.6.0.66 ; extra == 'torchvision'",
    "torch <2.2,>=1.7.0 ; extra == 'transformers'",
    "gputils ; extra == 'transformers'",
    "nm-transformers ~=1.6.0 ; extra == 'transformers'",
    "datasets <=2.14.6 ; extra == 'transformers'",
    "scikit-learn ; extra == 'transformers'",
    "seqeval ; extra == 'transformers'",
    "einops ; extra == 'transformers'",
    "accelerate >=0.20.3 ; extra == 'transformers'",
    "ultralytics ==8.0.124 ; extra == 'ultralytics'",
    "torch <2.2,>=1.7.0 ; extra == 'ultralytics'",
    "torch <2.2,>=1.7.0 ; extra == 'yolov5'",
    "gputils ; extra == 'yolov5'",
    "torchvision <0.17,>=0.3.0 ; extra == 'yolov5'",
    "opencv-python <=4.6.0.66 ; extra == 'yolov5'",
    "nm-yolov5 ~=1.6.0 ; extra == 'yolov5'"
  ],
  "requires_python": ">=3.8.0,<3.12",
  "summary": "libraries for applying sparsification recipes to neural networks with a few lines of code, enabling faster and smaller models",
  "version": "1.6.1",
  "releases": [],
  "developers": [
    "neuralmagic",
    "support@neuralmagic.com"
  ],
  "kwds": "imagenet tensorflow licenses license licensed",
  "license_kwds": "apache",
  "libtype": "pypi",
  "id": "pypi_sparseml",
  "homepage": "https://github.com/neuralmagic/sparseml",
  "release_count": 38,
  "dependency_ids": [
    "pypi_accelerate",
    "pypi_beautifulsoup4",
    "pypi_black",
    "pypi_click",
    "pypi_datasets",
    "pypi_deepsparse",
    "pypi_deepsparse_ent",
    "pypi_docutils",
    "pypi_einops",
    "pypi_flake8",
    "pypi_flaky",
    "pypi_gputil",
    "pypi_gputils",
    "pypi_ipywidgets",
    "pypi_isort",
    "pypi_jupyter",
    "pypi_keras2onnx",
    "pypi_m2r2",
    "pypi_matplotlib",
    "pypi_merge_args",
    "pypi_mistune",
    "pypi_myst_parser",
    "pypi_nm_transformers",
    "pypi_nm_yolov5",
    "pypi_numpy",
    "pypi_onnx",
    "pypi_onnxruntime",
    "pypi_open_clip_torch",
    "pypi_opencv_python",
    "pypi_openpifpaf",
    "pypi_packaging",
    "pypi_pandas",
    "pypi_progressbar2",
    "pypi_protobuf",
    "pypi_psutil",
    "pypi_pydantic",
    "pypi_pytest",
    "pypi_pytest_mock",
    "pypi_pyyaml",
    "pypi_requests",
    "pypi_rinohtype",
    "pypi_scikit_image",
    "pypi_scikit_learn",
    "pypi_scipy",
    "pypi_seqeval",
    "pypi_setuptools",
    "pypi_sparsezoo",
    "pypi_sphinx",
    "pypi_sphinx_copybutton",
    "pypi_sphinx_markdown_tables",
    "pypi_sphinx_multiversion",
    "pypi_sphinx_pydantic",
    "pypi_sphinx_rtd_theme",
    "pypi_tensorboard",
    "pypi_tensorboardx",
    "pypi_tensorflow",
    "pypi_tensorflow_gpu",
    "pypi_tf2onnx",
    "pypi_toposort",
    "pypi_torch",
    "pypi_torchaudio",
    "pypi_torchvision",
    "pypi_tqdm",
    "pypi_ultralytics",
    "pypi_wheel"
  ]
}