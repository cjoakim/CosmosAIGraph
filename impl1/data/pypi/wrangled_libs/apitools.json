{
  "classifiers": [],
  "description": "tools to play with json-schemas defined apis.\n\nthese tools are based on json-schema draft 3 from http://tools.ietf.org/html/draft-zyp-json-schema-03\nnot all features of the schema are supported and probably won't be.\nhandling of not supported feature varies between the different tools.\n\nall these tools are proofs of concept and work in progress, they need more extensive testing and documentation.\n\n# datagenerator \n\nclass to generate random values given a json-schema.  \ndoesn't support all json-schema monstruousities, only a subset i find useful.  \nsee todo.md for what is likely to be implemented next.  \n\n## examples\n\n```python\nfrom datagenerator import datagenerator\n\ngenerator = datagenerator()\n```\n\n### basic\n\ngenerate random values of each basic type using\n\n```python\n>>> generator.random_value(\"string\")\n'olzq3lv'\n>>> generator.random_value(\"number\")\n-6.675904074356879\n>>> generator.random_value(\"integer\")\n30\n>>> generator.random_value(\"boolean\")\ntrue\n\n```\n\n### basic with constraints\n\n`number`\n\n```python\n>>> generator.random_value({\"type\":\"number\", \"minimum\":30})\n32.34295327292445\n>>> generator.random_value({\"type\":\"number\", \"maximum\":30})\n-35.80704939879546\n>>> generator.random_value({\"type\":\"number\", \"maximum\":30, \"minimum\":12})\n16.45747265846327\n```\n\n`integer` supports `minimum` and `maximum` like `number` and more\n```python\n>>> generator.random_value({\"type\":\"integer\", \"maximum\":30, \"divisibleby\":4, \"minimum\":12})\n24\n>>> generator.random_value({\"type\":\"integer\", \"maximum\":30, \"exclusivemaximum\":true, \"minimum\":28})\n29\n```\n(same for `exclusiveminimum`)\n\n`string` supports `minlength`, `maxlength`, `pattern` (ignores `minlength` and `maxlength` if `pattern` is used)\n```python\n>>> generator.random_value({\"type\":\"string\", \"maxlength\":20, \"minlength\":15})\n'vytpcedaimx11188hu'\n>>> generator.random_value({\"type\":\"string\", \"pattern\":\"[0-9]{3}[a-za-z]{2,5}\"})\nu'806fonp'\n```\n\n`boolean` doesn't have any constraints.\n\n### arrays\n\nwithout constraints the array size will be picked the same way as a random `integer`.  \neach item in the array is generated using the default generator for the type given in `items`.\n```python\n>>> generator.random_value({\"type\":\"array\", \"items\": {\"type\":\"string\"}})\n[\n\t'39yxcpvs5tfpf6o', \n\t'sndk7slgnqstxxx', \n\t'npcrsd9yip7j ', \n\t'pwp7kqfjc1', \n\t'tt6f6z2yep'\n]\n```\n\n`minitems`, `maxitems` and `uniqueitems` are supported\n\nthe type of object in `items` can be anything that the generator knows about, either one of the basic types\nor a user defined one available from the generator's schemas store. \n\n```python\nfrom schemasstore import schemasstore\n\n...\n>>> from schemasstore import schemasstore\n>>> store = schemasstore()\n>>> generator.schemas_store = store\n>>> store.add_schema({\"type\":\"integer\", \"name\":\"small_integer\", \"minimum\":0,\"maximum\":9})\ntrue\n>>> generator.random_value({\"type\":\"array\", \"uniqueitems\":true, \"minitems\":10, \"items\":{\"type\":\"small_integer\"}})\n[0, 7, 2, 5, 3, 6, 1, 4, 8, 9]\n```\n\nsee [datagenerator](https://github.com/hamstah/apitools/blob/master/datagenerator.py) for other examples.\n\n### objects\n\nobjects can be generated the same way as the other types.\n\nexample generating [search_result.json](https://github.com/hamstah/apitools/blob/master/data/schemas/search_result.json)\n```python\n>>> store.load_folder(\"data/schemas/\")\n>>> generator.random_value(\"search_result\")\n{u'price': 21.980325774975253, u'name': 'wdvfxyrrt', u'reference': 26}\n```\n\ngenerating arrays of objects is fine as well\n```python\n>>> generator.random_value({\"type\":\"array\", \"maxitems\":3, \"minitems\":2, \"items\":{\"type\":\"search_result\"}})\n[\n    {u'price': 20.304440535786522, u'name': 'vuigjapbs', u'reference': 40}, \n\t{u'price': 28.45387747055259, u'name': 'jtycbu1v78x1s', u'reference': 27}\n]\n```\n\nor generating objects with arrays of other objects in them, see\n[search_resuts](https://github.com/hamstah/apitools/blob/master/data/schemas/search_results.json) \nwith an array of [search_result](https://github.com/hamstah/apitools/blob/master/data/schemas/search_result.json)\n```python\n>>> generator.random_value(\"search_results\")\n{\n    u'total_results': 41, \n\tu'total_pages': 26, \n\tu'current_page': 33, \n\tu'items_per_page': 27, \n\tu'results': [\n\t    {u'price': 26.218704680177446, u'name': 'b4p1z1pofqo', u'reference': 38}, \n\t\t{u'price': 21.205089550441276, u'name': 'fqphdlds', u'reference': 7}, \n\t\t{u'price': 20.610536930894398, u'name': '8d862p1xvupp', u'reference': 38}, \n\t\t{u'price': 9.543934434058526, u'name': 'pmqba0e diwisf', u'reference': 32}\n\t]\n}\n```\n\n### schemas\n\nwhy not generate random schemas?\n```python\n>>> r_schema = generator.random_schema()\n>>> r_schema\n{\n    'type': 'object', \n\t'properties': {\n\t    u'viyxjhu': {'required': false, 'type': 'boolean'}, \n\t\tu'to': {'required': false, 'type': 'string'}, \n\t\tu'ntsd': {'required': false, 'type': 'string'}, \n\t\tu'wjal': {'required': false, 'type': 'string'}, \n\t\tu'ptvhz': {'required': false, 'type': 'boolean'}\n\t}, \n\t'name': u'zjllgkkosmocovo'\n}\n```\nand then generate an array of random values of it\n```python\n>>> store.add_schema(r_schema)\ntrue\n>>> generator.random_value({\"type\":\"array\", \"minitems\":1, \"maxitems\":3, \"items\":{\"type\":\"zjllgkkosmocovo\"}})\n[\n\t{u'to': 'jamkfpdwy'}, \n\t{u'wjal': '8lnibwudssi', u'ptvhz': true}, \n\t{}\n]\n```\n\n## notes on the generation\n\nall the values are generated using the `random` module, so please don't use the generate values for anything\nrequiring reliable randomness == **don't use it to generate passwords**.\n\nto generate the data, the generator has to limit the range of possible values, so the values generated don't\nvary too wildly. the ranges are controlled by variables in `datagenerator`. feel free to tweak them, especially\nif you need values that don't fall into those ranges without having to set both minimum and maximum on your \nproperties.\n\n---\n\n# urlsgenerator\n\nclass to generate links defined in the links section of a json-schema.\n\n## example\n\ngenerate links from [book.json](https://github.com/hamstah/apitools/blob/master/data/schemas/book.json)\n\ninput\n```javascript\n...\n\t\"isbn\" : {\n\t    \"type\":\"string\",\n\t    \"required\":true,\n\t    \"pattern\":\"^\\\\d{12}(\\\\d|x)$\"\n\t}\n\n    },\n    \"links\" : [\n\t{\n\t    \"rel\":\"self\",\n\t    \"href\":\"books/{isbn}\"\n\t},\n\t{\n\t    \"rel\":\"instances\",\n\t    \"href\": \"books\"\n\t}\n    ]\n...\n\n```\n\noutput\n```python\n{\n    u'instances': [u'books'], \n    u'self'     : [u'books/525259838909x']\n}\n```\n\n`{isbn}` got replaced by a random value `525259838909x` satisfying the constraints on `isbn` (matches the regex).\n\n---\n\n# invaliddatagenerator\n\nclass to generate invalid data for a given schema\n\nbasically does the opposite of datagenerator. wip, needs documentation and examples.\n\n---\n\n# modelgenerator\n\nbase class to generate models from a schema, nothing too visible on its own, check `resourceserver`.\n\n---\n\n# flasksqlalchemymodelgenerator\n\ngenerate sqlalchemy models to be used with flask-sqlalchemy from a schema. uses `modelgenerator`. \nused in `resourceserver` to store and query items.\n\n---\n\n# backbonemodelgenerator\n\ngenerate models and collections for backbone.js from a schema.  \nthe models generated use the primary key defined in the `rel=self` link or `id` by default.  \nto be able to use collections, make sure your schema has a `rel=instances` link or `fetch` won't work.  \n\n## usage\n\n```bash\n$ python backbonemodelgenerator.py -h\nusage: backbonemodelgenerator.py jsonfile1 [jsonfile2]...\n\noptions:\n  -h, --help            show this help message and exit\n  -t output_type, --type=output_type\n                        output type (js|wrapped|html)\n```\n\n## output types\n\n### js\n\noutputs only the js code for the models/collections\n\n```bash\n$ python backbonemodelgenerator.py -t js data/schemas/message.json\n\napp.models.message = backbone.model.extend({\n    urlroot: '/messages',\n    idattribute: 'id'\n});\n\napp.collections.messages = backbone.collection.extend({\n    model : app.models.message,\n    url : \"/messages\"\n});\n```\n\n### wrapped\n\nwraps the js code into `$(document).ready()`\n\n```bash\n$ python backbonemodelgenerator.py -t wrapped data/schemas/message.json\n\n$(document).ready(function() {\n\n    window.app = { models : {}, collections : {} };\n    \n    app.models.message = backbone.model.extend({\n        urlroot: '/messages',\n        idattribute: 'id'\n    });\n    \n    app.collections.messages = backbone.collection.extend({\n        model : app.models.message,\n        url : \"/messages\"\n    });\n\n});\n```\n\n### html\n\nsame as wrapped but generate a whole html page including jquery, backbone and underscore to easily test.\n\n## example usage\n\n### setup\n\nyou can use it with resource server for example\n```bash\n$ mkdir static\n$ python backbonemodelgenerator.py -t html data/schemas/message.json > static/index.html\n$ python resourceserver.py data/schemas/message.json\nadded message\n * running on http://0.0.0.0:5000/\n```\n\nnow open your browser at http://0.0.0.0:5000/static/index.html\nopen your js console to start playing\n\n### create a collection and fetch them\n\n```javascript\nvar col = new app.collections.messages()\ncol.fetch()\n```\nyou should see backbone talking to the resource server in the server shell\n```bash\n127.0.0.1 - - [20/nov/2012 01:17:15] \"get /messages http/1.1\" 200 -\n```\n\nyou can inspect the results using\n```javascript\ncol.models\n```\n\nusing fetch() only works if your schema includes a link with `rel=instances`\n\n### create a new message\n\n```javascript\nvar msg = new app.models.message({recipient:\"01234567890\", text:\"test message\"})\nmsg.attributes\n```\n\nat that point the message is not saved yet, you can verify by using\n```javascript\nmsg.isnew()\n```\n\nyou can save it on the server using \n```javascript\nmsg.save()\n```\n\nyou can verify that the message was sent to the server in the server shell\n```bash\n127.0.0.1 - - [20/nov/2012 01:23:24] \"post /messages http/1.1\" 201 -\n```\n\nnow you should have an id for the message and it shouldn't be marked as new anymore.\n```javascript\nmsg.id\nmsg.isnew()\n```\n\n### fetch an existing message\n\ncreate a message with the `id` of the message to fetch\n```javascript\nvar msg = new app.models.message({id: 3})\n```\n\nthe message is not marked as new as it has an id.  \nwe can then fetch the actual message from the server using  \n```javascript\nmsg.fetch()\nmsg.attributes()\n```\n\nyou can see the query in the server shell again\n```bash\n127.0.0.1 - - [20/nov/2012 01:25:41] \"put /messages/3 http/1.1\" 200 -\n```\n\n### update a message\n\nonce you have a message object, you can update it using `save`.\n\n```javascript\n> msg.attributes.recipient\n\"01234567890\"\n> msg.save({recipient:\"00123456789\"})\n> msg.attributes.recipient\n\"00123456789\"\n```\n\nthis is done by doing a `put` on the server\n```bash\n127.0.0.1 - - [20/nov/2012 01:33:35] \"put /messages/3 http/1.1\" 200 -\n```\n\n### delete a message\n\nsimply use `destroy` on the object\n```javascript\nmsg.destroy()\n```\n\nand see the `delete` happening on the server\n```bash\n127.0.0.1 - - [20/nov/2012 01:34:48] \"delete /messages/3 http/1.1\" 204 -\n```\n\n---\n\n# resourceserver\n\nclass to implement the rest api of resources defined in a schema.  \nsupports creation, update, retrieval, deletion, listing of instances and schema.  \n\n## usage\n\nrun the server using\n```bash\n$ python resourceserver.py [jsonfile1, jsonfile2, ...]\n```\n\n## example using data/schemas/message.json\n\n```bash\n$ python resourceserver.py data/schemas/message.json\nadded message\n * running on http://0.0.0.0:5000/\n```\n\n### create a new message\n\n```bash\n$ curl -i -x post    http://0.0.0.0:5000/messages -d \"recipient=07771818335&text=nice message\"\n$ curl -i -x post    http://0.0.0.0:5000/messages -d '{\"recipient\":\"01234567890\", \"text\":\"test\"}' \\\n\t   -h \"content-type: application/json\"\nhttp/1.0 201 created\ncontent-type: application/json\ncontent-length: 13\nlocation: http://0.0.0.0:5000/messages/2\nserver: werkzeug/0.8.3 python/2.7.3\ndate: sun, 18 nov 2012 19:28:56 gmt\n\n{\n  \"id\": 2\n}\n```\n\n### list messages\n\n```bash\n$ curl -i -x get     http://0.0.0.0:5000/messages\nhttp/1.0 200 ok\ncontent-type: application/json\ncontent-length: 126\nserver: werkzeug/0.8.3 python/2.7.3\ndate: sun, 18 nov 2012 19:32:09 gmt\n\n[\n  {\"text\": \"i </3 ninjas\", \"recipient\": \"07771818337\", \"id\": 1},\n  {\"text\": \"nice message\", \"recipient\": \"07771818335\", \"id\": 2}\n]\n```\n\n### retrieve a message\n\n```bash\n$ curl -i -x get     http://0.0.0.0:5000/messages/2\nhttp/1.0 200 ok\ncontent-type: application/json\ncontent-length: 71\nserver: werkzeug/0.8.3 python/2.7.3\ndate: sun, 18 nov 2012 19:35:42 gmt\n\n{\n  \"text\": \"nice message\",\n  \"recipient\": \"07771818335\",\n  \"id\": 2\n}\n```\n\n### get the json-schema of a message\n\n```bash\n$ curl -i -x options http://0.0.0.0:5000/messages/2\nhttp/1.0 200 ok\ncontent-type: application/json\ncontent-length: 590\nserver: werkzeug/0.8.3 python/2.7.3\ndate: sun, 18 nov 2012 19:37:06 gmt\n\n{\n  \"description\": \"simple message structure\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"text\": {\n      \"required\": true, \n      \"type\": \"string\", \n      \"maxlength\": 140\n    }, \n    \"recipient\": {\n      \"pattern\": \"0[0-9]{10}\", \n      \"required\": true,\n      \"type\": \"string\"\n    },\n    \"id\": {\n      \"minimum\": 0,\n      \"type\": \"integer\"\n    }\n  },\n  \"links\": [\n    {\n      \"href\": \"/messages\",\n      \"rel\": \"root\"\n    },\n    {\n      \"href\": \"{id}\",\n      \"rel\": \"self\"\n    },\n    {\n      \"rel\": \"instances\"\n    },\n    {\n      \"rel\": \"create\"\n    }\n  ],\n  \"name\": \"message\"\n}\n```\n\n### update a message\n\nsupports partial updates\n\n```bash\n$ curl -i -x put     http://0.0.0.0:5000/messages/2 -d 'recipient=07771818336'\n$ curl -i -x put     http://0.0.0.0:5000/messages/1 -d '{\"text\":\"foo\"}' \\\n          -h \"content-type: application/json\"\nhttp/1.0 200 ok\ncontent-type: text/html; charset=utf-8\ncontent-length: 0\nserver: werkzeug/0.8.3 python/2.7.3\ndate: sun, 18 nov 2012 19:38:02 gmt\n```\n\n### delete a message\n\n```bash\n$ curl -i -x delete  http://0.0.0.0:5000/messages/2\nhttp/1.0 204 no content\ncontent-type: text/html; charset=utf-8\ncontent-length: 0\nserver: werkzeug/0.8.3 python/2.7.3\ndate: sun, 18 nov 2012 19:38:38 gmt\n```\n\n## errors examples\n\n### trying to set an implicit key\n\nthe message.json doesn't define an explicit primary key, but defines `id` as the key in the `rel=self` link.  \neach message then gets an additional `id` key managed by the server.  \ntrying to set or update the `id` results in errors  \n\n```bash\n$ curl -i -x post    http://0.0.0.0:5000/messages   -d \"recipient=07771818335&text=nice message&id=7\"\n$ curl -i -x put     http://0.0.0.0:5000/messages/1 -d \"recipient=07771818335&text=nice message&id=3\"\nhttp/1.0 400 bad request\ncontent-type: application/json\ncontent-length: 43\nserver: werkzeug/0.8.3 python/2.7.3\ndate: sun, 18 nov 2012 19:43:48 gmt\n\n{\n  \"error\": \"id is read only in message\"\n}\n```\n### trying to create or update unknown properties\n\n```bash\n$ curl -i -x post    http://0.0.0.0:5000/messages   -d \"recipient=07771818335&tet=test&haxxy=foo\"\n$ curl -i -x put     http://0.0.0.0:5000/messages/1 -d \"haxxy=foo\"\nhttp/1.0 400 bad request\ncontent-type: application/json\ncontent-length: 57\nserver: werkzeug/0.8.3 python/2.7.3\ndate: sun, 18 nov 2012 19:56:19 gmt\n\n{\n  \"error\": \"message does not have a 'haxxy' property\"\n}\n```\n\n### trying to create or update properties with values not respecting constraints\n\n```bash\n$ curl -i -x put     http://0.0.0.0:5000/messages/1 -d \"recipient=0notanumber&text=nice message\"\n$ curl -i -x post    http://0.0.0.0:5000/messages   -d \"recipient=0notanumber\"\nhttp/1.0 400 bad request\ncontent-type: application/json\ncontent-length: 86\nserver: werkzeug/0.8.3 python/2.7.3\ndate: sun, 18 nov 2012 20:03:34 gmt\n\n{\n  \"error\": \"'0notanumber' is an invalid recipient value: must match u'0[0-9]{10}'\"\n}\n```\n\n### trying to create a message without all the required properties\n\n```bash\n$ curl -i -x post    http://0.0.0.0:5000/messages -d \"recipient=012345678901\"http/1.0 400 bad request\ncontent-type: application/json\ncontent-length: 44\nserver: werkzeug/0.8.3 python/2.7.3\ndate: sun, 18 nov 2012 20:06:00 gmt\n\n{\n  \"error\": \"text is required in message\"\n}\n```\n\n### trying to create a message in json with invalid data\n\n```bash\n$ curl -i -x post    http://0.0.0.0:5000/messages  -d '{\"recipient\":\"01234567890\", \"text\":\"test}' -h \"content-type: application/json\"\nhttp/1.0 400 bad request\ncontent-type: application/json\ncontent-length: 90\nserver: werkzeug/0.8.3 python/2.7.3\ndate: tue, 20 nov 2012 00:23:05 gmt\n\n{\n  \"error\": \"invalid data: unterminated string starting at: line 1 column 35 (char 35)\"\n}\n```\n\n## primary keys\n\neach model needs a primary key.\nthere are 3 ways to define the primary key of the model:\n\nif there is no `rel=self` link, an additional `id` (or appended with as many `_` as \nnecessary to make the name unique) attribute is created. this type of key is called *implicit* and can\nonly be set by the server (read only).\n\n\nif there is a `rel=self` link and it contains a `{variable}` part, the variable name is used as the primary key.\n* if `variable` is the name of an existing property, this property is used as the primary key, and can be updated\n( *explicit key* )\n* otherwise an *implicit* key is created using the `variable` name (stil read-only).\n\n### example of an explicit key\n\nthis schema uses `isbn` as the explicit key. instances can be created using a specific `isbn`, and its value\ncan be updated.\n\n```javascript\n...\n\t\"isbn\" : {\n\t    \"type\":\"string\",\n\t    \"required\":true,\n\t    \"pattern\":\"^\\\\d{12}[\\\\d|x]$\"\n\t}\n\n    },\n    \"links\" : [\n\t{\n\t    \"rel\":\"self\",\n\t    \"href\":\"books/{isbn}\"\n\t},\n...\n```\n\n### example of implicit key\n\nthis schema defines an *implicit* key `order_id` (assuming no property is called `order_id`).\n```javascript\n...\n    \"links\" : [\n        {\n            \"rel\":\"self\",\n            \"href\":\"{order_id}\"\n        },\n...\n```\n\n# dependencies\n\n## optional\n\n### datagenerator, invaliddatagenerator and urlgenerator\n\nuse `rstr` hosted in a mercurial repo on bitbucket. run `init.sh` in dependencies to fetch it.\nif you don't have mercurial, `apt-get install mercurial` should help.\n\n### flasksqlalchemymodelgenerator and resourceserver\n\nflask-sqlalchemy is required, use flasksqlalchemy-requirements.txt with virtualenv\n\n### backbonemodelgenerator\n\njinja2 is required, comes with flask if you use the flasksqlalchemy-requirements.txt",
  "docs_url": null,
  "keywords": "",
  "license": "mit",
  "name": "apitools",
  "package_url": "https://pypi.org/project/apitools/",
  "project_url": "https://pypi.org/project/apitools/",
  "project_urls": {
    "Download": "UNKNOWN",
    "Homepage": "https://github.com/hamstah/apitools"
  },
  "release_url": "https://pypi.org/project/apitools/0.1.4/",
  "requires_dist": [],
  "requires_python": null,
  "summary": "tools to play with json-schema and rest apis",
  "version": "0.1.4",
  "releases": [],
  "developers": [
    "hamstahguru@gmail.com",
    "nicolas_esteves"
  ],
  "kwds": "random_schema flasksqlalchemymodelgenerator json datagenerator sqlalchemy",
  "license_kwds": "mit",
  "libtype": "pypi",
  "id": "pypi_apitools",
  "homepage": "https://github.com/hamstah/apitools",
  "release_count": 5,
  "dependency_ids": []
}