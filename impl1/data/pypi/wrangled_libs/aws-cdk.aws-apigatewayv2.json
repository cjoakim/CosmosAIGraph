{
  "classifiers": [
    "development status :: 7 - inactive",
    "framework :: aws cdk",
    "framework :: aws cdk :: 1",
    "intended audience :: developers",
    "license :: osi approved",
    "operating system :: os independent",
    "programming language :: javascript",
    "programming language :: python :: 3 :: only",
    "programming language :: python :: 3.10",
    "programming language :: python :: 3.11",
    "programming language :: python :: 3.7",
    "programming language :: python :: 3.8",
    "programming language :: python :: 3.9",
    "typing :: typed"
  ],
  "description": "# aws::apigatewayv2 construct library\n\n<!--begin stability banner-->---\n\n\n![end-of-support](https://img.shields.io/badge/end--of--support-critical.svg?style=for-the-badge)\n\n> aws cdk v1 has reached end-of-support on 2023-06-01.\n> this package is no longer being updated, and users should migrate to aws cdk v2.\n>\n> for more information on how to migrate, see the [*migrating to aws cdk v2* guide](https://docs.aws.amazon.com/cdk/v2/guide/migrating-v2.html).\n\n---\n\n\nfeatures                                   | stability\n-------------------------------------------|--------------------------------------------------------\ncfn resources                              | ![stable](https://img.shields.io/badge/stable-success.svg?style=for-the-badge)\nhigher level constructs for http apis      | ![experimental](https://img.shields.io/badge/experimental-important.svg?style=for-the-badge)\nhigher level constructs for websocket apis | ![experimental](https://img.shields.io/badge/experimental-important.svg?style=for-the-badge)\n\n> **cfn resources:** all classes with the `cfn` prefix in this module ([cfn resources](https://docs.aws.amazon.com/cdk/latest/guide/constructs.html#constructs_lib)) are always\n> stable and safe to use.\n\n<!-- -->\n\n> **experimental:** higher level constructs in this module that are marked as experimental are\n> under active development. they are subject to non-backward compatible changes or removal in any\n> future version. these are not subject to the [semantic versioning](https://semver.org/) model and\n> breaking changes will be announced in the release notes. this means that while you may use them,\n> you may need to update your source code when upgrading to a newer version of this package.\n\n---\n<!--end stability banner-->\n\n## table of contents\n\n* [introduction](#introduction)\n* [http api](#http-api)\n\n  * [defining http apis](#defining-http-apis)\n  * [cross origin resource sharing (cors)](#cross-origin-resource-sharing-cors)\n  * [publishing http apis](#publishing-http-apis)\n  * [custom domain](#custom-domain)\n  * [mutual tls](#mutual-tls-mtls)\n  * [managing access to http apis](#managing-access-to-http-apis)\n  * [metrics](#metrics)\n  * [vpc link](#vpc-link)\n  * [private integration](#private-integration)\n* [websocket api](#websocket-api)\n\n  * [manage connections permission](#manage-connections-permission)\n  * [managing access to websocket apis](#managing-access-to-websocket-apis)\n\n## introduction\n\namazon api gateway is an aws service for creating, publishing, maintaining, monitoring, and securing rest, http, and websocket\napis at any scale. api developers can create apis that access aws or other web services, as well as data stored in the aws cloud.\nas an api gateway api developer, you can create apis for use in your own client applications. read the\n[amazon api gateway developer guide](https://docs.aws.amazon.com/apigateway/latest/developerguide/welcome.html).\n\nthis module supports features under [api gateway v2](https://docs.aws.amazon.com/awscloudformation/latest/userguide/aws_apigatewayv2.html)\nthat lets users set up websocket and http apis.\nrest apis can be created using the `@aws-cdk/aws-apigateway` module.\n\n## http api\n\nhttp apis enable creation of restful apis that integrate with aws lambda functions, known as lambda proxy integration,\nor to any routable http endpoint, known as http proxy integration.\n\n### defining http apis\n\nhttp apis have two fundamental concepts - routes and integrations.\n\nroutes direct incoming api requests to backend resources. routes consist of two parts: an http method and a resource\npath, such as, `get /books`. learn more at [working with\nroutes](https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-routes.html). use the `any` method\nto match any methods for a route that are not explicitly defined.\n\nintegrations define how the http api responds when a client reaches a specific route. http apis support lambda proxy\nintegration, http proxy integration and, aws service integrations, also known as private integrations. learn more at\n[configuring integrations](https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-integrations.html).\n\nintegrations are available at the `aws-apigatewayv2-integrations` module and more information is available in that module.\nas an early example, the following code snippet configures a route `get /books` with an http proxy integration all\nconfigures all other http method calls to `/books` to a lambda proxy.\n\n```python\nfrom aws_cdk.aws_apigatewayv2_integrations import httpurlintegration, httplambdaintegration\n\n# books_default_fn: lambda.function\n\n\nget_books_integration = httpurlintegration(\"getbooksintegration\", \"https://get-books-proxy.myproxy.internal\")\nbooks_default_integration = httplambdaintegration(\"booksintegration\", books_default_fn)\n\nhttp_api = apigwv2.httpapi(self, \"httpapi\")\n\nhttp_api.add_routes(\n    path=\"/books\",\n    methods=[apigwv2.httpmethod.get],\n    integration=get_books_integration\n)\nhttp_api.add_routes(\n    path=\"/books\",\n    methods=[apigwv2.httpmethod.any],\n    integration=books_default_integration\n)\n```\n\nthe url to the endpoint can be retrieved via the `apiendpoint` attribute. by default this url is enabled for clients. use `disableexecuteapiendpoint` to disable it.\n\n```python\nhttp_api = apigwv2.httpapi(self, \"httpapi\",\n    disable_execute_api_endpoint=true\n)\n```\n\nthe `defaultintegration` option while defining http apis lets you create a default catch-all integration that is\nmatched when a client reaches a route that is not explicitly defined.\n\n```python\nfrom aws_cdk.aws_apigatewayv2_integrations import httpurlintegration\n\n\napigwv2.httpapi(self, \"httpproxyapi\",\n    default_integration=httpurlintegration(\"defaultintegration\", \"https://example.com\")\n)\n```\n\n### cross origin resource sharing (cors)\n\n[cross-origin resource sharing (cors)](https://developer.mozilla.org/en-us/docs/web/http/cors) is a browser security\nfeature that restricts http requests that are initiated from scripts running in the browser. enabling cors will allow\nrequests to your api from a web application hosted in a domain different from your api domain.\n\nwhen configured cors for an http api, api gateway automatically sends a response to preflight `options` requests, even\nif there isn't an `options` route configured. note that, when this option is used, api gateway will ignore cors headers\nreturned from your backend integration. learn more about [configuring cors for an http\napi](https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-cors.html).\n\nthe `corspreflight` option lets you specify a cors configuration for an api.\n\n```python\napigwv2.httpapi(self, \"httpproxyapi\",\n    cors_preflight=apigwv2.corspreflightoptions(\n        allow_headers=[\"authorization\"],\n        allow_methods=[apigwv2.corshttpmethod.get, apigwv2.corshttpmethod.head, apigwv2.corshttpmethod.options, apigwv2.corshttpmethod.post\n        ],\n        allow_origins=[\"*\"],\n        max_age=duration.days(10)\n    )\n)\n```\n\n### publishing http apis\n\na stage is a logical reference to a lifecycle state of your api (for example, `dev`, `prod`, `beta`, or `v2`). api\nstages are identified by their stage name. each stage is a named reference to a deployment of the api made available for\nclient applications to call.\n\nuse `httpstage` to create a stage resource for http apis. the following code sets up a stage, whose url is available at\n`https://{api_id}.execute-api.{region}.amazonaws.com/beta`.\n\n```python\n# api: apigwv2.httpapi\n\n\napigwv2.httpstage(self, \"stage\",\n    http_api=api,\n    stage_name=\"beta\"\n)\n```\n\nif you omit the `stagename` will create a `$default` stage. a `$default` stage is one that is served from the base of\nthe api's url - `https://{api_id}.execute-api.{region}.amazonaws.com/`.\n\nnote that, `httpapi` will always creates a `$default` stage, unless the `createdefaultstage` property is unset.\n\n### custom domain\n\ncustom domain names are simpler and more intuitive urls that you can provide to your api users. custom domain name are associated to api stages.\n\nthe code snippet below creates a custom domain and configures a default domain mapping for your api that maps the\ncustom domain to the `$default` stage of the api.\n\n```python\nimport aws_cdk.aws_certificatemanager as acm\nfrom aws_cdk.aws_apigatewayv2_integrations import httplambdaintegration\n\n# handler: lambda.function\n\n\ncert_arn = \"arn:aws:acm:us-east-1:111111111111:certificate\"\ndomain_name = \"example.com\"\n\ndn = apigwv2.domainname(self, \"dn\",\n    domain_name=domain_name,\n    certificate=acm.certificate.from_certificate_arn(self, \"cert\", cert_arn)\n)\napi = apigwv2.httpapi(self, \"httpproxyprodapi\",\n    default_integration=httplambdaintegration(\"defaultintegration\", handler),\n    # https://${dn.domainname}/foo goes to prodapi $default stage\n    default_domain_mapping=apigwv2.domainmappingoptions(\n        domain_name=dn,\n        mapping_key=\"foo\"\n    )\n)\n```\n\nto migrate a domain endpoint from one type to another, you can add a new endpoint configuration via `addendpoint()`\nand then configure dns records to route traffic to the new endpoint. after that, you can remove the previous endpoint configuration.\nlearn more at [migrating a custom domain name](https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-regional-api-custom-domain-migrate.html)\n\nto associate a specific `stage` to a custom domain mapping -\n\n```python\n# api: apigwv2.httpapi\n# dn: apigwv2.domainname\n\n\napi.add_stage(\"beta\",\n    stage_name=\"beta\",\n    auto_deploy=true,\n    # https://${dn.domainname}/bar goes to the beta stage\n    domain_mapping=apigwv2.domainmappingoptions(\n        domain_name=dn,\n        mapping_key=\"bar\"\n    )\n)\n```\n\nthe same domain name can be associated with stages across different `httpapi` as so -\n\n```python\nfrom aws_cdk.aws_apigatewayv2_integrations import httplambdaintegration\n\n# handler: lambda.function\n# dn: apigwv2.domainname\n\n\napi_demo = apigwv2.httpapi(self, \"demoapi\",\n    default_integration=httplambdaintegration(\"defaultintegration\", handler),\n    # https://${dn.domainname}/demo goes to apidemo $default stage\n    default_domain_mapping=apigwv2.domainmappingoptions(\n        domain_name=dn,\n        mapping_key=\"demo\"\n    )\n)\n```\n\nthe `mappingkey` determines the base path of the url with the custom domain. each custom domain is only allowed\nto have one api mapping with undefined `mappingkey`. if more than one api mappings are specified, `mappingkey` will be required for all of them. in the sample above, the custom domain is associated\nwith 3 api mapping resources across different apis and stages.\n\n|        api     |     stage   |   url  |\n| :------------: | :---------: | :----: |\n| api | $default  |   `https://${domainname}/foo`  |\n| api | beta  |   `https://${domainname}/bar`  |\n| apidemo | $default  |   `https://${domainname}/demo`  |\n\nyou can retrieve the full domain url with mapping key using the `domainurl` property as so -\n\n```python\n# api_demo: apigwv2.httpapi\n\ndemo_domain_url = api_demo.default_stage.domain_url\n```\n\n### mutual tls (mtls)\n\nmutual tls can be configured to limit access to your api based by using client certificates instead of (or as an extension of) using authorization headers.\n\n```python\nimport aws_cdk.aws_s3 as s3\nimport aws_cdk.aws_certificatemanager as acm\n# bucket: s3.bucket\n\n\ncert_arn = \"arn:aws:acm:us-east-1:111111111111:certificate\"\ndomain_name = \"example.com\"\n\napigwv2.domainname(self, \"domainname\",\n    domain_name=domain_name,\n    certificate=acm.certificate.from_certificate_arn(self, \"cert\", cert_arn),\n    mtls=apigwv2.mtlsconfig(\n        bucket=bucket,\n        key=\"someca.pem\",\n        version=\"version\"\n    )\n)\n```\n\ninstructions for configuring your trust store can be found [here](https://aws.amazon.com/blogs/compute/introducing-mutual-tls-authentication-for-amazon-api-gateway/)\n\n### managing access to http apis\n\napi gateway supports multiple mechanisms for [controlling and managing access to your http\napi](https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-access-control.html) through authorizers.\n\nthese authorizers can be found in the [apigatewayv2-authorizers](https://docs.aws.amazon.com/cdk/api/latest/docs/aws-apigatewayv2-authorizers-readme.html) constructs library.\n\n### metrics\n\nthe api gateway v2 service sends metrics around the performance of http apis to amazon cloudwatch.\nthese metrics can be referred to using the metric apis available on the `httpapi` construct.\nthe apis with the `metric` prefix can be used to get reference to specific metrics for this api. for example,\nthe method below refers to the client side errors metric for this api.\n\n```python\napi = apigwv2.httpapi(self, \"my-api\")\nclient_error_metric = api.metric_client_error()\n```\n\nplease note that this will return a metric for all the stages defined in the api. it is also possible to refer to metrics for a specific stage using\nthe `metric` methods from the `stage` construct.\n\n```python\napi = apigwv2.httpapi(self, \"my-api\")\nstage = apigwv2.httpstage(self, \"stage\",\n    http_api=api\n)\nclient_error_metric = stage.metric_client_error()\n```\n\n### vpc link\n\nprivate integrations let http apis connect with aws resources that are placed behind a vpc. these are usually application\nload balancers, network load balancers or a cloud map service. the `vpclink` construct enables this integration.\nthe following code creates a `vpclink` to a private vpc.\n\n```python\nimport aws_cdk.aws_ec2 as ec2\n\n\nvpc = ec2.vpc(self, \"vpc\")\nvpc_link = apigwv2.vpclink(self, \"vpclink\", vpc=vpc)\n```\n\nany existing `vpclink` resource can be imported into the cdk app via the `vpclink.fromvpclinkattributes()`.\n\n```python\nimport aws_cdk.aws_ec2 as ec2\n\n# vpc: ec2.vpc\n\nawesome_link = apigwv2.vpclink.from_vpc_link_attributes(self, \"awesome-vpc-link\",\n    vpc_link_id=\"us-east-1_oiur12abd\",\n    vpc=vpc\n)\n```\n\n### private integration\n\nprivate integrations enable integrating an http api route with private resources in a vpc, such as application load balancers or\namazon ecs container-based applications.  using private integrations, resources in a vpc can be exposed for access by\nclients outside of the vpc.\n\nthese integrations can be found in the [aws-apigatewayv2-integrations](https://docs.aws.amazon.com/cdk/api/latest/docs/aws-apigatewayv2-integrations-readme.html) constructs library.\n\n## websocket api\n\na websocket api in api gateway is a collection of websocket routes that are integrated with backend http endpoints,\nlambda functions, or other aws services. you can use api gateway features to help you with all aspects of the api\nlifecycle, from creation through monitoring your production apis. [read more](https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-websocket-api-overview.html)\n\nwebsocket apis have two fundamental concepts - routes and integrations.\n\nwebsocket apis direct json messages to backend integrations based on configured routes. (non-json messages are directed\nto the configured `$default` route.)\n\nintegrations define how the websocket api behaves when a client reaches a specific route. learn more at\n[configuring integrations](https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-websocket-api-integration-requests.html).\n\nintegrations are available in the `aws-apigatewayv2-integrations` module and more information is available in that module.\n\nto add the default websocket routes supported by api gateway (`$connect`, `$disconnect` and `$default`), configure them as part of api props:\n\n```python\nfrom aws_cdk.aws_apigatewayv2_integrations import websocketlambdaintegration\n\n# connect_handler: lambda.function\n# disconnect_handler: lambda.function\n# default_handler: lambda.function\n\n\nweb_socket_api = apigwv2.websocketapi(self, \"mywsapi\",\n    connect_route_options=apigwv2.websocketrouteoptions(integration=websocketlambdaintegration(\"connectintegration\", connect_handler)),\n    disconnect_route_options=apigwv2.websocketrouteoptions(integration=websocketlambdaintegration(\"disconnectintegration\", disconnect_handler)),\n    default_route_options=apigwv2.websocketrouteoptions(integration=websocketlambdaintegration(\"defaultintegration\", default_handler))\n)\n\napigwv2.websocketstage(self, \"mystage\",\n    web_socket_api=web_socket_api,\n    stage_name=\"dev\",\n    auto_deploy=true\n)\n```\n\nto retrieve a websocket url and a callback url:\n\n```python\n# web_socket_stage: apigwv2.websocketstage\n\n\nweb_socket_url = web_socket_stage.url\n# wss://${this.api.apiid}.execute-api.${s.region}.${s.urlsuffix}/${urlpath}\ncallback_url = web_socket_stage.callback_url\n```\n\nto add any other route:\n\n```python\nfrom aws_cdk.aws_apigatewayv2_integrations import websocketlambdaintegration\n\n# message_handler: lambda.function\n\nweb_socket_api = apigwv2.websocketapi(self, \"mywsapi\")\nweb_socket_api.add_route(\"sendmessage\",\n    integration=websocketlambdaintegration(\"sendmessageintegration\", message_handler)\n)\n```\n\nto import an existing websocketapi:\n\n```python\nweb_socket_api = apigwv2.websocketapi.from_web_socket_api_attributes(self, \"mywsapi\", web_socket_id=\"api-1234\")\n```\n\n### manage connections permission\n\ngrant permission to use api gateway management api of a websocket api by calling the `grantmanageconnections` api.\nyou can use management api to send a callback message to a connected client, get connection information, or disconnect the client. learn more at [use @connections commands in your backend service](https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-how-to-call-websocket-api-connections.html).\n\n```python\n# fn: lambda.function\n\n\nweb_socket_api = apigwv2.websocketapi(self, \"mywsapi\")\nstage = apigwv2.websocketstage(self, \"mystage\",\n    web_socket_api=web_socket_api,\n    stage_name=\"dev\"\n)\n# per stage permission\nstage.grant_management_api_access(fn)\n# for all the stages permission\nweb_socket_api.grant_manage_connections(fn)\n```\n\n### managing access to websocket apis\n\napi gateway supports multiple mechanisms for [controlling and managing access to a websocket api](https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-websocket-api-control-access.html) through authorizers.\n\nthese authorizers can be found in the [apigatewayv2-authorizers](https://docs.aws.amazon.com/cdk/api/latest/docs/aws-apigatewayv2-authorizers-readme.html) constructs library.\n\n### api keys\n\nwebsocket apis also support usage of api keys. an api key is a key that is used to grant access to an api. these are useful for controlling and tracking access to an api, when used together with [usage plans](https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-api-usage-plans.html). these together allow you to configure controls around api access such as quotas and throttling, along with per-api key metrics on usage.\n\nto require an api key when accessing the websocket api:\n\n```python\nweb_socket_api = apigwv2.websocketapi(self, \"mywsapi\",\n    api_key_selection_expression=apigwv2.websocketapikeyselectionexpression.header_x_api_key\n)\n```\n",
  "docs_url": null,
  "keywords": "",
  "license": "apache-2.0",
  "name": "aws-cdk.aws-apigatewayv2",
  "package_url": "https://pypi.org/project/aws-cdk.aws-apigatewayv2/",
  "project_url": "https://pypi.org/project/aws-cdk.aws-apigatewayv2/",
  "project_urls": {
    "Homepage": "https://github.com/aws/aws-cdk",
    "Source": "https://github.com/aws/aws-cdk.git"
  },
  "release_url": "https://pypi.org/project/aws-cdk.aws-apigatewayv2/1.204.0/",
  "requires_dist": [
    "aws-cdk.aws-certificatemanager (==1.204.0)",
    "aws-cdk.aws-cloudwatch (==1.204.0)",
    "aws-cdk.aws-ec2 (==1.204.0)",
    "aws-cdk.aws-iam (==1.204.0)",
    "aws-cdk.aws-s3 (==1.204.0)",
    "aws-cdk.core (==1.204.0)",
    "constructs (<4.0.0,>=3.3.69)",
    "jsii (<2.0.0,>=1.84.0)",
    "publication (>=0.0.3)",
    "typeguard (~=2.13.3)"
  ],
  "requires_python": "~=3.7",
  "summary": "the cdk construct library for aws::apigatewayv2",
  "version": "1.204.0",
  "releases": [],
  "developers": [
    "amazon_web_services"
  ],
  "kwds": "aws_cdk aws_apigatewayv2_integrations aws_apigatewayv2 cdk apigatewayv2",
  "license_kwds": "apache-2.0",
  "libtype": "pypi",
  "id": "pypi_aws_cdk.aws_apigatewayv2",
  "homepage": "https://github.com/aws/aws-cdk",
  "release_count": 212,
  "dependency_ids": [
    "pypi_aws_cdk.aws_certificatemanager",
    "pypi_aws_cdk.aws_cloudwatch",
    "pypi_aws_cdk.aws_ec2",
    "pypi_aws_cdk.aws_iam",
    "pypi_aws_cdk.aws_s3",
    "pypi_aws_cdk.core",
    "pypi_constructs",
    "pypi_jsii",
    "pypi_publication",
    "pypi_typeguard"
  ]
}