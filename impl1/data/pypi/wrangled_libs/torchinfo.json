{
  "classifiers": [
    "license :: osi approved :: mit license",
    "operating system :: os independent",
    "programming language :: python :: 3",
    "programming language :: python :: 3 :: only",
    "programming language :: python :: 3.10",
    "programming language :: python :: 3.11",
    "programming language :: python :: 3.6",
    "programming language :: python :: 3.7",
    "programming language :: python :: 3.8",
    "programming language :: python :: 3.9"
  ],
  "description": "# torchinfo\n\n[![python 3.7+](https://img.shields.io/badge/python-3.7+-blue.svg)](https://www.python.org/downloads/release/python-370/)\n[![pypi version](https://badge.fury.io/py/torchinfo.svg)](https://badge.fury.io/py/torchinfo)\n[![conda version](https://img.shields.io/conda/vn/conda-forge/torchinfo)](https://anaconda.org/conda-forge/torchinfo)\n[![build status](https://github.com/tyleryep/torchinfo/actions/workflows/test.yml/badge.svg)](https://github.com/tyleryep/torchinfo/actions/workflows/test.yml)\n[![pre-commit.ci status](https://results.pre-commit.ci/badge/github/tyleryep/torchinfo/main.svg)](https://results.pre-commit.ci/latest/github/tyleryep/torchinfo/main)\n[![github license](https://img.shields.io/github/license/tyleryep/torchinfo)](https://github.com/tyleryep/torchinfo/blob/main/license)\n[![codecov](https://codecov.io/gh/tyleryep/torchinfo/branch/main/graph/badge.svg)](https://codecov.io/gh/tyleryep/torchinfo)\n[![downloads](https://pepy.tech/badge/torchinfo)](https://pepy.tech/project/torchinfo)\n\n(formerly torch-summary)\n\ntorchinfo provides information complementary to what is provided by `print(your_model)` in pytorch, similar to tensorflow's `model.summary()` api to view the visualization of the model, which is helpful while debugging your network. in this project, we implement a similar functionality in pytorch and create a clean, simple interface to use in your projects.\n\nthis is a completely rewritten version of the original torchsummary and torchsummaryx projects by @sksq96 and @nmhkahn. this project addresses all of the issues and pull requests left on the original projects by introducing a completely new api.\n\nsupports pytorch versions 1.4.0+.\n\n# usage\n\n```\npip install torchinfo\n```\n\nalternatively, via conda:\n\n```\nconda install -c conda-forge torchinfo\n```\n\n# how to use\n\n```python\nfrom torchinfo import summary\n\nmodel = convnet()\nbatch_size = 16\nsummary(model, input_size=(batch_size, 1, 28, 28))\n```\n\n```\n================================================================================================================\nlayer (type:depth-idx)          input shape          output shape         param #            mult-adds\n================================================================================================================\nsingleinputnet                  [7, 1, 28, 28]       [7, 10]              --                 --\n\u251c\u2500conv2d: 1-1                   [7, 1, 28, 28]       [7, 10, 24, 24]      260                1,048,320\n\u251c\u2500conv2d: 1-2                   [7, 10, 12, 12]      [7, 20, 8, 8]        5,020              2,248,960\n\u251c\u2500dropout2d: 1-3                [7, 20, 8, 8]        [7, 20, 8, 8]        --                 --\n\u251c\u2500linear: 1-4                   [7, 320]             [7, 50]              16,050             112,350\n\u251c\u2500linear: 1-5                   [7, 50]              [7, 10]              510                3,570\n================================================================================================================\ntotal params: 21,840\ntrainable params: 21,840\nnon-trainable params: 0\ntotal mult-adds (m): 3.41\n================================================================================================================\ninput size (mb): 0.02\nforward/backward pass size (mb): 0.40\nparams size (mb): 0.09\nestimated total size (mb): 0.51\n================================================================================================================\n```\n\n<!-- single_input_all_cols.out -->\n\nnote: if you are using a jupyter notebook or google colab, `summary(model, ...)` must be the returned value of the cell.\nif it is not, you should wrap the summary in a print(), e.g. `print(summary(model, ...))`.\nsee `tests/jupyter_test.ipynb` for examples.\n\n**this version now supports:**\n\n- rnns, lstms, and other recursive layers\n- branching output used to explore model layers using specified depths\n- returns modelstatistics object containing all summary data fields\n- configurable rows/columns\n- jupyter notebook / google colab\n\n**other new features:**\n\n- verbose mode to show weights and bias layers\n- accepts either input data or simply the input shape!\n- customizable line widths and batch dimension\n- comprehensive unit/output testing, linting, and code coverage testing\n\n**community contributions:**\n\n- sequentials & modulelists (thanks to @roym899)\n- improved mult-add calculations (thanks to @te-stefanuhlich, @zmzhang2000)\n- dict/misc input data (thanks to @e-dorigatti)\n- pruned layer support (thanks to @majorcarrot)\n\n# documentation\n\n```python\ndef summary(\n    model: nn.module,\n    input_size: optional[input_size_type] = none,\n    input_data: optional[input_data_type] = none,\n    batch_dim: optional[int] = none,\n    cache_forward_pass: optional[bool] = none,\n    col_names: optional[iterable[str]] = none,\n    col_width: int = 25,\n    depth: int = 3,\n    device: optional[torch.device] = none,\n    dtypes: optional[list[torch.dtype]] = none,\n    mode: str | none = none,\n    row_settings: optional[iterable[str]] = none,\n    verbose: int = 1,\n    **kwargs: any,\n) -> modelstatistics:\n\"\"\"\nsummarize the given pytorch model. summarized information includes:\n    1) layer names,\n    2) input/output shapes,\n    3) kernel shape,\n    4) # of parameters,\n    5) # of operations (mult-adds),\n    6) whether layer is trainable\n\nnote: if neither input_data or input_size are provided, no forward pass through the\nnetwork is performed, and the provided model information is limited to layer names.\n\nargs:\n    model (nn.module):\n            pytorch model to summarize. the model should be fully in either train()\n            or eval() mode. if layers are not all in the same mode, running summary\n            may have side effects on batchnorm or dropout statistics. if you\n            encounter an issue with this, please open a github issue.\n\n    input_size (sequence of sizes):\n            shape of input data as a list/tuple/torch.size\n            (dtypes must match model input, default is floattensors).\n            you should include batch size in the tuple.\n            default: none\n\n    input_data (sequence of tensors):\n            arguments for the model's forward pass (dtypes inferred).\n            if the forward() function takes several parameters, pass in a list of\n            args or a dict of kwargs (if your forward() function takes in a dict\n            as its only argument, wrap it in a list).\n            default: none\n\n    batch_dim (int):\n            batch_dimension of input data. if batch_dim is none, assume\n            input_data / input_size contains the batch dimension, which is used\n            in all calculations. else, expand all tensors to contain the batch_dim.\n            specifying batch_dim can be an runtime optimization, since if batch_dim\n            is specified, torchinfo uses a batch size of 1 for the forward pass.\n            default: none\n\n    cache_forward_pass (bool):\n            if true, cache the run of the forward() function using the model\n            class name as the key. if the forward pass is an expensive operation,\n            this can make it easier to modify the formatting of your model\n            summary, e.g. changing the depth or enabled column types, especially\n            in jupyter notebooks.\n            warning: modifying the model architecture or input data/input size when\n            this feature is enabled does not invalidate the cache or re-run the\n            forward pass, and can cause incorrect summaries as a result.\n            default: false\n\n    col_names (iterable[str]):\n            specify which columns to show in the output. currently supported: (\n                \"input_size\",\n                \"output_size\",\n                \"num_params\",\n                \"params_percent\",\n                \"kernel_size\",\n                \"mult_adds\",\n                \"trainable\",\n            )\n            default: (\"output_size\", \"num_params\")\n            if input_data / input_size are not provided, only \"num_params\" is used.\n\n    col_width (int):\n            width of each column.\n            default: 25\n\n    depth (int):\n            depth of nested layers to display (e.g. sequentials).\n            nested layers below this depth will not be displayed in the summary.\n            default: 3\n\n    device (torch.device):\n            uses this torch device for model and input_data.\n            if not specified, uses the dtype of input_data if given, or the\n            parameters of the model. otherwise, uses the result of\n            torch.cuda.is_available().\n            default: none\n\n    dtypes (list[torch.dtype]):\n            if you use input_size, torchinfo assumes your input uses floattensors.\n            if your model use a different data type, specify that dtype.\n            for multiple inputs, specify the size of both inputs, and\n            also specify the types of each parameter here.\n            default: none\n\n    mode (str)\n            either \"train\" or \"eval\", which determines whether we call\n            model.train() or model.eval() before calling summary().\n            default: \"eval\".\n\n    row_settings (iterable[str]):\n            specify which features to show in a row. currently supported: (\n                \"ascii_only\",\n                \"depth\",\n                \"var_names\",\n            )\n            default: (\"depth\",)\n\n    verbose (int):\n            0 (quiet): no output\n            1 (default): print model summary\n            2 (verbose): show weight and bias layers in full detail\n            default: 1\n            if using a juypter notebook or google colab, the default is 0.\n\n    **kwargs:\n            other arguments used in `model.forward` function. passing *args is no\n            longer supported.\n\nreturn:\n    modelstatistics object\n            see torchinfo/model_statistics.py for more information.\n\"\"\"\n```\n\n# examples\n\n## get model summary as string\n\n```python\nfrom torchinfo import summary\n\nmodel_stats = summary(your_model, (1, 3, 28, 28), verbose=0)\nsummary_str = str(model_stats)\n# summary_str contains the string representation of the summary!\n```\n\n## explore different configurations\n\n```python\nclass lstmnet(nn.module):\n    def __init__(self, vocab_size=20, embed_dim=300, hidden_dim=512, num_layers=2):\n        super().__init__()\n        self.hidden_dim = hidden_dim\n        self.embedding = nn.embedding(vocab_size, embed_dim)\n        self.encoder = nn.lstm(embed_dim, hidden_dim, num_layers=num_layers, batch_first=true)\n        self.decoder = nn.linear(hidden_dim, vocab_size)\n\n    def forward(self, x):\n        embed = self.embedding(x)\n        out, hidden = self.encoder(embed)\n        out = self.decoder(out)\n        out = out.view(-1, out.size(2))\n        return out, hidden\n\nsummary(\n    lstmnet(),\n    (1, 100),\n    dtypes=[torch.long],\n    verbose=2,\n    col_width=16,\n    col_names=[\"kernel_size\", \"output_size\", \"num_params\", \"mult_adds\"],\n    row_settings=[\"var_names\"],\n)\n```\n\n```\n========================================================================================================================\nlayer (type (var_name))                  kernel shape         output shape         param #              mult-adds\n========================================================================================================================\nlstmnet (lstmnet)                        --                   [100, 20]            --                   --\n\u251c\u2500embedding (embedding)                  --                   [1, 100, 300]        6,000                6,000\n\u2502    \u2514\u2500weight                            [300, 20]                                 \u2514\u25006,000\n\u251c\u2500lstm (encoder)                         --                   [1, 100, 512]        3,768,320            376,832,000\n\u2502    \u2514\u2500weight_ih_l0                      [2048, 300]                               \u251c\u2500614,400\n\u2502    \u2514\u2500weight_hh_l0                      [2048, 512]                               \u251c\u25001,048,576\n\u2502    \u2514\u2500bias_ih_l0                        [2048]                                    \u251c\u25002,048\n\u2502    \u2514\u2500bias_hh_l0                        [2048]                                    \u251c\u25002,048\n\u2502    \u2514\u2500weight_ih_l1                      [2048, 512]                               \u251c\u25001,048,576\n\u2502    \u2514\u2500weight_hh_l1                      [2048, 512]                               \u251c\u25001,048,576\n\u2502    \u2514\u2500bias_ih_l1                        [2048]                                    \u251c\u25002,048\n\u2502    \u2514\u2500bias_hh_l1                        [2048]                                    \u2514\u25002,048\n\u251c\u2500linear (decoder)                       --                   [1, 100, 20]         10,260               10,260\n\u2502    \u2514\u2500weight                            [512, 20]                                 \u251c\u250010,240\n\u2502    \u2514\u2500bias                              [20]                                      \u2514\u250020\n========================================================================================================================\ntotal params: 3,784,580\ntrainable params: 3,784,580\nnon-trainable params: 0\ntotal mult-adds (m): 376.85\n========================================================================================================================\ninput size (mb): 0.00\nforward/backward pass size (mb): 0.67\nparams size (mb): 15.14\nestimated total size (mb): 15.80\n========================================================================================================================\n\n```\n\n<!-- lstm.out -->\n\n## resnet\n\n```python\nimport torchvision\n\nmodel = torchvision.models.resnet152()\nsummary(model, (1, 3, 224, 224), depth=3)\n```\n\n```\n==========================================================================================\nlayer (type:depth-idx)                   output shape              param #\n==========================================================================================\nresnet                                   [1, 1000]                 --\n\u251c\u2500conv2d: 1-1                            [1, 64, 112, 112]         9,408\n\u251c\u2500batchnorm2d: 1-2                       [1, 64, 112, 112]         128\n\u251c\u2500relu: 1-3                              [1, 64, 112, 112]         --\n\u251c\u2500maxpool2d: 1-4                         [1, 64, 56, 56]           --\n\u251c\u2500sequential: 1-5                        [1, 256, 56, 56]          --\n\u2502    \u2514\u2500bottleneck: 2-1                   [1, 256, 56, 56]          --\n\u2502    \u2502    \u2514\u2500conv2d: 3-1                  [1, 64, 56, 56]           4,096\n\u2502    \u2502    \u2514\u2500batchnorm2d: 3-2             [1, 64, 56, 56]           128\n\u2502    \u2502    \u2514\u2500relu: 3-3                    [1, 64, 56, 56]           --\n\u2502    \u2502    \u2514\u2500conv2d: 3-4                  [1, 64, 56, 56]           36,864\n\u2502    \u2502    \u2514\u2500batchnorm2d: 3-5             [1, 64, 56, 56]           128\n\u2502    \u2502    \u2514\u2500relu: 3-6                    [1, 64, 56, 56]           --\n\u2502    \u2502    \u2514\u2500conv2d: 3-7                  [1, 256, 56, 56]          16,384\n\u2502    \u2502    \u2514\u2500batchnorm2d: 3-8             [1, 256, 56, 56]          512\n\u2502    \u2502    \u2514\u2500sequential: 3-9              [1, 256, 56, 56]          16,896\n\u2502    \u2502    \u2514\u2500relu: 3-10                   [1, 256, 56, 56]          --\n\u2502    \u2514\u2500bottleneck: 2-2                   [1, 256, 56, 56]          --\n\n  ...\n  ...\n  ...\n\n\u251c\u2500adaptiveavgpool2d: 1-9                 [1, 2048, 1, 1]           --\n\u251c\u2500linear: 1-10                           [1, 1000]                 2,049,000\n==========================================================================================\ntotal params: 60,192,808\ntrainable params: 60,192,808\nnon-trainable params: 0\ntotal mult-adds (g): 11.51\n==========================================================================================\ninput size (mb): 0.60\nforward/backward pass size (mb): 360.87\nparams size (mb): 240.77\nestimated total size (mb): 602.25\n==========================================================================================\n```\n\n<!-- resnet152.out -->\n\n## multiple inputs w/ different data types\n\n```python\nclass multipleinputnetdifferentdtypes(nn.module):\n    def __init__(self):\n        super().__init__()\n        self.fc1a = nn.linear(300, 50)\n        self.fc1b = nn.linear(50, 10)\n\n        self.fc2a = nn.linear(300, 50)\n        self.fc2b = nn.linear(50, 10)\n\n    def forward(self, x1, x2):\n        x1 = f.relu(self.fc1a(x1))\n        x1 = self.fc1b(x1)\n        x2 = x2.type(torch.float)\n        x2 = f.relu(self.fc2a(x2))\n        x2 = self.fc2b(x2)\n        x = torch.cat((x1, x2), 0)\n        return f.log_softmax(x, dim=1)\n\nsummary(model, [(1, 300), (1, 300)], dtypes=[torch.float, torch.long])\n```\n\nalternatively, you can also pass in the input_data itself, and\ntorchinfo will automatically infer the data types.\n\n```python\ninput_data = torch.randn(1, 300)\nother_input_data = torch.randn(1, 300).long()\nmodel = multipleinputnetdifferentdtypes()\n\nsummary(model, input_data=[input_data, other_input_data, ...])\n```\n\n## sequentials & modulelists\n\n```python\nclass containermodule(nn.module):\n\n    def __init__(self):\n        super().__init__()\n        self._layers = nn.modulelist()\n        self._layers.append(nn.linear(5, 5))\n        self._layers.append(containerchildmodule())\n        self._layers.append(nn.linear(5, 5))\n\n    def forward(self, x):\n        for layer in self._layers:\n            x = layer(x)\n        return x\n\n\nclass containerchildmodule(nn.module):\n\n    def __init__(self):\n        super().__init__()\n        self._sequential = nn.sequential(nn.linear(5, 5), nn.linear(5, 5))\n        self._between = nn.linear(5, 5)\n\n    def forward(self, x):\n        out = self._sequential(x)\n        out = self._between(out)\n        for l in self._sequential:\n            out = l(out)\n\n        out = self._sequential(x)\n        for l in self._sequential:\n            out = l(out)\n        return out\n\nsummary(containermodule(), (1, 5))\n```\n\n```\n==========================================================================================\nlayer (type:depth-idx)                   output shape              param #\n==========================================================================================\ncontainermodule                          [1, 5]                    --\n\u251c\u2500modulelist: 1-1                        --                        --\n\u2502    \u2514\u2500linear: 2-1                       [1, 5]                    30\n\u2502    \u2514\u2500containerchildmodule: 2-2         [1, 5]                    --\n\u2502    \u2502    \u2514\u2500sequential: 3-1              [1, 5]                    --\n\u2502    \u2502    \u2502    \u2514\u2500linear: 4-1             [1, 5]                    30\n\u2502    \u2502    \u2502    \u2514\u2500linear: 4-2             [1, 5]                    30\n\u2502    \u2502    \u2514\u2500linear: 3-2                  [1, 5]                    30\n\u2502    \u2502    \u2514\u2500sequential: 3-3              --                        (recursive)\n\u2502    \u2502    \u2502    \u2514\u2500linear: 4-3             [1, 5]                    (recursive)\n\u2502    \u2502    \u2502    \u2514\u2500linear: 4-4             [1, 5]                    (recursive)\n\u2502    \u2502    \u2514\u2500sequential: 3-4              [1, 5]                    (recursive)\n\u2502    \u2502    \u2502    \u2514\u2500linear: 4-5             [1, 5]                    (recursive)\n\u2502    \u2502    \u2502    \u2514\u2500linear: 4-6             [1, 5]                    (recursive)\n\u2502    \u2502    \u2502    \u2514\u2500linear: 4-7             [1, 5]                    (recursive)\n\u2502    \u2502    \u2502    \u2514\u2500linear: 4-8             [1, 5]                    (recursive)\n\u2502    \u2514\u2500linear: 2-3                       [1, 5]                    30\n==========================================================================================\ntotal params: 150\ntrainable params: 150\nnon-trainable params: 0\ntotal mult-adds (m): 0.00\n==========================================================================================\ninput size (mb): 0.00\nforward/backward pass size (mb): 0.00\nparams size (mb): 0.00\nestimated total size (mb): 0.00\n==========================================================================================\n```\n\n<!-- container.out -->\n\n# contributing\n\nall issues and pull requests are much appreciated! if you are wondering how to build the project:\n\n- torchinfo is actively developed using the lastest version of python.\n  - changes should be backward compatible to python 3.7, and will follow python's end-of-life guidance for old versions.\n  - run `pip install -r requirements-dev.txt`. we use the latest versions of all dev packages.\n  - run `pre-commit install`.\n  - to use auto-formatting tools, use `pre-commit run -a`.\n  - to run unit tests, run `pytest`.\n  - to update the expected output files, run `pytest --overwrite`.\n  - to skip output file tests, use `pytest --no-output`\n\n# references\n\n- thanks to @sksq96, @nmhkahn, and @sangyx for providing the inspiration for this project.\n- for model size estimation @jacobkimmel ([details here](https://github.com/sksq96/pytorch-summary/pull/21))\n",
  "docs_url": null,
  "keywords": "torch pytorch torchsummary torch-summary summary keras deep-learning ml torchinfo torch-info visualize model statistics layer stats",
  "license": "mit",
  "name": "torchinfo",
  "package_url": "https://pypi.org/project/torchinfo/",
  "project_url": "https://pypi.org/project/torchinfo/",
  "project_urls": {
    "Homepage": "https://github.com/tyleryep/torchinfo"
  },
  "release_url": "https://pypi.org/project/torchinfo/1.8.0/",
  "requires_dist": [],
  "requires_python": ">=3.7",
  "summary": "model summary in pytorch, based off of the original torchsummary.",
  "version": "1.8.0",
  "releases": [],
  "developers": [
    "tyep@cs.stanford.edu",
    "tyler_yep"
  ],
  "kwds": "torchinfo torchvision torch pytorch torchsummary",
  "license_kwds": "mit",
  "libtype": "pypi",
  "id": "pypi_torchinfo",
  "homepage": "https://github.com/tyleryep/torchinfo",
  "release_count": 32,
  "dependency_ids": []
}