{
  "classifiers": [
    "development status :: 4 - beta",
    "intended audience :: developers",
    "license :: osi approved :: apache software license",
    "programming language :: python :: 2.7",
    "programming language :: python :: 3.0",
    "topic :: software development"
  ],
  "description": "# black box auditing and certifying and removing disparate impact\n\nthis repository contains a sample implementation of gradient feature auditing (gfa) meant to be generalizable to most datasets.  for more information on the repair process, see our paper on [certifying and removing disparate impact](http://arxiv.org/abs/1412.3756).  for information on the full auditing process, see our paper on [auditing black-box models for indirect influence](http://arxiv.org/abs/1602.07043).\n\n# license\n\nthis code is licensed under an [apache 2.0](https://www.apache.org/licenses/license-2.0.html) license.\n\n# setup and installation\n\n1. install pip3 if you do not already have it installed\n2. install blackboxauditing (`pip3 install blackboxauditing`)\n\n# certifying and removing disparate impact\n\nafter installing blackboxauditing, you can run the data repair described in [certifying and removing disparate impact](http://arxiv.org/abs/1412.3756) using the command `blackboxauditing-repair` on a terminal which will tell you the arguments the script takes. the required arguments are input_csv, output_csv, repair_level, and kdd. there is a required flag -p (--protected) which designates the protected feature(s). an optional flag -i (--ignored) designates features to ignore during the repair process. \n\n```\n# repair german.csv with respect to \"age\" at repair level 0.5, ignoring \"occupation\".\nblackboxauditing-repair german.csv repaired_german.csv 0.5 true -p \"age\" -i \"occupation\"\n\n# repair your_data.csv with respect to \"feat1\" and \"feat2\" at repair level 0.8.\nblackboxauditing-repair your_data.csv repaired_data.csv 0.8 false -p \"feat1\" \"feat2\"\n```\n\n# black box auditing\n\nthe below instructions focus on running gfa on a dataset (as in [auditing black-box models for indirect influence](http://arxiv.org/abs/1602.07043)).  there is also a [tutorial](https://algofairness.github.io/fatconference-2018-auditing-tutorial/) (with a jupyter notebook) from fat* 2018 and a [video](https://www.youtube.com/watch?v=rtdkl_0vlks) of the tutorial.\n\n\n## running as a python script\n\nafter installing blackboxauditing, gfa can be run on a dataset (as in [auditing black-box models for indirect influence](http://arxiv.org/abs/1602.07043)) using a simple python script. for reference, the following includes sample code:\n\n```python3\n%python\n# import blackboxauditing\nimport blackboxauditing as bba\n# import machine learning technique\nfrom blackboxauditing.model_factories import svm, decisiontree, neuralnetwork\n\n\"\"\"\nusing a preloaded dataset\n\"\"\"\n# load in preloaded dataset\ndata = bba.load_data(\"german\")\n\n# initialize the auditor and set parameters\nauditor = bba.auditor()\nauditor.modelfactory= svm\n\n# call the auditor with the data\nauditor(data, output_dir=\"german_audit_output\")\n\n# find contexts of discrimination in dataset\nauditor.find_contexts(\"age_cat\", output_dir=\"german_context_output\")\n\n\"\"\"\nusing your own dataset\n\"\"\"\n# load your own data\ndatafile = 'path/to/datafile'\ndata = bba.load_from_file(datafile)\n\n# initialize the auditor and set parameters\nauditor = bba.auditor()\nauditor.modelfactory= decisiontree\n\n# call the auditor with the data\nauditor(data, output_dir=\"german_audit_output\")\n\n# find contexts of discrimination in dataset\nauditor.find_contexts(\"age_cat\", output_dir=\"german_context_output\")\n\n```\n\n## outputs of the auditor\n### auditing with repair steps\n\ncalling the auditor on a dataset will evaluate the predictive ability of a model at different repair steps for each feature. the auditor will create a subdirectory \"<your data>_audit_output\" in the directory from which you run the auditor. this directory will contain three summary files: accuracy.png, bcr.png, and summary.txt. the two graphical summaries, accuracy.png and bcr.png, show the predictive ability of the model at different repair levels for each repaired feature, using accuracy and bcr respectively as metrics. non-graphical summaries of the audit are included in the summary.txt file. this file includes the model options used, which features were repaired, and ranks the features by the amount repair with respect to each feature affects the accuracy of the model. approximate trend groups are also included in the summary.txt file, indicating the groups of features with similar trends in the repair steps. more detailed reports of the repair with respect to each of the features are included in the remaining files of the output.\n\n### finding contexts\n\ncalling the find_contexts() method of the auditor will train a model to determine rule-based contexts for classification in the dataset. the method create a subdirectory \"<your data>_context_output\" in the directory from which you run the auditor. this directory contains a file named contexts.summary. this file includes the model options used, and the contexts of influence found in the data. the directory also contains expanded rules\n\n\n## more advanced script options\n\n#### using a preloaded dataset\n\nthe blackboxauditing package has a few datasets preloaded and ready to use for auditing. in a script, they are available via the function `load_data` which takes as input the name of the dataset and returns formatted data ready for auditing. the following is the list of preloaded datasets available for auditing:\n\n* adult\n* diabetes\n* ricci\n* german\n* glass\n* sample\n* drp\n\nrefer to the sources section down below for more information about the datasets\n\n#### using you own dataset\n\nto use your own data for auditing, the function `load_from_file`, most simply, takes as input the path to your dataset and returns formatted data ready for auditing. `load_from_file` also includes other paramters which should be set to ensure that your data is processed correctly. refer to the full function and its defaults:\n\n```\nload_from_file(datafile, testdata=none, correct_types=none, train_percentage=2.0/3.0,\n                   response_header=none, features_to_ignore=none, missing_data_symbol=\"\"\n```\n\n* *datafile*: path to your dataset\n* *testdata*: path to the dataset used for testing a model. assumes that *datafile* is the training dtata\n* *correct_types*: list of the types (str, int, or float) of the features in the data. if not given, the types will be automatically generated by inspecting the values of each feature\n* *train_percentage*: train/test split of the data given as floats\n* *response_header*: name of the response column in the data. if not given, assumes that the last column in the data is the response\n* *features_to_ignore*: list of the names of any feature than you wish to be ignored by the model\n* *missing_data_symbol*: symbol that marks missing or unknown value in the data\n\n#### auditor setup options\n\nafter initializing the auditor `auditor = blackboxauditor.auditor()`, there are a few options that can be set to tune the auditor listed as follows:\n\n`auditor.measurers`: (*default = [accuracy, bcr]*) list of measurers to use for gfa\n\n`auditor.model_options`: (*default = {}*) options for machine learning model\n\n`auditor.verbose`: (*default = true*) set to \"true\" to allow for more detailed status updates\n\n`auditor.repair_steps`: (*default = 10*) number of repair steps take \n\n`auditor.retrain_model_per_repair`: (*default = false*) \n\n`auditor.write_original_predictions`: (*default = true*)\n\n`auditor.modelfactory`: (*default = svm*) available machine learning options: svm, decisiontree, neuralnetwork\n\n`auditor.kdd`: (*default = false*) \n\n#### auditor call options\n\nonce the auditor is initialized and tuned `auditor = blackboxauditor.auditor()`, there are a few options that can be set to configure how the audit is run. refer to the full audit call and its defaults:\n\n```\nauditor(data, output_dir=none, dump_all=false, features_to_audit=none)\n```\n\n* *data*: data object returned from calling either `load_data' or `load_from_file`\n* *output_dir*: name of the directory that audit files will be dumped to. if no output directory is specified, a default directory will be generated\n* *dump_all*: boolean value. if true, all files generated by the audit will be dumped including all original and repaired files, predictions files, audit files, and graphs. if false, only audit files and full repaired files will be dumped.\n* *features_to_audit*: list of specific features that should be audited. if none specified, all features will be audited\n\n#### finding contexts of influence\n\n`find_contexts` uses a cn2 rule learner to learn a rule list for the data and then uses both the rule list and information from a full audit to extract groups of features that have significant influence on the response label in the context of a given feature of interest. \n \ncompleting a full audit is required before calling find_contexts. calling find_contexts on a partial audit will raise a `runtimeerror`. refer to the following function call and its defaults:\n\n```\nfind_contexts(removed_attr, output_dir, beam_width=10, min_covered_examples=1, max_rule_length=5, by_original=true, epsilon=0.05)\n```\n\n* *removed_attr*: name of the feature which the contexts of influence will be found with respect to. audited data obscured with respect to this feature will be used. \n* *output_dir*: name of the directory that the context results will be dumped to.\n* *beam_width*: the number of solution streams considered at one time when searching for rules in the cn2 algorithm.\n* *min_covered_examples*: the minimum number of examples a found rule must cover to be considered as an addition to the rule list.\n* *max_rule_length*: the maximum number of conditions that found rules may combine.\n* *by_original*: consider the best expanded rule within epsilon of original quality (true) or best quality of expanded rules (false).\n* *epsilon*: number within which we consider best expanded rule of the original quality.\n\n## testing code changes\n\nafter blackboxauditing has been installed, you can run the test suite using the command on a terminal `blackboxauditing-test`.\n\nevery python file should include test functions at the bottom that will be run when the file is run. this can be done by including the line `if __name__==\"__main__\": test()` as long as there is a function defined as `test`.\n\nthese tests should use print statements with `true` or `false` readouts indicating success or failure (where `true` should always be success). it is fine/good to have multiple of these per file.\n\nnote: if a test requires reading data from the `test_data` directory, it should import the appropriate `load_data` file from the `experiments` directory.\n\n## implementing a new machine-learning method\n\nthe best way to create a model would be to use a modelfactory and modelvisitors. a modelvisitor should be thought of as a wrapper that knows how to load a machine-learning model of a given type and communicate with that model file in order to output predicted values of some test dataset. a modelfactory simply knows how to \"build\" a modelvisitor based on some provided training data. check out the \"abstract\" files in the `sample_experiment` directory for outlines of what these two classes should do.\n\n# for local developers\n\n## upload a new version of bba\n\nthe following details instructions for uploading an updated version of bba to pypi. if you do not have twine and setuptools installs, install them with the following commands:\n\n```\npip install twine\npip install -u pip setuptools\n```\nonce all changes to the code have been tested, update the version number of bba in `blackboxauditing/setup.py` by modifying the variable `version`.\n\nif any non-python files were added to bba that need to be included in the updated distribution, be sure to include them in the file `blackboxauditing/manifest.in`. also update the `blackboxauditing/requirements.txt` if necessary.\n\nto create the source distribution of the project, run the following command:\n\n```\npython3 setup.py sdist\n```\n\nthis will add the distribution to a directory `dist/`. once the source distribution has been created, upload it pypi using twine:\n\n```\ntwine upload dist/blackboxauditing-0.x.y.tar.gz\n```\n\nwhere 0.x.y is the version number of the updated project. this will prompt the user to input the username and password of the pypi account under which bba is registered.\n\nfor more information and details for distributing a python project with twine, visit https://packaging.python.org/tutorials/distributing-packages/.\n\n# sources\n\ndataset sources:\n - adult.csv [link](https://archive.ics.uci.edu/ml/datasets/adult)\n - german_categorical.csv (modified from [link](https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data))\n - riccidatamod.csv (modified from [link](http://www.amstat.org/publications/jse/v18n3/riccidata.csv))\n - drp datasets (source and data-files coming soon.)\n - arrests/recidivism datasets [link](http://www.icpsr.umich.edu/icpsrweb/rcmd/studies/3355)\n - linear datasets (\"sample_2\" experiment) [link](https://github.com/jasonbaldridge/try-tf)\n\nmore information on drp can be found at the [dark reactions project](http://darkreactions.haverford.edu/) official site.\n\n# bug reports and feature-requests\n\nall bug reports and feature-requests should be submitted through the [issue tracker](https://github.com/cfalk/blackboxauditing/issues).",
  "docs_url": null,
  "keywords": "algorithmic fairness",
  "license": "apache 2.0",
  "name": "blackboxauditing",
  "package_url": "https://pypi.org/project/BlackBoxAuditing/",
  "project_url": "https://pypi.org/project/BlackBoxAuditing/",
  "project_urls": {
    "Homepage": "https://github.com/algofairness/BlackBoxAuditing"
  },
  "release_url": "https://pypi.org/project/BlackBoxAuditing/0.1.54/",
  "requires_dist": [],
  "requires_python": "",
  "summary": "sample implementation of gradient feature auditing (gfa)",
  "version": "0.1.54",
  "releases": [],
  "developers": [
    "fairness@haverford.edu",
    "philip_adler"
  ],
  "kwds": "auditing discrimination audited fairness blackboxauditing",
  "license_kwds": "apache 2.0",
  "libtype": "pypi",
  "id": "pypi_blackboxauditing",
  "homepage": "https://github.com/algofairness/blackboxauditing",
  "release_count": 53,
  "dependency_ids": []
}