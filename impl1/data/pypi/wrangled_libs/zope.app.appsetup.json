{
  "classifiers": [
    "development status :: 5 - production/stable",
    "environment :: web environment",
    "framework :: zope :: 3",
    "intended audience :: developers",
    "license :: osi approved :: zope public license",
    "natural language :: english",
    "operating system :: os independent",
    "programming language :: python :: 3",
    "programming language :: python :: 3.10",
    "programming language :: python :: 3.11",
    "programming language :: python :: 3.7",
    "programming language :: python :: 3.8",
    "programming language :: python :: 3.9",
    "programming language :: python :: implementation",
    "programming language :: python :: implementation :: cpython",
    "programming language :: python :: implementation :: pypy",
    "topic :: internet :: www/http"
  ],
  "description": "zope.app.appsetup readme\n========================\n\nthis package provides application setup helpers for the zope3 appserver.\n\n\n.. contents::\n\nbootstrap helpers\n=================\n\nthe bootstrap helpers provide a number of functions that help with\nbootstrapping.\n\nthe bootstrapsubscriber function makes sure that there is a root\nobject.  it subscribes to databaseopened events:\n\n    >>> from zope.app.appsetup import bootstrap\n    >>> import zope.processlifetime\n\n    >>> from zodb.mappingstorage import db\n    >>> db = db()\n    >>> bootstrap.bootstrapsubscriber(zope.processlifetime.databaseopened(db))\n\nthe subscriber makes sure that there is a root folder:\n\n    >>> from zope.app.publication.zopepublication import zopepublication\n    >>> conn = db.open()\n    >>> root = conn.root()[zopepublication.root_name]\n    >>> sm = root.getsitemanager()\n    >>> conn.close()\n\na databaseopenedwithroot is generated with the database.\n\n    >>> from zope.component.eventtesting import getevents\n    >>> [event] = getevents(zope.processlifetime.idatabaseopenedwithroot)\n    >>> event.database is db\n    true\n\ngenerally, startup code that expects the root object and site to have\nbeen created will want to subscribe to this event, not\nidatabaseopenedevent.\n\nthe subscriber generates the event whether or not the root had to be\nset up:\n\n    >>> bootstrap.bootstrapsubscriber(zope.processlifetime.databaseopened(db))\n    >>> [e, event] = getevents(zope.processlifetime.idatabaseopenedwithroot)\n    >>> event.database is db\n    true\n\n\ncheck the security policy\n-------------------------\n\nwhen the security policy got refactored to be really pluggable, the\ninclusion of the security policy configuration was moved to the very\ntop level, to site.zcml.  this happened in r24770, after zopex3 3.0\nwas released, but before 3.1.\n\nnow the maintainers of existing 3.0 sites need to manually update\ntheir site.zcml to include securitypolicy.zcml while upgrading to 3.1.\nsee also http://www.zope.org/collectors/zope3-dev/381 .\n\n    >>> from zope.testing.loggingsupport import installedhandler\n    >>> handler = installedhandler('zope.app.appsetup')\n\nif the security policy is unset from the default\nparanoidsecuritypolicy, we get a warning:\n\n    >>> from zope.app.appsetup.bootstrap import checksecuritypolicy\n    >>> event = object()\n    >>> checksecuritypolicy(event)\n    >>> print(handler)\n    zope.app.appsetup warning\n      security policy is not configured.\n    please make sure that securitypolicy.zcml is included in site.zcml immediately\n    before principals.zcml\n\nhowever, if any non-default security policy is installed, no warning\nis emitted:\n\n    >>> from zope.security.management import setsecuritypolicy\n    >>> defaultpolicy = setsecuritypolicy(object())\n    >>> handler.clear()\n    >>> checksecuritypolicy(event)\n    >>> print(handler)\n    <blankline>\n\nclean up:\n\n    >>> handler.uninstall()\n\n\ndebug console\n=============\n\nthe debug console lets you have a python prompt with the full zope\nenvironment loaded (which includes the zcml configuration, as well as an open\ndatabase connection).\n\nlet's define a helper to run the debug script and trap systemexit exceptions\nthat would otherwise hide the output\n\n    >>> from __future__ import print_function\n    >>> import sys\n    >>> from zope.app.appsetup import debug\n    >>> def run(*args):\n    ...     sys.argv[0] = 'debug'\n    ...     sys.stderr = sys.stdout\n    ...     try:\n    ...         debug.main(args)\n    ...     except systemexit as e:\n    ...         print(\"(exited with status %d)\" % e.code)\n\nif you call the script with no arguments, it displays a brief error message\non stderr\n\n    >>> run()\n    error: please specify a configuration file\n    for help, use debug -h\n    (exited with status 2)\n\nwe need to pass a zconfig configuration file as an argument\n\n    >>> run('-c', 'test.conf.txt')\n    the application root is known as `root`.\n\nnow you have the root object from the open database available as a global\nvariable named 'root' in the __main__ module:\n\n    >>> main_module = sys.modules['__main__']\n    >>> main_module.root            # doctest: +ellipsis\n    <zope.site.folder.folder object at ...>\n\nand we have asked python to enter interactive mode by setting the\npythoninspect environment variable\n\n    >>> import os\n    >>> os.environ.get('pythoninspect')\n    'true'\n\nwe have to do extra work to honor the pythonstartup environment variable:\n\n    >>> pythonstartup = os.path.join(os.path.dirname(debug.__file__),\n    ...                              'testdata', 'pythonstartup.py')\n    >>> os.environ['pythonstartup'] = pythonstartup\n    >>> run('-c', 'test.conf.txt')\n    the application root is known as `root`.\n\nyou can see that our pythonstartup file was executed because it changed\nthe prompt\n\n    >>> sys.ps1\n    'debug> '\n\n\n\nproduct-specific configuration\n==============================\n\nthe ``product`` module of this package provides a very simple way to deal with\nwhat has traditionally been called \"product configuration\", where \"product\"\nrefers to the classic zope 2 notion of a product.\n\nthe configuration schema for the application server allows named\n<product-config> sections to be added to the configuration file, and product\ncode can use the api provided by the module to retrieve configuration sections\nfor given names.\n\nthere are two public functions in the module that should be used in normal\noperations, and additional functions and a class that can be used to help with\ntesting:\n\n    >>> from __future__ import print_function\n    >>> from zope.app.appsetup import product\n\nlet's look at the helper class first, since we'll use it in describing the\npublic (application) interface.  we'll follow that with the functions for\nnormal operation, then the remaining test-support functions.\n\n\nfaux configuration object\n-------------------------\n\nthe ``fauxconfiguration`` class constructs objects that behave like the\nzconfig section objects to the extent needed for the product configuration\napi.  these will be used here, and may also be used to create configurations\nfor testing components that consume such configuration.\n\nthe constructor requires two arguments: the name of the section, and a mapping\nof keys to values that the section should provide.  let's create a simple\nexample:\n\n    >>> one = product.fauxconfiguration(\"one\", {})\n    >>> one.getsectionname()\n    'one'\n    >>> one.mapping\n    {}\n\nproviding a non-empty set of key/value pairs trivially behaves as expected:\n\n    >>> two = product.fauxconfiguration(\"two\", {\"abc\": \"def\"})\n    >>> two.getsectionname()\n    'two'\n    >>> two.mapping\n    {'abc': 'def'}\n\n\napplication api\n---------------\n\nthere are two functions in the application interface for this module.  one is\nused by the configuration provider, and the other is used by the consumer.\n\nthe provider's api takes a sequence of configuration objects that conform to\nthe behaviors exhibited by the default zconfig section objects.  since the\n``fauxconfiguration`` class provides these behaviors, we can easily see how\nthis can be used:\n\n    >>> product.setproductconfigurations([one, two])\n\nnow that we've established some configuration, we want to be able to use it.\nwe do this using the ``getproductconfiguration()`` function.  this function\ntakes a name and returns a matching configuration section if there is one, of\nnone if not:\n\n    >>> product.getproductconfiguration(\"one\")\n    {}\n\n    >>> product.getproductconfiguration(\"not-there\") is none\n    true\n\nnote that for a section that exists, only the internal mapping is provided,\nnot the containing section object.  this is a historical wart; we'll just need\nto live with it until new apis are introduced.\n\nsetting the configuration a second time will overwrite the prior\nconfiguration; sections previously available will no longer be:\n\n    >>> product.setproductconfigurations([two])\n    >>> product.getproductconfiguration(\"one\") is none\n    true\n\nthe new sections are available, as expected:\n\n    >>> product.getproductconfiguration(\"two\")\n    {'abc': 'def'}\n\n\ntest support functions\n----------------------\n\nadditional functions are provided that make it easier to manage configuration\nstate in testing.\n\nthe first can be used to provide configuration for a single name.  the\nfunction takes a name and either a configuration mapping or ``none`` as\narguments.  if ``none`` is provided as the second argument, any configuration\nsettings for the name are removed, if present.  if the second argument is not\n``none``, it will be used as the return value for ``getproductconfiguration``\nfor the given name.\n\n    >>> product.setproductconfiguration(\"first\", none)\n    >>> print(product.getproductconfiguration(\"first\"))\n    none\n\n    >>> product.setproductconfiguration(\"first\", {\"key\": \"value1\"})\n    >>> product.getproductconfiguration(\"first\")\n    {'key': 'value1'}\n\n    >>> product.setproductconfiguration(\"first\", {\"key\": \"value2\"})\n    >>> product.getproductconfiguration(\"first\")\n    {'key': 'value2'}\n\n    >>> product.setproductconfiguration(\"first\", {\"alt\": \"another\"})\n    >>> product.getproductconfiguration(\"first\")\n    {'alt': 'another'}\n\n    >>> product.setproductconfiguration(\"second\", {\"you\": \"there\"})\n    >>> product.getproductconfiguration(\"first\")\n    {'alt': 'another'}\n    >>> product.getproductconfiguration(\"second\")\n    {'you': 'there'}\n\n    >>> product.setproductconfiguration(\"first\", none)\n    >>> print(product.getproductconfiguration(\"first\"))\n    none\n\nthe other two functions work in concert, saving and restoring the entirety of\nthe configuration state.\n\nour current configuration includes data for the \"second\" key, and none for the\n\"first\" key:\n\n    >>> print(product.getproductconfiguration(\"first\"))\n    none\n    >>> print(product.getproductconfiguration(\"second\"))\n    {'you': 'there'}\n\nlet's save this state:\n\n    >>> state = product.saveconfiguration()\n\nnow let's replace the kitchen sink:\n\n    >>> product.setproductconfigurations([\n    ...     product.fauxconfiguration(\"x\", {\"a\": \"b\"}),\n    ...     product.fauxconfiguration(\"y\", {\"c\": \"d\"}),\n    ...     ])\n\n    >>> print(product.getproductconfiguration(\"first\"))\n    none\n    >>> print(product.getproductconfiguration(\"second\"))\n    none\n\n    >>> product.getproductconfiguration(\"x\")\n    {'a': 'b'}\n    >>> product.getproductconfiguration(\"y\")\n    {'c': 'd'}\n\nthe saved configuration state can be restored:\n\n    >>> product.restoreconfiguration(state)\n\n    >>> print(product.getproductconfiguration(\"x\"))\n    none\n    >>> print(product.getproductconfiguration(\"y\"))\n    none\n\n    >>> print(product.getproductconfiguration(\"first\"))\n    none\n    >>> print(product.getproductconfiguration(\"second\"))\n    {'you': 'there'}\n\nthere's an additional function that can be used to load product configuration\nfrom a file object; only product configuration components are accepted.  the\nfunction returns a mapping of names to configuration objects suitable for\npassing to ``setproductconfiguration``.  using this with\n``setproductconfigurations`` would require constructing ``fauxconfiguration``\nobjects.\n\nlet's create some sample configuration text:\n\n    >>> product_config = '''\n    ... <product-config product1>\n    ...   key1 product1-value1\n    ...   key2 product1-value2\n    ... </product-config>\n    ...\n    ... <product-config product2>\n    ...   key1 product2-value1\n    ...   key3 product2-value2\n    ... </product-config>\n    ... '''\n\nwe can now load the configuration using the ``loadconfiguration`` function:\n\n    >>> import io\n    >>> import pprint\n\n    >>> sio = io.stringio(product_config)\n    >>> config = product.loadconfiguration(sio)\n\n    >>> pprint.pprint(config, width=1)\n    {'product1': {'key1': 'product1-value1',\n                   'key2': 'product1-value2'},\n     'product2': {'key1': 'product2-value1',\n                   'key3': 'product2-value2'}}\n\nextensions that provide product configurations can be used as well:\n\n    >>> product_config = '''\n    ... %import zope.app.appsetup.testproduct\n    ...\n    ... <testproduct foobar>\n    ... </testproduct>\n    ...\n    ... <testproduct barfoo>\n    ...   key1 value1\n    ...   key2 value2\n    ... </testproduct>\n    ... '''\n\n    >>> sio = io.stringio(product_config)\n    >>> config = product.loadconfiguration(sio)\n\n    >>> pprint.pprint(config, width=1)\n    {'barfoo': {'key1': 'value1',\n                 'key2': 'value2',\n                 'product-name': 'barfoo'},\n     'foobar': {'product-name': 'foobar'}}\n\n\nchangelog\n=========\n\n5.0 (2023-02-09)\n----------------\n\n- add support for python 3.9, 3.10, 3.11.\n\n- drop support for python 2.7, 3.5, 3.6.\n\n\n4.2.0 (2020-05-20)\n------------------\n\n- drop support for ``python setup.py test``.\n\n- add support for python 3.8.\n\n- drop support for python 3.4.\n\n\n4.1.0 (2018-12-15)\n------------------\n\n- add support for python 3.6, 3.7 and pypy3.\n\n- drop support for python 3.3.\n\n\n4.0.0 (2016-08-08)\n------------------\n\n- add dependency on ``zdaemon`` (split off from ``zodb``).\n\n- claim support for python 3.4, 3.5 and pypy which requires\n  ``zope.app.publication`` >= 4.0.\n\n- drop python 2.6 support.\n\n4.0.0a1 (2013-03-03)\n--------------------\n\n- added support for python 3.3.\n\n- replaced deprecated ``zope.interface.implements`` usage with equivalent\n  ``zope.interface.implementer`` decorator.\n\n- dropped support for python 2.4 and 2.5.\n\n\n3.16.0 (2011-01-27)\n-------------------\n\n- added stacking of storages for layer/test level setup separation in derived\n  zodblayers.\n\n\n3.15.0 (2010-09-25)\n-------------------\n\n- updated tests to run with `zope.testing >= 3.10`, requiring at least this\n  version and `zope.testrunner`.\n\n- switch ``ierrorreportingutility copy_to_zlog`` field to ``true``.\n\n- using python's `doctest` module instead of depreacted\n  `zope.testing.doctest`.\n\n\n3.14.0 (2010-04-13)\n-------------------\n\n- made `zope.testing` an optional (test) dependency.\n\n- removed test dependency on `zope.app.testing`.\n\n\n3.13.0 (2009-12-24)\n-------------------\n\n- import hooks functionality from zope.component after it was moved there from\n  zope.site.\n\n- import isite from zope.component after it was moved there from\n  zope.location. this lifts the dependency on zope.location.\n\n- added missing install dependency on `zope.testing`.\n\n\n3.12.0 (2009-06-20)\n-------------------\n\n- using ``zope.processlifetime`` interfaces and implementations\n  directly instead of bbb imports from ``zope.app.appsetup``.\n\n- got rid of depencency on ``zope.app.component``.\n\n- got rid of test dependency on ``zope.app.security``.\n\n\n3.11 (2009-05-13)\n-----------------\n\n- event interfaces / implementations moved to ``zope.processlifetime``,\n  version 1.0.  depend on this package, and add bbb imports.\n\n\n3.10.1 (2009-03-31)\n-------------------\n\n- fixed a ``deprecationwarning`` introduced in 3.10.0.\n\n- added doctests to long description to show up at pypi.\n\n\n3.10.0 (2009-03-19)\n-------------------\n\n- finally deprecate the \"asobject\" argument of helper functions in the\n  ``zope.app.appsetup.bootstrap`` module. if your code uses any of these\n  functions, please remove the \"asobject=true\" argument passing anywhere,\n  because the support for that argument will be dropped soon.\n\n- move session utility bootstrapping logic from ``zope.session`` into this\n  package. this removes a dependency from zope.session to this package.\n\n- remove one more deprecated function.\n\n\n3.9.0 (2009-01-31)\n------------------\n\n- use ``zope.site`` instead of ``zope.app.folder`` and\n  ``zope.app.component``.\n\n- use ``zope.container`` instead of ``zope.app.container``.\n\n- move error log bootstrapping logic from ``zope.error`` into this\n  package.  this removes a dependency from zope.error to this\n  package. also added a test for bootstrapping the error log here,\n  which was missing in ``zope.error``.\n\n\n3.8.0 (2008-08-25)\n------------------\n\n- feature: developed an entry point that allows you to quickly bring up an\n  application instance for debugging purposes. (implemented by marius gedminas\n  and stephan richter.)\n\n\n3.7.0 (2008-08-19)\n------------------\n\n- added ``.product.loadconfiguration`` test-support function; loads product\n  configuration (only) from a file object, allowing test code (including\n  setup) to make use of the same configuration schema support used by normal\n  startup.\n\n\n3.6.0 (2008-07-23)\n------------------\n\n- added additional test support functions to set the configuration for a\n  single section, and save/restore the entire configuration.\n\n\n3.5.0 (2008-06-17)\n------------------\n\n- added helper class for supporting product configuration tests.\n\n- added documentation for the product configuration api, with tests.\n\n\n3.4.1 (2007-09-27)\n------------------\n\n- egg was faulty, re-released.\n\n\n3.4.0 (2007-09-25)\n------------------\n\n- initial documented release.\n\n- reflect changes form zope.app.error refactoring.\n",
  "docs_url": null,
  "keywords": "zope3 app setup",
  "license": "zpl 2.1",
  "name": "zope.app.appsetup",
  "package_url": "https://pypi.org/project/zope.app.appsetup/",
  "project_url": "https://pypi.org/project/zope.app.appsetup/",
  "project_urls": {
    "Homepage": "https://github.com/zopefoundation/zope.app.appsetup"
  },
  "release_url": "https://pypi.org/project/zope.app.appsetup/5.0/",
  "requires_dist": [
    "ZODB",
    "zdaemon",
    "setuptools",
    "zope.app.publication (>=4.0)",
    "zope.component (>=3.8.0)",
    "zope.configuration",
    "zope.container (>=4.0.0a2)",
    "zope.error",
    "zope.event",
    "zope.interface",
    "zope.processlifetime",
    "zope.security (>=4.0.0a2)",
    "zope.session (>=4.0.0a1)",
    "zope.site (>=4.0.0a1)",
    "zope.traversing (>=4.0.0a2)",
    "zope.componentvocabulary (>=2.0.0a1) ; extra == 'test'",
    "zope.principalregistry (>=4.0.0a1) ; extra == 'test'",
    "zope.testing (>=3.10) ; extra == 'test'",
    "zope.testrunner ; extra == 'test'"
  ],
  "requires_python": ">=3.7",
  "summary": "zope app setup helper",
  "version": "5.0",
  "releases": [],
  "developers": [
    "zope-dev@zope.dev",
    "zope_corporation_and_contributors"
  ],
  "kwds": "zopepublication zconfig zope3 zopex3 zope",
  "license_kwds": "zpl 2.1",
  "libtype": "pypi",
  "id": "pypi_zope.app.appsetup",
  "homepage": "https://github.com/zopefoundation/zope.app.appsetup",
  "release_count": 22,
  "dependency_ids": [
    "pypi_setuptools",
    "pypi_zdaemon",
    "pypi_zodb",
    "pypi_zope.app.publication",
    "pypi_zope.component",
    "pypi_zope.componentvocabulary",
    "pypi_zope.configuration",
    "pypi_zope.container",
    "pypi_zope.error",
    "pypi_zope.event",
    "pypi_zope.interface",
    "pypi_zope.principalregistry",
    "pypi_zope.processlifetime",
    "pypi_zope.security",
    "pypi_zope.session",
    "pypi_zope.site",
    "pypi_zope.testing",
    "pypi_zope.testrunner",
    "pypi_zope.traversing"
  ]
}