{
  "classifiers": [
    "development status :: 5 - production/stable",
    "intended audience :: developers",
    "license :: osi approved",
    "operating system :: os independent",
    "programming language :: javascript",
    "programming language :: python :: 3 :: only",
    "programming language :: python :: 3.10",
    "programming language :: python :: 3.11",
    "programming language :: python :: 3.8",
    "programming language :: python :: 3.9",
    "typing :: typed"
  ],
  "description": "<!--\ncopyright amazon.com, inc. or its affiliates. all rights reserved.\nspdx-license-identifier: apache-2.0\n-->\n\n# cdk-nag\n\n[![pypi version](https://img.shields.io/pypi/v/cdk-nag)](https://pypi.org/project/cdk-nag/)\n[![npm version](https://img.shields.io/npm/v/cdk-nag)](https://www.npmjs.com/package/cdk-nag)\n[![maven version](https://img.shields.io/maven-central/v/io.github.cdklabs/cdknag)](https://search.maven.org/search?q=a:cdknag)\n[![nuget version](https://img.shields.io/nuget/v/cdklabs.cdknag)](https://www.nuget.org/packages/cdklabs.cdknag)\n[![go version](https://img.shields.io/github/go-mod/go-version/cdklabs/cdk-nag-go?color=blue&filename=cdknag%2fgo.mod)](https://github.com/cdklabs/cdk-nag-go)\n\n[![view on construct hub](https://constructs.dev/badge?package=cdk-nag)](https://constructs.dev/packages/cdk-nag)\n\ncheck cdk applications or [cloudformation templates](#using-on-cloudformation-templates) for best practices using a combination of available rule packs. inspired by [cfn_nag](https://github.com/stelligent/cfn_nag).\n\ncheck out [this blog post](https://aws.amazon.com/blogs/devops/manage-application-security-and-compliance-with-the-aws-cloud-development-kit-and-cdk-nag/) for a guided overview!\n\n![demo](cdk_nag.gif)\n\n## available rules and packs\n\nsee [rules](./rules.md) for more information on all the available packs.\n\n1. [aws solutions](./rules.md#awssolutions)\n2. [hipaa security](./rules.md#hipaa-security)\n3. [nist 800-53 rev 4](./rules.md#nist-800-53-rev-4)\n4. [nist 800-53 rev 5](./rules.md#nist-800-53-rev-5)\n5. [pci dss 3.2.1](./rules.md#pci-dss-321)\n\n[rules](./rules.md) also includes a collection of [additional rules](./rules.md#additional-rules) that are not currently included in any of the pre-built nagpacks, but are still available for inclusion in custom nagpacks.\n\nread the [nagpack developer docs](./docs/nagpack.md) if you are interested in creating your own pack.\n\n## usage\n\nfor a full list of options see `nagpackprops` in the [api.md](./api.md#struct-nagpackprops)\n\n<details>\n<summary>including in an application</summary>\n\n```python\nimport { app, aspects } from 'aws-cdk-lib';\nimport { cdkteststack } from '../lib/cdk-test-stack';\nimport { awssolutionschecks } from 'cdk-nag';\n\nconst app = new app();\nnew cdkteststack(app, 'cdknagdemo');\n// simple rule informational messages\naspects.of(app).add(new awssolutionschecks());\n// additional explanations on the purpose of triggered rules\n// aspects.of(stack).add(new awssolutionschecks({ verbose: true }));\n```\n\n</details>\n\n## suppressing a rule\n\n<details>\n  <summary>example 1) default construct</summary>\n\n```python\nimport { securitygroup, vpc, peer, port } from 'aws-cdk-lib/aws-ec2';\nimport { stack, stackprops } from 'aws-cdk-lib';\nimport { construct } from 'constructs';\nimport { nagsuppressions } from 'cdk-nag';\n\nexport class cdkteststack extends stack {\n  constructor(scope: construct, id: string, props?: stackprops) {\n    super(scope, id, props);\n    const test = new securitygroup(this, 'test', {\n      vpc: new vpc(this, 'vpc'),\n    });\n    test.addingressrule(peer.anyipv4(), port.alltraffic());\n    nagsuppressions.addresourcesuppressions(test, [\n      { id: 'awssolutions-ec23', reason: 'lorem ipsum' },\n    ]);\n  }\n}\n```\n\n</details><details>\n  <summary>example 2) on multiple constructs</summary>\n\n```python\nimport { securitygroup, vpc, peer, port } from 'aws-cdk-lib/aws-ec2';\nimport { stack, stackprops } from 'aws-cdk-lib';\nimport { construct } from 'constructs';\nimport { nagsuppressions } from 'cdk-nag';\n\nexport class cdkteststack extends stack {\n  constructor(scope: construct, id: string, props?: stackprops) {\n    super(scope, id, props);\n    const vpc = new vpc(this, 'vpc');\n    const test1 = new securitygroup(this, 'test', { vpc });\n    test1.addingressrule(peer.anyipv4(), port.alltraffic());\n    const test2 = new securitygroup(this, 'test', { vpc });\n    test2.addingressrule(peer.anyipv4(), port.alltraffic());\n    nagsuppressions.addresourcesuppressions(\n      [test1, test2],\n      [{ id: 'awssolutions-ec23', reason: 'lorem ipsum' }]\n    );\n  }\n}\n```\n\n</details><details>\n  <summary>example 3) child constructs</summary>\n\n```python\nimport { user, policystatement } from 'aws-cdk-lib/aws-iam';\nimport { stack, stackprops } from 'aws-cdk-lib';\nimport { construct } from 'constructs';\nimport { nagsuppressions } from 'cdk-nag';\n\nexport class cdkteststack extends stack {\n  constructor(scope: construct, id: string, props?: stackprops) {\n    super(scope, id, props);\n    const user = new user(this, 'ruser');\n    user.addtopolicy(\n      new policystatement({\n        actions: ['s3:putobject'],\n        resources: ['arn:aws:s3:::bucket_name/*'],\n      })\n    );\n    // enable adding suppressions to child constructs\n    nagsuppressions.addresourcesuppressions(\n      user,\n      [\n        {\n          id: 'awssolutions-iam5',\n          reason: 'lorem ipsum',\n          appliesto: ['resource::arn:aws:s3:::bucket_name/*'], // optional\n        },\n      ],\n      true\n    );\n  }\n}\n```\n\n</details><details>\n  <summary>example 4) stack level </summary>\n\n```python\nimport { app, aspects } from 'aws-cdk-lib';\nimport { cdkteststack } from '../lib/cdk-test-stack';\nimport { awssolutionschecks, nagsuppressions } from 'cdk-nag';\n\nconst app = new app();\nconst stack = new cdkteststack(app, 'cdknagdemo');\naspects.of(app).add(new awssolutionschecks());\nnagsuppressions.addstacksuppressions(stack, [\n  { id: 'awssolutions-ec23', reason: 'lorem ipsum' },\n]);\n```\n\n</details><details>\n  <summary>example 5) construct path</summary>\n\nif you received the following error on synth/deploy\n\n```bash\n[error at /stackname/custom::cdkbucketdeployment8675309/servicerole/resource] awssolutions-iam4: the iam user, role, or group uses aws managed policies\n```\n\n```python\nimport { bucket } from 'aws-cdk-lib/aws-s3';\nimport { bucketdeployment } from 'aws-cdk-lib/aws-s3-deployment';\nimport { stack, stackprops } from 'aws-cdk-lib';\nimport { construct } from 'constructs';\nimport { nagsuppressions } from 'cdk-nag';\n\nexport class cdkteststack extends stack {\n  constructor(scope: construct, id: string, props?: stackprops) {\n    super(scope, id, props);\n    new bucketdeployment(this, 'rdeployment', {\n      sources: [],\n      destinationbucket: bucket.frombucketname(this, 'rbucket', 'foo'),\n    });\n    nagsuppressions.addresourcesuppressionsbypath(\n      this,\n      '/stackname/custom::cdkbucketdeployment8675309/servicerole/resource',\n      [{ id: 'awssolutions-iam4', reason: 'at least 10 characters' }]\n    );\n  }\n}\n```\n\n</details><details>\n  <summary>example 6) granular suppressions of findings</summary>\n\ncertain rules support granular suppressions of `findings`. if you received the following errors on synth/deploy\n\n```bash\n[error at /stackname/rfirstuser/defaultpolicy/resource] awssolutions-iam5[action::s3:*]: the iam entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission.\n[error at /stackname/rfirstuser/defaultpolicy/resource] awssolutions-iam5[resource::*]: the iam entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission.\n[error at /stackname/rseconduser/defaultpolicy/resource] awssolutions-iam5[action::s3:*]: the iam entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission.\n[error at /stackname/rseconduser/defaultpolicy/resource] awssolutions-iam5[resource::*]: the iam entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission.\n```\n\nby applying the following suppressions\n\n```python\nimport { user } from 'aws-cdk-lib/aws-iam';\nimport { stack, stackprops } from 'aws-cdk-lib';\nimport { construct } from 'constructs';\nimport { nagsuppressions } from 'cdk-nag';\n\nexport class cdkteststack extends stack {\n  constructor(scope: construct, id: string, props?: stackprops) {\n    super(scope, id, props);\n    const firstuser = new user(this, 'rfirstuser');\n    firstuser.addtopolicy(\n      new policystatement({\n        actions: ['s3:*'],\n        resources: ['*'],\n      })\n    );\n    const seconduser = new user(this, 'rseconduser');\n    seconduser.addtopolicy(\n      new policystatement({\n        actions: ['s3:*'],\n        resources: ['*'],\n      })\n    );\n    const thirduser = new user(this, 'rseconduser');\n    thirduser.addtopolicy(\n      new policystatement({\n        actions: ['sqs:createqueue'],\n        resources: [`arn:aws:sqs:${this.region}:${this.account}:*`],\n      })\n    );\n    nagsuppressions.addresourcesuppressions(\n      firstuser,\n      [\n        {\n          id: 'awssolutions-iam5',\n          reason:\n            \"only suppress awssolutions-iam5 's3:*' finding on first user.\",\n          appliesto: ['action::s3:*'],\n        },\n      ],\n      true\n    );\n    nagsuppressions.addresourcesuppressions(\n      seconduser,\n      [\n        {\n          id: 'awssolutions-iam5',\n          reason: 'suppress all awssolutions-iam5 findings on second user.',\n        },\n      ],\n      true\n    );\n    nagsuppressions.addresourcesuppressions(\n      thirduser,\n      [\n        {\n          id: 'awssolutions-iam5',\n          reason: 'suppress awssolutions-iam5 on the sqs resource.',\n          appliesto: [\n            {\n              regex: '/^resource::arn:aws:sqs:(.*):\\\\*$/g',\n            },\n          ],\n        },\n      ],\n      true\n    );\n  }\n}\n```\n\nyou would see the following error on synth/deploy\n\n```bash\n[error at /stackname/rfirstuser/defaultpolicy/resource] awssolutions-iam5[resource::*]: the iam entity contains wildcard permissions and does not have a cdk-nag rule suppression with evidence for those permission.\n```\n\n</details>\n\n## suppressing `aws-cdk-lib/pipelines` violations\n\nthe [aws-cdk-lib/pipelines.codepipeline](https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.pipelines.codepipeline.html) construct and its child constructs are not guaranteed to be \"visited\" by `aspects`, as they are not added during the \"construction\" phase of the [cdk lifecycle](https://docs.aws.amazon.com/cdk/v2/guide/apps.html#lifecycle). because of this behavior, you may experience problems such as rule violations not appearing or the inability to suppress violations on these constructs.\n\nyou can remediate these rule violation and suppression problems by forcing the pipeline construct creation forward by calling `.buildpipeline()` on your `codepipeline` object. otherwise you may see errors such as:\n\n```\nerror: suppression path \"/this/construct/path\" did not match any resource. this can occur when a resource does not exist or if a suppression is applied before a resource is created.\n```\n\nsee [this issue](https://github.com/aws/aws-cdk/issues/18440) for more information.\n\n<details>\n  <summary>example) supressing violations in pipelines</summary>\n\n`example-app.ts`\n\n```python\nimport { app, aspects } from 'aws-cdk-lib';\nimport { awssolutionschecks } from 'cdk-nag';\nimport { examplepipeline } from '../lib/example-pipeline';\n\nconst app = new app();\nnew examplepipeline(app, 'example-cdk-pipeline');\naspects.of(app).add(new awssolutionschecks({ verbose: true }));\napp.synth();\n```\n\n`example-pipeline.ts`\n\n```python\nimport { stack, stackprops } from 'aws-cdk-lib';\nimport { repository } from 'aws-cdk-lib/aws-codecommit';\nimport {\n  codepipeline,\n  codepipelinesource,\n  shellstep,\n} from 'aws-cdk-lib/pipelines';\nimport { nagsuppressions } from 'cdk-nag';\nimport { construct } from 'constructs';\n\nexport class examplepipeline extends stack {\n  constructor(scope: construct, id: string, props?: stackprops) {\n    super(scope, id, props);\n\n    const examplesynth = new shellstep('examplesynth', {\n      commands: ['yarn build --frozen-lockfile'],\n      input: codepipelinesource.codecommit(\n        new repository(this, 'examplerepo', { repositoryname: 'examplerepo' }),\n        'main'\n      ),\n    });\n\n    const examplepipeline = new codepipeline(this, 'examplepipeline', {\n      synth: examplesynth,\n    });\n\n    // force the pipeline construct creation forward before applying suppressions.\n    // @see https://github.com/aws/aws-cdk/issues/18440\n    examplepipeline.buildpipeline();\n\n    // the path suppression will error if you comment out \"examplepipeline.buildpipeline();\"\"\n    nagsuppressions.addresourcesuppressionsbypath(\n      this,\n      '/example-cdk-pipeline/examplepipeline/pipeline/artifactsbucket/resource',\n      [\n        {\n          id: 'awssolutions-s1',\n          reason: 'because i said so',\n        },\n      ]\n    );\n  }\n}\n```\n\n</details>\n\n## rules and property overrides\n\nin some cases l2 constructs do not have a native option to remediate an issue and must be fixed via [raw overrides](https://docs.aws.amazon.com/cdk/latest/guide/cfn_layer.html#cfn_layer_raw). since raw overrides take place after template synthesis these fixes are not caught by cdk-nag. in this case you should remediate the issue and suppress the issue like in the following example.\n\n<details>\n  <summary>example) property overrides</summary>\n\n```python\nimport {\n  instance,\n  instancetype,\n  instanceclass,\n  machineimage,\n  vpc,\n  cfninstance,\n} from 'aws-cdk-lib/aws-ec2';\nimport { stack, stackprops } from 'aws-cdk-lib';\nimport { construct } from 'constructs';\nimport { nagsuppressions } from 'cdk-nag';\n\nexport class cdkteststack extends stack {\n  constructor(scope: construct, id: string, props?: stackprops) {\n    super(scope, id, props);\n    const instance = new instance(this, 'rinstance', {\n      vpc: new vpc(this, 'rvpc'),\n      instancetype: new instancetype(instanceclass.t3),\n      machineimage: machineimage.latestamazonlinux(),\n    });\n    const cfnins = instance.node.defaultchild as cfninstance;\n    cfnins.addpropertyoverride('disableapitermination', true);\n    nagsuppressions.addresourcesuppressions(instance, [\n      {\n        id: 'awssolutions-ec29',\n        reason: 'remediated through property override.',\n      },\n    ]);\n  }\n}\n```\n\n</details>\n\n## conditionally ignoring suppressions\n\nyou can optionally create a condition that prevents certain rules from being suppressed. you can create conditions for any variety of reasons. examples include a condition that always ignores a suppression, a condition that ignores a suppression based on the date, a condition that ignores a suppression based on the reason. you can read [the developer docs](./docs/ignoresuppressionconditions.md) for more information on creating your own conditions.\n\n<details>\n  <summary>example) using the pre-built `suppressionignoreerrors` class to ignore suppressions on any `error` level rules.</summary>\n\n```python\nimport { app, aspects } from 'aws-cdk-lib';\nimport { cdkteststack } from '../lib/cdk-test-stack';\nimport { awssolutionschecks, suppressionignoreerrors } from 'cdk-nag';\n\nconst app = new app();\nnew cdkteststack(app, 'cdknagdemo');\n// ignore suppressions on any errors\naspects.of(app).add(\n  new awssolutionschecks({\n    suppressionignorecondition: new suppressionignoreerrors(),\n  })\n);\n```\n\n</details>\n\n## customizing logging\n\n`naglogger`s give `nagpack` authors and users the ability to create their own custom reporting mechanisms. all pre-built `nagpacks`come with the `annotationslogger`and the `nagreportlogger` (with csv reports) enabled by default.\n\nsee the [naglogger](./docs/naglogger.md) developer docs for more information.\n\n<details>\n  <summary>example) adding the `extremelyhelpfulconsolelogger` example from the naglogger docs</summary>\n\n```python\nimport { app, aspects } from 'aws-cdk-lib';\nimport { cdkteststack } from '../lib/cdk-test-stack';\nimport { extremelyhelpfulconsolelogger } from './docs/naglogger';\nimport { awssolutionschecks } from 'cdk-nag';\n\nconst app = new app();\nnew cdkteststack(app, 'cdknagdemo');\naspects.of(app).add(\n  new awssolutionschecks({\n    additionalloggers: [new extremelyhelpfulconsolelogger()],\n  })\n);\n```\n\n</details>\n\n## using on cloudformation templates\n\nyou can use cdk-nag on existing cloudformation templates by using the [cloudformation-include](https://docs.aws.amazon.com/cdk/latest/guide/use_cfn_template.html#use_cfn_template_install) module.\n\n<details>\n  <summary>example 1) cloudformation template with suppression</summary>\n\nsample cloudformation template with suppression\n\n```json\n{\n  \"resources\": {\n    \"rbucket\": {\n      \"type\": \"aws::s3::bucket\",\n      \"properties\": {\n        \"bucketname\": \"some-bucket-name\"\n      },\n      \"metadata\": {\n        \"cdk_nag\": {\n          \"rules_to_suppress\": [\n            {\n              \"id\": \"awssolutions-s1\",\n              \"reason\": \"at least 10 characters\"\n            }\n          ]\n        }\n      }\n    }\n  }\n}\n```\n\nsample app\n\n```python\nimport { app, aspects } from 'aws-cdk-lib';\nimport { cdkteststack } from '../lib/cdk-test-stack';\nimport { awssolutionschecks } from 'cdk-nag';\n\nconst app = new app();\nnew cdkteststack(app, 'cdknagdemo');\naspects.of(app).add(new awssolutionschecks());\n```\n\nsample stack with imported template\n\n```python\nimport { cfninclude } from 'aws-cdk-lib/cloudformation-include';\nimport { nagsuppressions } from 'cdk-nag';\nimport { stack, stackprops } from 'aws-cdk-lib';\nimport { construct } from 'constructs';\n\nexport class cdkteststack extends stack {\n  constructor(scope: construct, id: string, props?: stackprops) {\n    super(scope, id, props);\n    new cfninclude(this, 'template', {\n      templatefile: 'my-template.json',\n    });\n    // add any additional suppressions\n    nagsuppressions.addresourcesuppressionsbypath(\n      this,\n      '/cdknagdemo/template/rbucket',\n      [\n        {\n          id: 'awssolutions-s2',\n          reason: 'at least 10 characters',\n        },\n      ]\n    );\n  }\n}\n```\n\n</details><details>\n  <summary>example 2) cloudformation template with granular suppressions</summary>\n\nsample cloudformation template with suppression\n\n```json\n{\n  \"resources\": {\n    \"mypolicy\": {\n      \"type\": \"aws::iam::policy\",\n      \"properties\": {\n        \"policydocument\": {\n          \"statement\": [\n            {\n              \"action\": [\n                \"kms:decrypt\",\n                \"kms:describekey\",\n                \"kms:encrypt\",\n                \"kms:reencrypt*\",\n                \"kms:generatedatakey*\"\n              ],\n              \"effect\": \"allow\",\n              \"resource\": [\"some-key-arn\"]\n            }\n          ],\n          \"version\": \"2012-10-17\"\n        }\n      },\n      \"metadata\": {\n        \"cdk_nag\": {\n          \"rules_to_suppress\": [\n            {\n              \"id\": \"awssolutions-iam5\",\n              \"reason\": \"allow key data access\",\n              \"applies_to\": [\n                \"action::kms:reencrypt*\",\n                \"action::kms:generatedatakey*\"\n              ]\n            }\n          ]\n        }\n      }\n    }\n  }\n}\n```\n\nsample app\n\n```python\nimport { app, aspects } from 'aws-cdk-lib';\nimport { cdkteststack } from '../lib/cdk-test-stack';\nimport { awssolutionschecks } from 'cdk-nag';\n\nconst app = new app();\nnew cdkteststack(app, 'cdknagdemo');\naspects.of(app).add(new awssolutionschecks());\n```\n\nsample stack with imported template\n\n```python\nimport { cfninclude } from 'aws-cdk-lib/cloudformation-include';\nimport { nagsuppressions } from 'cdk-nag';\nimport { stack, stackprops } from 'aws-cdk-lib';\nimport { construct } from 'constructs';\n\nexport class cdkteststack extends stack {\n  constructor(scope: construct, id: string, props?: stackprops) {\n    super(scope, id, props);\n    new cfninclude(this, 'template', {\n      templatefile: 'my-template.json',\n    });\n    // add any additional suppressions\n    nagsuppressions.addresourcesuppressionsbypath(\n      this,\n      '/cdknagdemo/template/mypolicy',\n      [\n        {\n          id: 'awssolutions-iam5',\n          reason: 'allow key data access',\n          appliesto: ['action::kms:reencrypt*', 'action::kms:generatedatakey*'],\n        },\n      ]\n    );\n  }\n}\n```\n\n</details>\n\n## contributing\n\nsee [contributing](./contributing.md) for more information.\n\n## license\n\nthis project is licensed under the apache-2.0 license.\n",
  "docs_url": null,
  "keywords": "",
  "license": "apache-2.0",
  "name": "cdk-nag",
  "package_url": "https://pypi.org/project/cdk-nag/",
  "project_url": "https://pypi.org/project/cdk-nag/",
  "project_urls": {
    "Homepage": "https://github.com/cdklabs/cdk-nag.git",
    "Source": "https://github.com/cdklabs/cdk-nag.git"
  },
  "release_url": "https://pypi.org/project/cdk-nag/2.27.222/",
  "requires_dist": [
    "aws-cdk-lib <3.0.0,>=2.78.0",
    "constructs <11.0.0,>=10.0.5",
    "jsii <2.0.0,>=1.93.0",
    "publication >=0.0.3",
    "typeguard ~=2.13.3"
  ],
  "requires_python": "~=3.8",
  "summary": "check cdk v2 applications for best practices using a combination on available rule packs.",
  "version": "2.27.222",
  "releases": [],
  "developers": [
    "donti@amazon.com"
  ],
  "kwds": "cdk_nag cdknag cdknagdemo cdk maven",
  "license_kwds": "apache-2.0",
  "libtype": "pypi",
  "id": "pypi_cdk_nag",
  "homepage": "https://github.com/cdklabs/cdk-nag.git",
  "release_count": 1111,
  "dependency_ids": [
    "pypi_aws_cdk_lib",
    "pypi_constructs",
    "pypi_jsii",
    "pypi_publication",
    "pypi_typeguard"
  ]
}