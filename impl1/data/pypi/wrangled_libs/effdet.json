{
  "classifiers": [
    "development status :: 3 - alpha",
    "intended audience :: education",
    "intended audience :: science/research",
    "license :: osi approved :: apache software license",
    "programming language :: python :: 3.10",
    "programming language :: python :: 3.7",
    "programming language :: python :: 3.8",
    "programming language :: python :: 3.9",
    "topic :: scientific/engineering",
    "topic :: scientific/engineering :: artificial intelligence",
    "topic :: software development",
    "topic :: software development :: libraries",
    "topic :: software development :: libraries :: python modules"
  ],
  "description": "# efficientdet (pytorch)\n\na pytorch implementation of efficientdet.\n\nit is based on the\n* official tensorflow implementation by [mingxing tan and the google brain team](https://github.com/google/automl)\n* paper by mingxing tan, ruoming pang, quoc v. le [efficientdet: scalable and efficient object detection](https://arxiv.org/abs/1911.09070) \n\nthere are other pytorch implementations. either their approach didn't fit my aim to correctly reproduce the tensorflow models (but with a pytorch feel and flexibility) or they cannot come close to replicating ms coco training from scratch.\n\naside from the default model configs, there is a lot of flexibility to facilitate experiments and rapid improvements here -- some options based on the official tensorflow impl, some of my own:\n* bifpn connections and combination mode are fully configurable and not baked into the model code\n* bifpn and head modules can be switched between depthwise separable or standard convolutions\n* activations, batch norm layers are switchable via arguments (soon config)\n* any backbone in my `timm` model collection that supports feature extraction (`features_only` arg) can be used as a bacbkone.\n\n## updates\n\n### 2023-05-21\n* depend on `timm` 0.9\n* minor bug fixes\n* version 0.4.1 release\n\n### 2023-02-09\n* testing with pytorch 2.0 (nightlies), add --torchcompile support to train and validate scripts\n* a small code cleanup pass, support bwd/fwd compat across timm 0.8.x and previous releases\n* use `timm` convert_sync_batchnorm function as it handles updated models w/ batchnormact2d layers\n\n### 2022-01-06\n* new `efficientnetv2_ds` weights 50.1 map @ 1024x0124, using agc clipping and `timm`'s `efficientnetv2_rw_s` backbone. memory use comparable to d3, speed faster than d4. smaller than optimal training batch size so can probably do better... \n\n### 2021-11-30\n* update `efficientnetv2_dt` weights to a new set, 46.1 map @ 768x768, 47.0 map @ 896x896 using agc clipping.\n* add agc (adaptive gradient clipping support via `timm`). idea from (`high-performance large-scale image recognition without normalization` - https://arxiv.org/abs/2102.06171)\n* `timm` minimum version bumped up to 0.4.12\n\n### 2021-11-16\n* add efficientnetv2 backbone experiment `efficientnetv2_dt` based on `timm`'s `efficientnetv2_rw_t` (tiny) model. 45.8 map @ 768x768.\n* updated tf efficientdet-lite model defs incl weights ported from official impl (https://github.com/google/automl)\n* for lite models, updated feature resizing code in fpn to be based on feat size instead of reduction ratios, needed to support image size that aren't divisible by 128.\n* minor tweaks, bug fixes\n\n### 2021-07-28\n* add training example to readme provided by chris hughes for training w/ custom dataset & lightning training code\n  * [medium blog post](https://medium.com/data-science-at-microsoft/training-efficientdet-on-custom-data-with-pytorch-lightning-using-an-efficientnetv2-backbone-1cdf3bd7921f)\n  * [python notebook](https://gist.github.com/chris-hughes10/73628b1d8d6fc7d359b3dcbbbb8869d7)\n\n### 2021-04-30\n* add efficientdet advprop-aa weights for d0-d5 from tf impl. model names `tf_efficientdet_d?_ap`\n  * see https://github.com/google/automl/blob/master/efficientdet/det-advprop.md\n\n### 2021-02-18\n* add some new model weights with bilinear interpolation for upsample and downsample in fpn.\n  * 40.9 map - `efficientdet_q1`  (replace prev model at 40.6)\n  * 43.2 map -`cspresdet50`\n  * 45.2 map - `cspdarkdet53m`\n\n### 2020-12-07\n* training w/ fully jit scripted model + bench (`--torchscript`) is possible with inclusion of modelemav2 from `timm` and previous torchscript compat additions. big speed gains for cpu bound training.\n* add weights for alternate fpn layouts. quadfpn experiments (`efficientdet_q0/q1/q2`) and cspresdext + pan (`cspresdext50pan`). see updated table below. special thanks to [artus](https://twitter.com/artuskg) for providing resources for training the q2 model.\n* heads can have a different activation from fpn via config\n* fpn resample (interpolation) can be specified via config and include any f.interpolation method or `max`/`avg` pool\n* default focal loss changed back to `new_focal`, use `--legacy-focal` arg to use the original. legacy uses less memory, but has more numerical stability issues.\n* custom augmentation transform and collate fn can be passed to loader factory\n* `timm` >= 0.3.2 required, note double check any custom defined model config for breaking change \n* pytorch >= 1.6 now required\n\n### 2020-11-12\n* add experimental pan and quad fpn configs to the existing efficientdet bifpn w/ two test model configs\n* switch untrained experimental model configs to use torchscript compat bn head layout by default\n\n### 2020-11-09\n* set model config to read-only after creation to reduce likelyhood of misuse\n* no accessing model or bench .config attr in forward() call chain (for torcscript compat)\n* numerous smaller changes that allow jit scripting of the model or train/predict bench\n\n### 2020-10-30\nmerged a few months of accumulated fixes and additions.\n* proper fine-tuning compatible model init (w/ changeable # classes and proper init, demoed in train.py)\n* a new dataset interface with dataset support (via parser classes) for coco, voc 2007/2012, and openimages v5/challenge2019\n* new focal loss def w/ label smoothing available as an option, support for jit of loss fn for (potential) speedup\n* improved a few hot spots that squeek out a couple % of throughput gains, higher gpu utilization\n* pascal / openimages evaluators based on tensorflow models evaluator framework (usable for other datasets as well)\n* support for native pytorch ddp, syncbn, and amp in pytorch >= 1.6. still defaults to apex if installed.\n* non-square input image sizes are allowed for the model (the anchor layout). specified by image_size tuple in model config. currently still restricted to `size % 128 = 0` on each dim.\n* allow anchor target generation to be done in either dataloader process' via collate or in model as in past. can help balance compute.\n* filter out unused target cls/box from dataset annotations in fixed size batch tensors before passing to target assigner. seems to speed convergence.\n* letterbox aware random erasing augmentation added.\n* a (very slow) softnms impl added for inference/validation use. it can be manually enabled right now, can add arg if demand.\n* tested with pytorch 1.7\n* add resdet50 model weights, 41.6 map.\n\na few things on priority list i haven't tackled yet:\n* mosaic augmentation\n* bbox iou loss (tried a bit but so far not a great result, need time to debug/improve)\n\n**note** there are some breaking changes:\n* predict and train benches now output xyxy boxes, not xywh as before. this was done to support other datasets as xywh is coco's evaluator requirement.\n* the tf models evaluator operates on yxyx boxes like the models. conversion from xyxy is currently done by default. why don't i just keep everything yxyx? because pytorch gpu nms operates in xyxy.\n* you must update your version of `timm` to the latest (>=0.3), as some apis for helpers changed a bit.\n\ntraining sanity checks were done on voc and oi\n  * 80.0 @ 50 map finetune on voc0712 with no attempt to tune params (roughly as per command below)\n  * 18.0 map @ 50 for oi challenge2019 after couple days of training (only 6 epochs, eek!). it's much bigger, and takes a loong time, many classes are quite challenging.\n\n\n## models\n\nthe table below contains models with pretrained weights. there are quite a number of other models that i have defined in [model configurations](effdet/config/model_config.py) that use various `timm` backbones.\n\n| variant                | map (val2017) | map (test-dev2017) | map (tf official val2017) | map (tf official test-dev2017) | params (m) | img size |\n|------------------------|:-------------:| :---: | :---: | :---: |:----------:|:--------:|\n| tf_efficientdet_lite0  |     27.1      | tbd | 26.4 | n/a |    3.24    |   320    |\n| tf_efficientdet_lite1  |     32.2      | tbd | 31.5 | n/a |    4.25    |   384    |\n| efficientdet_d0        |     33.6      | tbd | n/a | n/a |    3.88    |   512    |\n| tf_efficientdet_d0     |     34.2      | tbd | 34.3 | 34.6 |    3.88    |   512    |\n| tf_efficientdet_d0_ap  |     34.8      | tbd | 35.2 | 35.3 |    3.88    |   512    |\n| efficientdet_q0        |     35.7      | tbd | n/a | n/a |    4.13    |   512    |\n| tf_efficientdet_lite2  |     35.9      | tbd | 35.1 | n/a |    5.25    |   448    |\n| efficientdet_d1        |     39.4      | 39.5 | n/a | n/a |    6.62    |   640    |\n| tf_efficientdet_lite3  |     39.6      | tbd | 38.8 | n/a |    8.35    |   512    |\n| tf_efficientdet_d1     |     40.1      | tbd | 40.2 | 40.5 |    6.63    |   640    |\n| tf_efficientdet_d1_ap  |     40.8      | tbd | 40.9 | 40.8 |    6.63    |   640    |\n| efficientdet_q1        |     40.9      | tbd | n/a | n/a |    6.98    |   640    |\n| cspresdext50pan        |     41.2      | tbd | n/a | n/a |    22.2    |   640    |\n| resdet50               |     41.6      | tbd | n/a | n/a |    27.6    |   640    |\n| efficientdet_q2        |     43.1      | tbd | n/a | n/a |    8.81    |   768    |\n| cspresdet50            |     43.2      | tbd | n/a | n/a |    24.3    |   768    |\n| tf_efficientdet_d2     |     43.4      | tbd | 42.5 | 43 |    8.10    |   768    |\n| tf_efficientdet_lite3x |     43.6      | tbd | 42.6 | n/a |    9.28    |   640    |\n| tf_efficientdet_lite4  |     44.2      | tbd | 43.2 | n/a |    15.1    |   640    |\n| tf_efficientdet_d2_ap  |     44.2      | tbd | 44.3 | 44.3 |    8.10    |   768    |\n| cspdarkdet53m          |     45.2      | tbd | n/a | n/a |    35.6    |   768    |\n| efficientdetv2_dt      |     46.1      | tbd | n/a | n/a |    13.4    |   768    |\n| tf_efficientdet_d3     |     47.1      | tbd | 47.2 | 47.5 |    12.0    |   896    |\n| tf_efficientdet_d3_ap  |     47.7      | tbd | 48.0 | 47.7 |    12.0    |   896    |\n| tf_efficientdet_d4     |     49.2      | tbd | 49.3 | 49.7 |    20.7    |   1024   |\n| efficientdetv2_ds      |     50.1      | tbd | n/a | n/a |    26.6    |   1024   |\n| tf_efficientdet_d4_ap  |     50.2      | tbd | 50.4 | 50.4 |    20.7    |   1024   |\n| tf_efficientdet_d5     |     51.2      | tbd | 51.2 | 51.5 |    33.7    |   1280   |\n| tf_efficientdet_d6     |     52.0      | tbd | 52.1 | 52.6 |    51.9    |   1280   |\n| tf_efficientdet_d5_ap  |     52.1      | tbd | 52.2 | 52.5 |    33.7    |   1280   |\n| tf_efficientdet_d7     |     53.1      | 53.4 | 53.4 | 53.7 |    51.9    |   1536   |\n| tf_efficientdet_d7x    |     54.3      | tbd | 54.4 | 55.1 |    77.1    |   1536   |\n\n\nsee [model configurations](effdet/config/model_config.py) for model checkpoint urls and differences.\n\n_note: official scores for all modules now using soft-nms, but still using normal nms here._\n\n_note: in training some experimental models, i've noticed some potential issues with the combination of synchronized batchnorm (`--sync-bn`) and model ema weight everaging (`--model-ema`) during distributed training. the result is either a model that fails to converge, or appears to converge (training loss) but the eval loss (running bn stats) is garbage. i haven't observed this with efficientnets, but have with some backbones like cspresnext, vovnet, etc. disabling either ema or sync bn seems to eliminate the problem and result in good models. i have not fully characterized this issue._\n\n## environment setup\n\ntested in a python 3.7 - 3.9 conda environment in linux with:\n* pytorch 1.6 - 1.10\n* pytorch image models (timm) >= 0.4.12, `pip install timm` or local install from (https://github.com/rwightman/pytorch-image-models)\n* apex amp master (as of 2020-08). i recommend using native pytorch amp and ddp now.\n\n*note* - there is a conflict/bug with numpy 1.18+ and pycocotools 2.0, force install numpy <= 1.17.5 or ensure you install pycocotools >= 2.0.2\n\n## dataset setup and use\n\n### coco\nmscoco 2017 validation data:\n```\nwget http://images.cocodataset.org/zips/val2017.zip\nwget http://images.cocodataset.org/annotations/annotations_trainval2017.zip\nunzip val2017.zip\nunzip annotations_trainval2017.zip\n```\n\nmscoco 2017 test-dev data:\n```\nwget http://images.cocodataset.org/zips/test2017.zip\nunzip -q test2017.zip\nwget http://images.cocodataset.org/annotations/image_info_test2017.zip\nunzip image_info_test2017.zip\n```\n\n#### coco evaluation\n\nrun validation (val2017 by default) with d2 model: `python validate.py /localtion/of/mscoco/ --model tf_efficientdet_d2`\n\n\nrun test-dev2017: `python validate.py /localtion/of/mscoco/ --model tf_efficientdet_d2 --split testdev`\n\n#### coco training\n\n`./distributed_train.sh 4 /mscoco --model tf_efficientdet_d0 -b 16 --amp  --lr .09 --warmup-epochs 5  --sync-bn --opt fusedmomentum --model-ema`\n\nnote:\n* training script currently defaults to a model that does not have redundant conv + bn bias layers like the official models, set correct flag when validating.\n* i've only trained with img mean (`--fill-color mean`) as the background for crop/scale/aspect fill, the official repo uses black pixel (0) (`--fill-color 0`). both likely work fine.\n* the official training code uses ema weight averaging by default, it's not clear there is a point in doing this with the cosine lr schedule, i find the non-ema weights end up better than ema in the last 10-20% of training epochs \n* the default h-params is a very close to unstable (exploding loss), don't try using nesterov momentum. try to keep the batch size up, use sync-bn.\n\n\n### pascal voc\n\n2007, 2012, and combined 2007 + 2012 w/ labeled 2007 test for validation are supported.\n\n```\nwget http://host.robots.ox.ac.uk/pascal/voc/voc2012/voctrainval_11-may-2012.tar\nwget http://host.robots.ox.ac.uk/pascal/voc/voc2007/voctrainval_06-nov-2007.tar\nwget http://host.robots.ox.ac.uk/pascal/voc/voc2007/voctest_06-nov-2007.tar\nfind . -name '*.tar' -exec tar xf {} \\;\n```\n\nthere should be a `voc2007` and `voc2012` folder within `vocdevkit`, dataset root for cmd line will be vocdevkit.\n\nalternative download links, slower but up more often than ox.ac.uk:\n```\nhttp://pjreddie.com/media/files/voctrainval_11-may-2012.tar\nhttp://pjreddie.com/media/files/voctrainval_06-nov-2007.tar\nhttp://pjreddie.com/media/files/voctest_06-nov-2007.tar\n```\n\n#### voc evaluation\n\nevaluate on voc2012 validation set:\n`python validate.py /data/vocdevkit --model efficientdet_d0 --num-gpu 2 --dataset voc2007 --checkpoint mychekpoint.pth --num-classes 20`\n\n#### voc training\n\nfine tune coco pretrained weights to voc 2007 + 2012:\n`/distributed_train.sh 4 /data/vocdevkit --model efficientdet_d0 --dataset voc0712 -b 16 --amp --lr .008 --sync-bn --opt fusedmomentum --warmup-epochs 3 --model-ema --model-ema-decay 0.9966 --epochs 150 --num-classes 20 --pretrained`\n\n### openimages\n\nsetting up openimages dataset is a commitment. i've tried to make it a bit easier wrt to the annotations, but grabbing the dataset is still going to take some time. it will take approx 560gb of storage space.\n\nto download the image data, i prefer the cvdf packaging. the main openimages dataset page, annotations, dataset license info can be found at: https://storage.googleapis.com/openimages/web/index.html\n\n#### cvdf images download\n\nfollow the s3 download directions here: https://github.com/cvdfoundation/open-images-dataset#download-images-with-bounding-boxes-annotations\n\neach `train_<x>.tar.gz` should be extracted to `train/<x>` folder, where x is a hex digit from 0-f. `validation.tar.gz` can be extracted as flat files into `validation/`.\n\n#### annotations download\n\nannotations can be downloaded separately from the openimages home page above. for convenience, i've packaged them all together with some additional 'info' csv files that contain ids and stats for all image files. my datasets rely on the `<set>-info.csv` files. please see https://storage.googleapis.com/openimages/web/factsfigures.html for the license of these annotations. the annotations are licensed by google llc under cc by 4.0 license. the images are listed as having a cc by 2.0 license.\n```\nwget https://github.com/rwightman/efficientdet-pytorch/releases/download/v0.1-anno/openimages-annotations.tar.bz2\nwget https://github.com/rwightman/efficientdet-pytorch/releases/download/v0.1-anno/openimages-annotations-challenge-2019.tar.bz2\nfind . -name '*.tar.bz2' -exec tar xf {} \\;\n```\n\n#### layout\n\nonce everything is downloaded and extracted the root of your openimages data folder should contain:\n```\nannotations/<csv anno for openimages v5/v6>\nannotations/challenge-2019/<csv anno for challenge2019>\ntrain/0/<all the image files starting with '0'>\n.\n.\n.\ntrain/f/<all the image files starting with 'f'>\nvalidation/<all the image files in same folder>\n```\n\n#### openimages training\ntraining with challenge2019 annotations (500 classes):\n`./distributed_train.sh 4 /data/openimages --model efficientdet_d0 --dataset openimages-challenge2019 -b 7 --amp --lr .042 --sync-bn --opt fusedmomentum --warmup-epochs 1 --lr-noise 0.4 0.9 --model-ema --model-ema-decay 0.999966 --epochs 100 --remode pixel --reprob 0.15 --recount 4 --num-classes 500 --val-skip 2`\n\nthe 500 (challenge2019) or 601 (v5/v6) class head for oi takes up a lot more gpu memory vs coco. you'll likely need to half batch sizes.\n\n### examples of training / fine-tuning on custom datasets\n\nthe models here have been used with custom training routines and datasets with great results. there are lots of details to figure out so please don't file any 'i get crap results on my custom dataset issues'. if you can illustrate a reproducible problem on a public, non-proprietary, downloadable dataset, with public github fork of this repo including working dataset/parser implementations, i may have time to take a look.\n\nexamples:\n* chris hughes has put together a great example of training w/ `timm` efficientnetv2 backbones and the latest versions of the efficientdet models here\n  * [medium blog post](https://medium.com/data-science-at-microsoft/training-efficientdet-on-custom-data-with-pytorch-lightning-using-an-efficientnetv2-backbone-1cdf3bd7921f)\n  * [python notebook](https://gist.github.com/chris-hughes10/73628b1d8d6fc7d359b3dcbbbb8869d7)\n* alex shonenkov has a clear and concise kaggle kernel which illustrates fine-tuning these models for detecting wheat heads: https://www.kaggle.com/shonenkov/training-efficientdet (note: this is out of date wrt to latest versions here, many details have changed)\n\nif you have a good example script or kernel training these models with a different dataset, feel free to notify me for inclusion here...\n\n## results\n\n### my training\n\n#### efficientdet-d0\n\nlatest training run with .336 for d0 (on 4x 1080ti):\n`./distributed_train.sh 4 /mscoco --model efficientdet_d0 -b 22 --amp --lr .12 --sync-bn --opt fusedmomentum --warmup-epochs 5 --lr-noise 0.4 0.9 --model-ema --model-ema-decay 0.9999`\n\nthese hparams above resulted in a good model, a few points:\n* the map peaked very early (epoch 200 of 300) and then appeared to overfit, so likely still room for improvement\n* i enabled my experimental lr noise which tends to work well with ema enabled\n* the effective lr is a bit higher than official. official is .08 for batch 64, this works out to .0872\n* drop_path (aka survival_prob / drop_connect) rate of 0.1, which is higher than the suggested 0.0 for d0 in official, but lower than the 0.2 for the other models\n* longer ema period than default\n\nval2017\n```\n average precision  (ap) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.336251\n average precision  (ap) @[ iou=0.50      | area=   all | maxdets=100 ] = 0.521584\n average precision  (ap) @[ iou=0.75      | area=   all | maxdets=100 ] = 0.356439\n average precision  (ap) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.123988\n average precision  (ap) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.395033\n average precision  (ap) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.521695\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=  1 ] = 0.287121\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets= 10 ] = 0.441450\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.467914\n average recall     (ar) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.197697\n average recall     (ar) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.552515\n average recall     (ar) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.689297\n```\n\n#### efficientdet-d1 \n\nlatest run with .394 map (on 4x 1080ti):\n`./distributed_train.sh 4 /mscoco --model efficientdet_d1 -b 10 --amp --lr .06 --sync-bn --opt fusedmomentum --warmup-epochs 5 --lr-noise 0.4 0.9 --model-ema --model-ema-decay 0.99995`\n\nfor this run i used some improved augmentations, still experimenting so not ready for release, should work well without them but will likely start overfitting a bit sooner and possibly end up a in the .385-.39 range.\n\n\n### ported tensorflow weights\n\n#### test-dev2017\n\nnote: i've only tried submitting d7 to dev server for sanity check so far\n\n##### tf-efficientdet-d7\n```\n average precision  (ap) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.534\n average precision  (ap) @[ iou=0.50      | area=   all | maxdets=100 ] = 0.726\n average precision  (ap) @[ iou=0.75      | area=   all | maxdets=100 ] = 0.577\n average precision  (ap) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.356\n average precision  (ap) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.569\n average precision  (ap) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.660\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=  1 ] = 0.397\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets= 10 ] = 0.644\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.682\n average recall     (ar) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.508\n average recall     (ar) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.718\n average recall     (ar) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.818\n ```\n\n#### val2017\n\n##### tf-efficientdet-d0\n```\n average precision  (ap) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.341877\n average precision  (ap) @[ iou=0.50      | area=   all | maxdets=100 ] = 0.525112\n average precision  (ap) @[ iou=0.75      | area=   all | maxdets=100 ] = 0.360218\n average precision  (ap) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.131366\n average precision  (ap) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.399686\n average precision  (ap) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.537368\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=  1 ] = 0.293137\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets= 10 ] = 0.447829\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.472954\n average recall     (ar) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.195282\n average recall     (ar) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.558127\n average recall     (ar) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.695312\n```\n\n##### tf-efficientdet-d1\n```\n average precision  (ap) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.401070\n average precision  (ap) @[ iou=0.50      | area=   all | maxdets=100 ] = 0.590625\n average precision  (ap) @[ iou=0.75      | area=   all | maxdets=100 ] = 0.422998\n average precision  (ap) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.211116\n average precision  (ap) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.459650\n average precision  (ap) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.577114\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=  1 ] = 0.326565\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets= 10 ] = 0.507095\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.537278\n average recall     (ar) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.308963\n average recall     (ar) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.610450\n average recall     (ar) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.731814\n```\n\n##### tf-efficientdet-d2\n```\n average precision  (ap) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.434042\n average precision  (ap) @[ iou=0.50      | area=   all | maxdets=100 ] = 0.627834\n average precision  (ap) @[ iou=0.75      | area=   all | maxdets=100 ] = 0.463488\n average precision  (ap) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.237414\n average precision  (ap) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.486118\n average precision  (ap) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.606151\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=  1 ] = 0.343016\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets= 10 ] = 0.538328\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.571489\n average recall     (ar) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.350301\n average recall     (ar) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.638884\n average recall     (ar) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.746671\n```\n\n##### tf efficientdet-d3\n\n```\n average precision  (ap) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.471223\n average precision  (ap) @[ iou=0.50      | area=   all | maxdets=100 ] = 0.661550\n average precision  (ap) @[ iou=0.75      | area=   all | maxdets=100 ] = 0.505127\n average precision  (ap) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.301385\n average precision  (ap) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.518339\n average precision  (ap) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.626571\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=  1 ] = 0.365186\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets= 10 ] = 0.582691\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.617252\n average recall     (ar) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.424689\n average recall     (ar) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.670761\n average recall     (ar) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.779611\n```\n\n##### tf-efficientdet-d4\n ```\n average precision  (ap) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.491759\n average precision  (ap) @[ iou=0.50      | area=   all | maxdets=100 ] = 0.686005\n average precision  (ap) @[ iou=0.75      | area=   all | maxdets=100 ] = 0.527791\n average precision  (ap) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.325658\n average precision  (ap) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.536508\n average precision  (ap) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.635309\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=  1 ] = 0.373752\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets= 10 ] = 0.601733\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.638343\n average recall     (ar) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.463057\n average recall     (ar) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.685103\n average recall     (ar) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.789180\n```\n\n##### tf-efficientdet-d5\n```\n average precision  (ap) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.511767\n average precision  (ap) @[ iou=0.50      | area=   all | maxdets=100 ] = 0.704835\n average precision  (ap) @[ iou=0.75      | area=   all | maxdets=100 ] = 0.552920\n average precision  (ap) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.355680\n average precision  (ap) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.551341\n average precision  (ap) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.650184\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=  1 ] = 0.384516\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets= 10 ] = 0.619196\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.657445\n average recall     (ar) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.499319\n average recall     (ar) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.695617\n average recall     (ar) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.788889\n```\n\n##### tf-efficientdet-d6\n```\n average precision  (ap) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.520200\n average precision  (ap) @[ iou=0.50      | area=   all | maxdets=100 ] = 0.713204\n average precision  (ap) @[ iou=0.75      | area=   all | maxdets=100 ] = 0.560973\n average precision  (ap) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.361596\n average precision  (ap) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.567414\n average precision  (ap) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.657173\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=  1 ] = 0.387733\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets= 10 ] = 0.629269\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.667495\n average recall     (ar) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.499002\n average recall     (ar) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.711909\n average recall     (ar) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.802336\n```\n\n##### tf-efficientdet-d7\n ```\n average precision  (ap) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.531256\n average precision  (ap) @[ iou=0.50      | area=   all | maxdets=100 ] = 0.724700\n average precision  (ap) @[ iou=0.75      | area=   all | maxdets=100 ] = 0.571787\n average precision  (ap) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.368872\n average precision  (ap) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.573938\n average precision  (ap) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.668253\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=  1 ] = 0.393620\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets= 10 ] = 0.637601\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.676987\n average recall     (ar) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.524850\n average recall     (ar) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.717553\n average recall     (ar) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.806352\n ```\n\n##### tf-efficientdet-d7x\n\n```\n average precision  (ap) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.543\n average precision  (ap) @[ iou=0.50      | area=   all | maxdets=100 ] = 0.737\n average precision  (ap) @[ iou=0.75      | area=   all | maxdets=100 ] = 0.585\n average precision  (ap) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.401\n average precision  (ap) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.579\n average precision  (ap) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.680\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=  1 ] = 0.398\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets= 10 ] = 0.649\n average recall     (ar) @[ iou=0.50:0.95 | area=   all | maxdets=100 ] = 0.689\n average recall     (ar) @[ iou=0.50:0.95 | area= small | maxdets=100 ] = 0.550\n average recall     (ar) @[ iou=0.50:0.95 | area=medium | maxdets=100 ] = 0.725\n average recall     (ar) @[ iou=0.50:0.95 | area= large | maxdets=100 ] = 0.823\n```\n\n## todo\n- [x] basic training (object detection) reimplementation\n- [ ] mosaic augmentation\n- [ ] rand/autoaugment\n- [ ] bbox iou loss (giou, diou, ciou, etc)\n- [ ] training (semantic segmentation) experiments\n- [ ] integration with detectron2 / mmdetection codebases\n- [ ] addition and cleanup of efficientnet based u-net and deeplab segmentation models that i've used in past projects\n- [x] addition and cleanup of openimages dataset/training support from a past project\n- [ ] exploration of instance segmentation possibilities...\n\nif you are an organization is interested in sponsoring and any of this work, or prioritization of the possible future directions interests you, feel free to contact me (issue, linkedin, twitter, hello at rwightman dot com). i will setup a github sponser if there is any interest.\n",
  "docs_url": null,
  "keywords": "pytorch pretrained efficientdet efficientnet bifpn object detection",
  "license": "",
  "name": "effdet",
  "package_url": "https://pypi.org/project/effdet/",
  "project_url": "https://pypi.org/project/effdet/",
  "project_urls": {
    "Homepage": "https://github.com/rwightman/efficientdet-pytorch"
  },
  "release_url": "https://pypi.org/project/effdet/0.4.1/",
  "requires_dist": [
    "torch (>=1.12.1)",
    "torchvision",
    "timm (>=0.9.2)",
    "pycocotools (>=2.0.2)",
    "omegaconf (>=2.0)"
  ],
  "requires_python": ">=3.7",
  "summary": "efficientdet for pytorch",
  "version": "0.4.1",
  "releases": [],
  "developers": [
    "hello@rwightman.com",
    "ross_wightman"
  ],
  "kwds": "tensorflow pytorch efficientnetv2 efficientnet bifpn",
  "license_kwds": "",
  "libtype": "pypi",
  "id": "pypi_effdet",
  "homepage": "https://github.com/rwightman/efficientdet-pytorch",
  "release_count": 7,
  "dependency_ids": [
    "pypi_omegaconf",
    "pypi_pycocotools",
    "pypi_timm",
    "pypi_torch",
    "pypi_torchvision"
  ]
}