{
  "classifiers": [
    "license :: osi approved :: mit license",
    "programming language :: python",
    "programming language :: python :: 3",
    "programming language :: python :: 3.5",
    "programming language :: python :: 3.6",
    "programming language :: python :: 3.7",
    "programming language :: python :: 3.8",
    "topic :: security :: cryptography"
  ],
  "description": "python pkcs#11 - high level wrapper api\n=======================================\n\na high level, \"more pythonic\" interface to the pkcs#11 (cryptoki) standard\nto support hsm and smartcard devices in python.\n\nthe interface is designed to follow the logical structure of a hsm, with\nuseful defaults for obscurely documented parameters. many apis will optionally\naccept iterables and act as generators, allowing you to stream large data\nblocks for symmetric encryption.\n\npython-pkcs11 also includes numerous utility functions to convert between pkcs\n#11 data structures and common interchange formats including pkcs #1 and x.509.\n\npython-pkcs11 is fully documented and has a full integration test suite for all\nfeatures, with continuous integration against multiple hsm platforms including:\n\n* thales ncipher\n* opencryptoki tpm\n* opensc/smartcard-hsm/nitrokey hsm\n\nsource: https://github.com/danni/python-pkcs11\n\ndocumentation: http://python-pkcs11.readthedocs.io/en/latest/\n\ngetting started\n---------------\n\ninstall from pip:\n\n::\n\n    pip install python-pkcs11\n\n\nor build from source:\n\n::\n\n    python setup.py build\n\nassuming your pkcs#11 library is set as `pkcs11_module` and contains a\ntoken named `demo`:\n\naes\n~~~\n\n::\n\n    import pkcs11\n\n    # initialise our pkcs#11 library\n    lib = pkcs11.lib(os.environ['pkcs11_module'])\n    token = lib.get_token(token_label='demo')\n\n    data = b'input data'\n\n    # open a session on our token\n    with token.open(user_pin='1234') as session:\n        # generate an aes key in this session\n        key = session.generate_key(pkcs11.keytype.aes, 256)\n\n        # get an initialisation vector\n        iv = session.generate_random(128)  # aes blocks are fixed at 128 bits\n        # encrypt our data\n        crypttext = key.encrypt(data, mechanism_param=iv)\n\n3des\n~~~~\n\n::\n\n    import pkcs11\n\n    # initialise our pkcs#11 library\n    lib = pkcs11.lib(os.environ['pkcs11_module'])\n    token = lib.get_token(token_label='demo')\n\n    data = b'input data'\n\n    # open a session on our token\n    with token.open(user_pin='1234') as session:\n        # generate a des key in this session\n        key = session.generate_key(pkcs11.keytype.des3)\n\n        # get an initialisation vector\n        iv = session.generate_random(64)  # des blocks are fixed at 64 bits\n        # encrypt our data\n        crypttext = key.encrypt(data, mechanism_param=iv)\n\nrsa\n~~~\n\n::\n\n    import pkcs11\n\n    lib = pkcs11.lib(os.environ['pkcs11_module'])\n    token = lib.get_token(token_label='demo')\n\n    data = b'input data'\n\n    # open a session on our token\n    with token.open(user_pin='1234') as session:\n        # generate an rsa keypair in this session\n        pub, priv = session.generate_keypair(pkcs11.keytype.rsa, 2048)\n\n        # encrypt as one block\n        crypttext = pub.encrypt(data)\n\ndsa\n~~~\n\n::\n\n    import pkcs11\n\n    lib = pkcs11.lib(os.environ['pkcs11_module'])\n    token = lib.get_token(token_label='demo')\n\n    data = b'input data'\n\n    # open a session on our token\n    with token.open(user_pin='1234') as session:\n        # generate an dsa keypair in this session\n        pub, priv = session.generate_keypair(pkcs11.keytype.dsa, 1024)\n\n        # sign\n        signature = priv.sign(data)\n\necdsa\n~~~~~\n\n::\n\n    import pkcs11\n\n    lib = pkcs11.lib(os.environ['pkcs11_module'])\n    token = lib.get_token(token_label='demo')\n\n    data = b'input data'\n\n    # open a session on our token\n    with token.open(user_pin='1234') as session:\n        # generate an ec keypair in this session from a named curve\n        ecparams = session.create_domain_parameters(\n            pkcs11.keytype.ec, {\n                pkcs11.attribute.ec_params: pkcs11.util.ec.encode_named_curve_parameters('prime256v1'),\n            }, local=true)\n        pub, priv = ecparams.generate_keypair()\n\n        # sign\n        signature = priv.sign(data)\n\ndiffie-hellman\n~~~~~~~~~~~~~~\n\n::\n\n    import pkcs11\n\n    lib = pkcs11.lib(os.environ['pkcs11_module'])\n    token = lib.get_token(token_label='demo')\n\n    with token.open() as session:\n        # given shared diffie-hellman parameters\n        parameters = session.create_domain_parameters(pkcs11.keytype.dh, {\n            pkcs11.attribute.prime: prime,  # diffie-hellman parameters\n            pkcs11.attribute.base: base,\n        })\n\n        # generate a dh key pair from the public parameters\n        public, private = parameters.generate_keypair()\n\n        # share the public half of it with our other party.\n        _network_.write(public[attribute.value])\n        # and get their shared value\n        other_value = _network_.read()\n\n        # derive a shared session key with perfect forward secrecy\n        session_key = private.derive_key(\n            pkcs11.keytype.aes, 128,\n            mechanism_param=other_value)\n\n\nelliptic-curve diffie-hellman\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n::\n\n    import pkcs11\n\n    lib = pkcs11.lib(os.environ['pkcs11_module'])\n    token = lib.get_token(token_label='demo')\n\n    with token.open() as session:\n        # given der encocded ec parameters, e.g. from\n        #    openssl ecparam -outform der -name <named curve>\n        parameters = session.create_domain_parameters(pkcs11.keytype.ec, {\n            pkcs11.attribute.ec_params: ecparams,\n        })\n\n        # generate a dh key pair from the public parameters\n        public, private = parameters.generate_keypair()\n\n        # share the public half of it with our other party.\n        _network_.write(public[pkcs11.attribute.ec_point])\n        # and get their shared value\n        other_value = _network_.read()\n\n        # derive a shared session key\n        session_key = private.derive_key(\n            pkcs11.keytype.aes, 128,\n            mechanism_param=(pkcs11.kdf.null, none, other_value))\n\ntested compatibility\n--------------------\n\n+------------------------------+--------------+-----------------+--------------+-------------------+\n| functionality                | softhsmv2    | thales ncipher  | opencryptoki | opensc (nitrokey) |\n+==============================+==============+=================+==============+===================+\n| get slots/tokens             | works        | works           | works        | works             |\n+------------------------------+--------------+-----------------+--------------+-------------------+\n| get mechanisms               | works        | works           | works        | works             |\n+------------------------------+--------------+-----------------+--------------+-------------------+\n| initialize token             | not implemented                                                   |\n+------------------------------+-------------------------------------------------------------------+\n| slot events                  | not implemented                                                   |\n+------------------------------+-------------------------------------------------------------------+\n| alternative authentication   | not implemented                                                   |\n| path                         |                                                                   |\n+------------------------------+-------------------------------------------------------------------+\n| `always authenticate` keys   | not implemented                                                   |\n+-------------+----------------+--------------+-----------------+--------------+-------------------+\n| create/copy | keys           | works        | works           | errors       | create            |\n|             +----------------+--------------+-----------------+--------------+-------------------+\n|             | certificates   | caveats [1]_ | caveats [1]_    | caveats [1]_ | ?                 |\n|             +----------------+--------------+-----------------+--------------+-------------------+\n|             | domain params  | caveats [1]_ | caveats [1]_    | ?            | n/a               |\n+-------------+----------------+--------------+-----------------+--------------+-------------------+\n| destroy object               | works        | n/a             | works        | works             |\n+------------------------------+--------------+-----------------+--------------+-------------------+\n| generate random              | works        | works           | works        | works             |\n+------------------------------+--------------+-----------------+--------------+-------------------+\n| seed random                  | works        | n/a             | n/a          | n/a               |\n+------------------------------+--------------+-----------------+--------------+-------------------+\n| digest (data & keys)         | works        | caveats [2]_    | works        | works             |\n+--------+---------------------+--------------+-----------------+--------------+-------------------+\n| aes    | generate key        | works        | works           | works        | n/a               |\n|        +---------------------+--------------+-----------------+--------------+                   |\n|        | encrypt/decrypt     | works        | works           | works        |                   |\n|        +---------------------+--------------+-----------------+--------------+                   |\n|        | wrap/unwrap         | ? [3]_       | works           | errors       |                   |\n|        +---------------------+--------------+-----------------+--------------+                   |\n|        | sign/verify         | works        | works [4]_      | n/a          |                   |\n+--------+---------------------+--------------+-----------------+--------------+-------------------+\n| des2/  | generate key        | works        | works           | works        | n/a               |\n| des3   +---------------------+--------------+-----------------+--------------+                   |\n|        | encrypt/decrypt     | works        | works           | works        |                   |\n|        +---------------------+--------------+-----------------+--------------+                   |\n|        | wrap/unwrap         | ?            | ?               | ?            |                   |\n|        +---------------------+--------------+-----------------+--------------+                   |\n|        | sign/verify         | ?            | ?               | ?            |                   |\n+--------+---------------------+--------------+-----------------+--------------+-------------------+\n| rsa    | generate key pair   | works        | works           | works        | works [4]_ [8]_   |\n|        +---------------------+--------------+-----------------+--------------+-------------------+\n|        | encrypt/decrypt     | works        | works           | works        | decrypt only [9]_ |\n|        +---------------------+--------------+-----------------+--------------+-------------------+\n|        | wrap/unwrap         | works        | works           | works        | n/a               |\n|        +---------------------+--------------+-----------------+--------------+-------------------+\n|        | sign/verify         | works        | works           | works        | works             |\n+--------+---------------------+--------------+-----------------+--------------+-------------------+\n| dsa    | generate parameters | works        | error           | n/a          | n/a               |\n|        +---------------------+--------------+-----------------+              |                   |\n|        | generate key pair   | works        | caveats [5]_    |              |                   |\n|        +---------------------+--------------+-----------------+              |                   |\n|        | sign/verify         | works        | works [4]_      |              |                   |\n+--------+---------------------+--------------+-----------------+--------------+-------------------+\n| dh     | generate parameters | works        | n/a             | n/a          | n/a               |\n|        +---------------------+--------------+-----------------+              |                   |\n|        | generate key pair   | works        | caveats [6]_    |              |                   |\n|        +---------------------+--------------+-----------------+              |                   |\n|        | derive key          | works        | caveats [7]_    |              |                   |\n+--------+---------------------+--------------+-----------------+--------------+-------------------+\n| ec     | generate key pair   | caveats [6]_ | ? [3]_          | n/a          | works             |\n|        +---------------------+--------------+-----------------+              +-------------------+\n|        | sign/verify (ecdsa) | works [4]_   | ? [3]_          |              | sign only [9]_    |\n|        +---------------------+--------------+-----------------+              +-------------------+\n|        | derive key (ecdh)   | works        | ? [3]_          |              | ?                 |\n+--------+---------------------+--------------+-----------------+--------------+-------------------+\n| proprietary extensions       | n/a          | not implemented | n/a          | n/a               |\n+------------------------------+--------------+-----------------+--------------+-------------------+\n\n.. [1] device supports limited set of attributes.\n.. [2] digesting keys is not supported.\n.. [3] untested: requires support in device.\n.. [4] default mechanism not supported, must specify a mechanism.\n.. [5] from existing domain parameters.\n.. [6] local domain parameters only.\n.. [7] generates security warnings about the derived key.\n.. [8] `store` parameter is ignored, all keys are stored.\n.. [9] encryption/verify not supported, extract the public key\n\npython version:\n\n* 3.4 (with `aenum`)\n* 3.5 (with `aenum`)\n* 3.6\n\npkcs#11 versions:\n\n* 2.11\n* 2.20\n* 2.40\n\nfeel free to send pull requests for any functionality that's not exposed. the\ncode is designed to be readable and expose the pkcs #11 spec in a\nstraight-forward way.\n\nif you want your device supported, get in touch!\n\nmore info on pkcs #11\n---------------------\n\nthe latest version of the pkcs #11 spec is available from oasis:\n\nhttp://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/pkcs11-base-v2.40.html\n\nyou should also consult the documentation for your pkcs #11 implementation.\nmany implementations expose additional vendor options configurable in your\nenvironment, including alternative features, modes and debugging\ninformation.\n\nlicense\n-------\n\nmit license\n\ncopyright (c) 2017 danielle madeley\n\npermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"software\"), to deal\nin the software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the software, and to permit persons to whom the software is\nfurnished to do so, subject to the following conditions:\n\nthe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the software.\n\nthe software is provided \"as is\", without warranty of any kind, express or\nimplied, including but not limited to the warranties of merchantability,\nfitness for a particular purpose and noninfringement. in no event shall the\nauthors or copyright holders be liable for any claim, damages or other\nliability, whether in an action of contract, tort or otherwise, arising from,\nout of or in connection with the software or the use or other dealings in the\nsoftware.",
  "docs_url": null,
  "keywords": "",
  "license": "",
  "name": "python-pkcs11",
  "package_url": "https://pypi.org/project/python-pkcs11/",
  "project_url": "https://pypi.org/project/python-pkcs11/",
  "project_urls": {
    "Homepage": "https://github.com/danni/python-pkcs11"
  },
  "release_url": "https://pypi.org/project/python-pkcs11/0.7.0/",
  "requires_dist": [],
  "requires_python": "",
  "summary": "pkcs#11 (cryptoki) support for python",
  "version": "0.7.0",
  "releases": [],
  "developers": [
    "danielle@madeley.id.au",
    "danielle_madeley"
  ],
  "kwds": "pkcs11_module pkcs11 pkcs cryptoki encryption",
  "license_kwds": "",
  "libtype": "pypi",
  "id": "pypi_python_pkcs11",
  "homepage": "https://github.com/danni/python-pkcs11",
  "release_count": 22,
  "dependency_ids": []
}