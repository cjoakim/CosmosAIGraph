{
  "classifiers": [
    "development status :: 4 - beta",
    "intended audience :: developers",
    "license :: osi approved :: apache software license",
    "operating system :: macos :: macos x",
    "operating system :: microsoft :: windows",
    "operating system :: posix",
    "programming language :: python",
    "programming language :: python :: 3",
    "programming language :: python :: 3.10",
    "programming language :: python :: 3.7",
    "programming language :: python :: 3.8",
    "programming language :: python :: 3.9",
    "programming language :: python :: implementation :: cpython",
    "programming language :: python :: implementation :: pypy",
    "topic :: database :: front-ends"
  ],
  "description": "# trino python client\n\nclient for [trino](https://trino.io/), a distributed sql engine for interactive and batch big data processing.\nprovides a low-level client and a dbapi 2.0 implementation and a sqlalchemy adapter.\nit supports python>=3.7 and pypy.\n\n[![build status](https://github.com/trinodb/trino-python-client/workflows/ci/badge.svg)](https://github.com/trinodb/trino-python-client/actions?query=workflow%3aci+event%3apush+branch%3amaster)\n[![trino slack](https://img.shields.io/static/v1?logo=slack&logocolor=959da5&label=slack&labelcolor=333a41&message=join%20conversation&color=3ac358)](https://trino.io/slack.html)\n[![trino: the definitive guide book download](https://img.shields.io/badge/trino%3a%20the%20definitive%20guide-download-brightgreen)](https://www.starburst.io/info/oreilly-trino-guide/)\n\n## development\n\nsee [development](.github/development.md) for information about code style,\ndevelopment process, and guidelines.\n\nsee [contributing](.github/contributing.md) for contribution requirements.\n\n## usage\n\n### the python database api (dbapi)\n\n**installation**\n\n```\n$ pip install trino\n```\n\n**quick start**\n\nuse the dbapi interface to query trino:\n\nif `host` is a valid url, the port and http schema will be automatically determined. for example `https://my-trino-server:9999` will assign the `http_schema` property to `https` and port to `9999`.\n\n```python\nfrom trino.dbapi import connect\n\nconn = connect(\n    host=\"<host>\",\n    port=<port>,\n    user=\"<username>\",\n    catalog=\"<catalog>\",\n    schema=\"<schema>\",\n)\ncur = conn.cursor()\ncur.execute(\"select * from system.runtime.nodes\")\nrows = cur.fetchall()\n```\n\nthis will query the `system.runtime.nodes` system tables that shows the nodes\nin the trino cluster.\n\nthe dbapi implementation in `trino.dbapi` provides methods to retrieve fewer\nrows for example `cursor.fetchone()` or `cursor.fetchmany()`. by default\n`cursor.fetchmany()` fetches one row. please set\n`trino.dbapi.cursor.arraysize` accordingly.\n\n### sqlalchemy\n\n**prerequisite**\n\n- trino server >= 351\n\n**compatibility**\n\n`trino.sqlalchemy` is compatible with the latest 1.3.x, 1.4.x and 2.0.x sqlalchemy\nversions at the time of release of a particular version of the client.\n\n**installation**\n\n```\n$ pip install trino[sqlalchemy]\n```\n\n**usage**\n\nto connect to trino using sqlalchemy, use a connection string (url) following this pattern:\n\n```\ntrino://<username>:<password>@<host>:<port>/<catalog>/<schema>\n```\n\nnote: `password` and `schema` are optional\n\n**examples**:\n\n```python\nfrom sqlalchemy import create_engine\nfrom sqlalchemy.schema import table, metadata\nfrom sqlalchemy.sql.expression import select, text\n\nengine = create_engine('trino://user@localhost:8080/system')\nconnection = engine.connect()\n\nrows = connection.execute(text(\"select * from runtime.nodes\")).fetchall()\n\n# or using sqlalchemy schema\nnodes = table(\n    'nodes',\n    metadata(schema='runtime'),\n    autoload=true,\n    autoload_with=engine\n)\nrows = connection.execute(select(nodes)).fetchall()\n```\n\nin order to pass additional connection attributes use [connect_args](https://docs.sqlalchemy.org/en/14/core/engines.html#sqlalchemy.create_engine.params.connect_args) method.\nattributes can also be passed in the connection string.\n\n```python\nfrom sqlalchemy import create_engine\nfrom trino.sqlalchemy import url\n\nengine = create_engine(\n    url(\n        host=\"localhost\",\n        port=8080,\n        catalog=\"system\"\n    ),\n    connect_args={\n      \"session_properties\": {'query_max_run_time': '1d'},\n      \"client_tags\": [\"tag1\", \"tag2\"],\n      \"roles\": {\"catalog1\": \"role1\"},\n    }\n)\n\n# or in connection string\nengine = create_engine(\n    'trino://user@localhost:8080/system?'\n    'session_properties={\"query_max_run_time\": \"1d\"}'\n    '&client_tags=[\"tag1\", \"tag2\"]'\n    '&roles={\"catalog1\": \"role1\"}'\n)\n\n# or using the url factory method\nengine = create_engine(url(\n  host=\"localhost\",\n  port=8080,\n  client_tags=[\"tag1\", \"tag2\"]\n))\n```\n\n## authentication mechanisms\n\n### basic authentication\n\nthe `basicauthentication` class can be used to connect to a trino cluster configured with\nthe [password file, ldap or salesforce authentication type](https://trino.io/docs/current/security/authentication-types.html):\n\n- dbapi\n\n    ```python\n    from trino.dbapi import connect\n    from trino.auth import basicauthentication\n\n    conn = connect(\n        user=\"<username>\",\n        auth=basicauthentication(\"<username>\", \"<password>\"),\n        http_scheme=\"https\",\n        ...\n    )\n    ```\n\n- sqlalchemy\n\n    ```python\n    from sqlalchemy import create_engine\n\n    engine = create_engine(\"trino://<username>:<password>@<host>:<port>/<catalog>\")\n\n    # or as connect_args\n    from trino.auth import basicauthentication\n    engine = create_engine(\n        \"trino://<username>@<host>:<port>/<catalog>\",\n        connect_args={\n            \"auth\": basicauthentication(\"<username>\", \"<password>\"),\n            \"http_scheme\": \"https\",\n        }\n    )\n    ```\n\n### jwt authentication\n\nthe `jwtauthentication` class can be used to connect to a trino cluster configured with\nthe [`jwt` authentication type](https://trino.io/docs/current/security/jwt.html):\n\n- dbapi\n\n    ```python\n    from trino.dbapi import connect\n    from trino.auth import jwtauthentication\n\n    conn = connect(\n        user=\"<username>\",\n        auth=jwtauthentication(\"<jwt_token>\"),\n        http_scheme=\"https\",\n        ...\n    )\n    ```\n\n- sqlalchemy\n\n    ```python\n    from sqlalchemy import create_engine\n\n    engine = create_engine(\"trino://<username>@<host>:<port>/<catalog>/<schema>?access_token=<jwt_token>\")\n\n    # or as connect_args\n    from trino.auth import jwtauthentication\n    engine = create_engine(\n        \"trino://<username>@<host>:<port>/<catalog>\",\n        connect_args={\n            \"auth\": jwtauthentication(\"<jwt_token>\"),\n            \"http_scheme\": \"https\",\n        }\n    )\n    ```\n\n### oauth2 authentication\n\nthe `oauth2authentication` class can be used to connect to a trino cluster configured with\nthe [oauth2 authentication type](https://trino.io/docs/current/security/oauth2.html).\n\na callback to handle the redirect url can be provided via param `redirect_auth_url_handler` of the `trino.auth.oauth2authentication` class. by default, it will try to launch a web browser (`trino.auth.webbrowserredirecthandler`) to go through the authentication flow and output the redirect url to stdout (`trino.auth.consoleredirecthandler`). multiple redirect handlers are combined using the `trino.auth.compositeredirecthandler` class.\n\nthe oauth2 token will be cached either per `trino.auth.oauth2authentication` instance or, when keyring is installed, it will be cached within a secure backend (macos keychain, windows credential locker, etc) under a key including host of the trino connection. keyring can be installed using `pip install 'trino[external-authentication-token-cache]'`.\n\n- dbapi\n\n    ```python\n    from trino.dbapi import connect\n    from trino.auth import oauth2authentication\n\n    conn = connect(\n        user=\"<username>\",\n        auth=oauth2authentication(),\n        http_scheme=\"https\",\n        ...\n    )\n    ```\n\n- sqlalchemy\n\n    ```python\n    from sqlalchemy import create_engine\n    from trino.auth import oauth2authentication\n\n    engine = create_engine(\n    \"trino://<username>@<host>:<port>/<catalog>\",\n        connect_args={\n            \"auth\": oauth2authentication(),\n            \"http_scheme\": \"https\",\n        }\n    )\n    ```\n\n### certificate authentication\n\n`certificateauthentication` class can be used to connect to trino cluster configured with [certificate based authentication](https://trino.io/docs/current/security/certificate.html). `certificateauthentication` requires paths to a valid client certificate and private key.\n\n- dbapi\n\n    ```python\n    from trino.dbapi import connect\n    from trino.auth import certificateauthentication\n\n    conn = connect(\n        user=\"<username>\",\n        auth=certificateauthentication(\"/path/to/cert.pem\", \"/path/to/key.pem\"),\n        http_scheme=\"https\",\n        ...\n    )\n    ```\n\n- sqlalchemy\n\n    ```python\n    from sqlalchemy import create_engine\n    from trino.auth import certificateauthentication\n\n    engine = create_engine(\"trino://<username>@<host>:<port>/<catalog>/<schema>?cert=<cert>&key=<key>\")\n\n    # or as connect_args\n    engine = create_engine(\n    \"trino://<username>@<host>:<port>/<catalog>\",\n        connect_args={\n            \"auth\": certificateauthentication(\"/path/to/cert.pem\", \"/path/to/key.pem\"),\n            \"http_scheme\": \"https\",\n        }\n    )\n    ```\n\n### kerberos authentication\n\nthe `kerberosauthentication` class can be used to connect to a trino cluster configured with\nthe [`kerberos` authentication type](https://trino.io/docs/current/security/kerberos.html):\n\n- dbapi\n\n    ```python\n    from trino.dbapi import connect\n    from trino.auth import kerberosauthentication\n\n    conn = connect(\n        user=\"<username>\",\n        auth=kerberosauthentication(...),\n        http_scheme=\"https\",\n        ...\n    )\n    ```\n\n- sqlalchemy\n\n    ```python\n    from sqlalchemy import create_engine\n    from trino.auth import kerberosauthentication\n\n    engine = create_engine(\n        \"trino://<username>@<host>:<port>/<catalog>\",\n        connect_args={\n            \"auth\": kerberosauthentication(...),\n            \"http_scheme\": \"https\",\n        }\n    )\n    ```\n\n## user impersonation\n\nin the case where user who submits the query is not the same as user who authenticates to trino server (e.g in superset),\nyou can set `username` to be different from `principal_id`. note that `principal_id` is extracted from `auth`,\nfor example `username` in basicauthentication, `sub` in jwt token or `service-name` in kerberosauthentication.\nyou need to make sure that [`principal_id` has permission to impersonate `username`](https://trino.io/docs/current/security/file-system-access-control.html#impersonation-rules).\n\n### extra credentials\n\n[`extra credentials`](https://trino.io/docs/current/develop/client-protocol.html#client-request-headers) can be sent as:\n\n```python\nimport trino\nconn = trino.dbapi.connect(\n    host='localhost',\n    port=443,\n    user='the-user',\n    extra_credential=[('a.username', 'bar'), ('a.password', 'foo')],\n)\n\ncur = conn.cursor()\ncur.execute('select * from system.runtime.nodes')\nrows = cur.fetchall()\n```\n\n## roles\n\nauthorization roles to use for catalogs, specified as a dict with key-value pairs for the catalog and role. for example, `{\"catalog1\": \"rolea\", \"catalog2\": \"roleb\"}` sets `rolea` for `catalog1` and `roleb` for `catalog2`. see trino docs.\n\n```python\nimport trino\nconn = trino.dbapi.connect(\n    host='localhost',\n    port=443,\n    user='the-user',\n    roles={\"catalog1\": \"rolea\", \"catalog2\": \"roleb\"},\n)\n```\n\nyou could also pass `system` role without explicitly specifing \"system\" catalog:\n\n```python\nimport trino\nconn = trino.dbapi.connect(\n    host='localhost',\n    port=443,\n    user='the-user',\n    roles=\"role1\" # equivalent to {\"system\": \"role1\"}\n)\n```\n\n## timezone\n\nthe time zone for the session can be explicitly set using the iana time zone\nname. when not set the time zone defaults to the client side local timezone.\n\n```python\nimport trino\nconn = trino.dbapi.connect(\n    host='localhost',\n    port=443,\n    user='username',\n    timezone='europe/brussels',\n)\n```\n\n> **note: the behaviour till version 0.320.0 was the same as setting session timezone to utc.**\n> **to preserve that behaviour pass `timezone='utc'` when creating the connection.**\n\n## ssl\n\n### ssl verification\n\nin order to disable ssl verification, set the `verify` parameter to `false`.\n\n```python\nfrom trino.dbapi import connect\nfrom trino.auth import basicauthentication\n\nconn = connect(\n    user=\"<username>\",\n    auth=basicauthentication(\"<username>\", \"<password>\"),\n    http_scheme=\"https\",\n    verify=false\n)\n```\n\n### self-signed certificates\n\nto use self-signed certificates, specify a path to the certificate in `verify` parameter.\nmore details can be found in [the python requests library documentation](https://requests.readthedocs.io/en/latest/user/advanced/#ssl-cert-verification).\n\n```python\nfrom trino.dbapi import connect\nfrom trino.auth import basicauthentication\n\nconn = connect(\n    user=\"<username>\",\n    auth=basicauthentication(\"<username>\", \"<password>\"),\n    http_scheme=\"https\",\n    verify=\"/path/to/cert.crt\"\n)\n```\n\n## transactions\n\nthe client runs by default in *autocommit* mode. to enable transactions, set\n*isolation_level* to a value different than `isolationlevel.autocommit`:\n\n```python\nfrom trino.dbapi import connect\nfrom trino.transaction import isolationlevel\n\nwith connect(\n        isolation_level=isolationlevel.repeatable_read,\n        ...\n) as conn:\n    cur = conn.cursor()\n    cur.execute('insert into sometable values (1, 2, 3)')\n    cur.fetchall()\n    cur.execute('insert into sometable values (4, 5, 6)')\n    cur.fetchall()\n```\n\nthe transaction is created when the first sql statement is executed.\n`trino.dbapi.connection.commit()` will be automatically called when the code\nexits the *with* context and the queries succeed, otherwise\n`trino.dbapi.connection.rollback()` will be called.\n\n## legacy primitive types\n\nby default, the client will convert the results of the query to the\ncorresponding python types. for example, if the query returns a `decimal` column, the result will be a `decimal` object.\nif you want to disable this behaviour, set flag `legacy_primitive_types` to `true`.\n\nlimitations of the python types are described in the \n[python types documentation](https://docs.python.org/3/library/datatypes.html). these limitations will generate an \nexception `trino.exceptions.trinodataerror` if the query returns a value that cannot be converted to the corresponding python \ntype.\n\n```python\nimport trino\n\nconn = trino.dbapi.connect(\n    legacy_primitive_types=true,\n    ...\n)\n\ncur = conn.cursor()\n# negative date cannot be represented with python types\n# legacy_primitive_types needs to be enabled\ncur.execute(\"select date '-2001-08-22'\")\nrows = cur.fetchall()\n\nassert rows[0][0] == \"-2001-08-22\"\nassert cur.description[0][1] == \"date\"\n```\n\n### trino to python type mappings\n\n| trino type | python type       |\n|------------|-------------------|\n| boolean    | bool              |\n| tinyint    | int               |\n| smallint   | int               |\n| integer    | int               |\n| bigint     | int               |\n| real       | float             |\n| double     | float             |\n| decimal    | decimal.decimal   |\n| varchar    | str               |\n| char       | str               |\n| varbinary  | bytes             |\n| date       | datetime.date     |\n| time       | datetime.time     |\n| timestamp  | datetime.datetime |\n| array      | list              |\n| map        | dict              |\n| row        | tuple             |\n\ntrino types other than those listed above are not mapped to python types. to use those use [legacy primitive types](#legacy-primitive-types).\n\n# need help?\n\nfeel free to create an issue as it makes your request visible to other users and contributors.\n\nif an interactive discussion would be better or if you just want to hangout and chat about\nthe trino python client, you can join us on the *#python-client* channel on\n[trino slack](https://trino.io/slack.html).\n",
  "docs_url": null,
  "keywords": "",
  "license": "apache 2.0",
  "name": "trino",
  "package_url": "https://pypi.org/project/trino/",
  "project_url": "https://pypi.org/project/trino/",
  "project_urls": {
    "Homepage": "https://github.com/trinodb/trino-python-client"
  },
  "release_url": "https://pypi.org/project/trino/0.327.0/",
  "requires_dist": [
    "python-dateutil",
    "pytz",
    "requests >=2.31.0",
    "tzlocal",
    "backports.zoneinfo ; python_version < \"3.9\"",
    "requests-kerberos ; extra == 'all'",
    "sqlalchemy >=1.3 ; extra == 'all'",
    "keyring ; extra == 'external-authentication-token-cache'",
    "requests-kerberos ; extra == 'kerberos'",
    "sqlalchemy >=1.3 ; extra == 'sqlalchemy'",
    "requests-kerberos ; extra == 'tests'",
    "sqlalchemy >=1.3 ; extra == 'tests'",
    "httpretty <1.1 ; extra == 'tests'",
    "pytest ; extra == 'tests'",
    "pytest-runner ; extra == 'tests'",
    "pre-commit ; extra == 'tests'",
    "black ; extra == 'tests'",
    "isort ; extra == 'tests'"
  ],
  "requires_python": ">=3.7",
  "summary": "client for the trino distributed sql engine",
  "version": "0.327.0",
  "releases": [],
  "developers": [
    "python-client@trino.io",
    "trino_team"
  ],
  "kwds": "trinodb trino sqlalchemy trinodataerror dbapi",
  "license_kwds": "apache 2.0",
  "libtype": "pypi",
  "id": "pypi_trino",
  "homepage": "https://github.com/trinodb/trino-python-client",
  "release_count": 25,
  "dependency_ids": [
    "pypi_backports.zoneinfo",
    "pypi_black",
    "pypi_httpretty",
    "pypi_isort",
    "pypi_keyring",
    "pypi_pre_commit",
    "pypi_pytest",
    "pypi_pytest_runner",
    "pypi_python_dateutil",
    "pypi_pytz",
    "pypi_requests",
    "pypi_requests_kerberos",
    "pypi_sqlalchemy",
    "pypi_tzlocal"
  ]
}