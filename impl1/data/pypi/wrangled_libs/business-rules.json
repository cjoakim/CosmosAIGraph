{
  "classifiers": [
    "programming language :: python",
    "programming language :: python :: 2",
    "programming language :: python :: 2.7",
    "programming language :: python :: 3",
    "programming language :: python :: 3.5",
    "programming language :: python :: 3.6",
    "programming language :: python :: 3.7"
  ],
  "description": "business-rules\n==============\n\nas a software system grows in complexity and usage, it can become burdensome if\nevery change to the logic/behavior of the system also requires you to write and\ndeploy new code. the goal of this business rules engine is to provide a simple\ninterface allowing anyone to capture new rules and logic defining the behavior\nof a system, and a way to then process those rules on the backend.\n\nyou might, for example, find this is a useful way for analysts to define\nmarketing logic around when certain customers or items are eligible for a\ndiscount or to automate emails after users enter a certain state or go through\na particular sequence of events.\n\n## usage\n\n### 1. define your set of variables\n\nvariables represent values in your system, usually the value of some particular object.  you create rules by setting threshold conditions such that when a variable is computed that triggers the condition some action is taken.\n\nyou define all the available variables for a certain kind of object in your code, and then later dynamically set the conditions and thresholds for those.\n\nfor example:\n\n```python\nclass productvariables(basevariables):\n\n    def __init__(self, product):\n        self.product = product\n\n    @numeric_rule_variable\n    def current_inventory(self):\n        return self.product.current_inventory\n\n    @numeric_rule_variable(label='days until expiration')\n    def expiration_days(self)\n        last_order = self.product.orders[-1]\n        return (last_order.expiration_date - datetime.date.today()).days\n\n    @string_rule_variable()\n    def current_month(self):\n        return datetime.datetime.now().strftime(\"%b\")\n\n    @select_rule_variable(options=products.top_holiday_items())\n    def goes_well_with(self):\n        return products.related_products\n```\n\n### 2. define your set of actions\n\nthese are the actions that are available to be taken when a condition is triggered.\n\nfor example:\n\n```python\nclass productactions(baseactions):\n\n    def __init__(self, product):\n        self.product = product\n\n    @rule_action(params={\"sale_percentage\": field_numeric})\n    def put_on_sale(self, sale_percentage):\n        self.product.price = (1.0 - sale_percentage) * self.product.price\n        self.product.save()\n\n    @rule_action(params={\"number_to_order\": field_numeric})\n    def order_more(self, number_to_order):\n        productorder.objects.create(product_id=self.product.id,\n                                    quantity=number_to_order)\n```\n\nif you need a select field for an action parameter, another -more verbose- syntax is available:\n\n```python\nclass productactions(baseactions):\n\n    def __init__(self, product):\n        self.product = product\n\n    @rule_action(params=[{'fieldtype': field_select,\n                          'name': 'stock_state',\n                          'label': 'stock state',\n                          'options': [\n                            {'label': 'available', 'name': 'available'},\n                            {'label': 'last items', 'name': 'last_items'},\n                            {'label': 'out of stock', 'name': 'out_of_stock'}\n                        ]}])\n    def change_stock_state(self, stock_state):\n        self.product.stock_state = stock_state\n        self.product.save()\n```\n\n### 3. build the rules\n\na rule is just a json object that gets interpreted by the business-rules engine.\n\nnote that the json is expected to be auto-generated by a ui, which makes it simple for anyone to set and tweak business rules without knowing anything about the code.  the javascript library used for generating these on the web can be found [here](https://github.com/venmo/business-rules-ui).\n\nan example of the resulting python lists/dicts is:\n\n```python\nrules = [\n# expiration_days < 5 and current_inventory > 20\n{ \"conditions\": { \"all\": [\n      { \"name\": \"expiration_days\",\n        \"operator\": \"less_than\",\n        \"value\": 5,\n      },\n      { \"name\": \"current_inventory\",\n        \"operator\": \"greater_than\",\n        \"value\": 20,\n      },\n  ]},\n  \"actions\": [\n      { \"name\": \"put_on_sale\",\n        \"params\": {\"sale_percentage\": 0.25},\n      },\n  ],\n},\n\n# current_inventory < 5 or (current_month = \"december\" and current_inventory < 20)\n{ \"conditions\": { \"any\": [\n      { \"name\": \"current_inventory\",\n        \"operator\": \"less_than\",\n        \"value\": 5,\n      },\n    ]},\n      { \"all\": [\n        {  \"name\": \"current_month\",\n          \"operator\": \"equal_to\",\n          \"value\": \"december\",\n        },\n        { \"name\": \"current_inventory\",\n          \"operator\": \"less_than\",\n          \"value\": 20,\n        }\n      ]},\n  },\n  \"actions\": [\n    { \"name\": \"order_more\",\n      \"params\":{\"number_to_order\": 40},\n    },\n  ],\n}]\n```\n\n### export the available variables, operators and actions\n\nto e.g. send to your client so it knows how to build rules\n\n```python\nfrom business_rules import export_rule_data\nexport_rule_data(productvariables, productactions)\n```\n\nthat returns\n\n```python\n{\"variables\": [\n    { \"name\": \"expiration_days\",\n      \"label\": \"days until expiration\",\n      \"field_type\": \"numeric\",\n      \"options\": []},\n    { \"name\": \"current_month\",\n      \"label\": \"current month\",\n      \"field_type\": \"string\",\n      \"options\": []},\n    { \"name\": \"goes_well_with\",\n      \"label\": \"goes well with\",\n      \"field_type\": \"select\",\n      \"options\": [\"eggnog\", \"cookies\", \"beef jerkey\"]}\n                ],\n  \"actions\": [\n    { \"name\": \"put_on_sale\",\n      \"label\": \"put on sale\",\n      \"params\": {\"sale_percentage\": \"numeric\"}},\n    { \"name\": \"order_more\",\n      \"label\": \"order more\",\n      \"params\": {\"number_to_order\": \"numeric\"}}\n  ],\n  \"variable_type_operators\": {\n    \"numeric\": [ {\"name\": \"equal_to\",\n                  \"label\": \"equal to\",\n                  \"input_type\": \"numeric\"},\n                 {\"name\": \"less_than\",\n                  \"label\": \"less than\",\n                  \"input_type\": \"numeric\"},\n                 {\"name\": \"greater_than\",\n                  \"label\": \"greater than\",\n                  \"input_type\": \"numeric\"}],\n    \"string\": [ { \"name\": \"equal_to\",\n                  \"label\": \"equal to\",\n                  \"input_type\": \"text\"},\n                { \"name\": \"non_empty\",\n                  \"label\": \"non empty\",\n                  \"input_type\": \"none\"}]\n  }\n}\n```\n\n### run your rules\n\n```python\nfrom business_rules import run_all\n\nrules = _some_function_to_receive_from_client()\n\nfor product in products.objects.all():\n    run_all(rule_list=rules,\n            defined_variables=productvariables(product),\n            defined_actions=productactions(product),\n            stop_on_first_trigger=true\n           )\n```\n\n## api\n\n#### variable types and decorators:\n\nthe type represents the type of the value that will be returned for the variable and is necessary since there are different available comparison operators for different types, and the front-end that's generating the rules needs to know which operators are available.\n\nall decorators can optionally take a label:\n- `label` - a human-readable label to show on the frontend. by default we just split the variable name on underscores and capitalize the words.\n\nthe available types and decorators are:\n\n**numeric** - an integer, float, or python decimal.\n\n`@numeric_rule_variable` operators:\n\n* `equal_to`\n* `greater_than`\n* `less_than`\n* `greater_than_or_equal_to`\n* `less_than_or_equal_to`\n\nnote: to compare floating point equality we just check that the difference is less than some small epsilon\n\n**string** - a python bytestring or unicode string.\n\n`@string_rule_variable` operators:\n\n* `equal_to`\n* `starts_with`\n* `ends_with`\n* `contains`\n* `matches_regex`\n* `non_empty`\n\n**boolean** - a true or false value.\n\n`@boolean_rule_variable` operators:\n\n* `is_true`\n* `is_false`\n\n**select** - a set of values, where the threshold will be a single item.\n\n`@select_rule_variable` operators:\n\n* `contains`\n* `does_not_contain`\n\n**select_multiple** - a set of values, where the threshold will be a set of items.\n\n`@select_multiple_rule_variable` operators:\n\n* `contains_all`\n* `is_contained_by`\n* `shares_at_least_one_element_with`\n* `shares_exactly_one_element_with`\n* `shares_no_elements_with`\n\n### returning data to your client\n\n\n\n## contributing\n\nopen up a pull request, making sure to add tests for any new functionality. to set up the dev environment (assuming you're using [virtualenvwrapper](http://docs.python-guide.org/en/latest/dev/virtualenvs/#virtualenvwrapper)):\n\n```bash\n$ python -m virtualenv venv\n$ source ./venv/bin/activate\n$ pip install -r dev-requirements.txt -e .\n$ pytest\n```\n\nalternatively, you can also use tox:\n\n```bash\n$ pip install \"tox<4\"\n$ tox -p auto --skip-missing-interpreters\n```\n\n\nhistory\n=========\n\n## 1.1.1\n\nrelease date: 2022-3-18\n\n- fix package description and long description\n\n## 1.1.0\n\nrelease date: 2022-3-18\n\n- add support for python 3.5-3.7\n\n## 1.0.1\n\nrelease date: 2016-3-16\n\n- fixes a packaging bug preventing 1.0.0 from being installed on some platforms.\n\n## 1.0.0\n\nrelease date: 2016-3-16\n\n- removes caching layer on rule decorator\n\n\n",
  "docs_url": null,
  "keywords": "",
  "license": "mit",
  "name": "business-rules",
  "package_url": "https://pypi.org/project/business-rules/",
  "project_url": "https://pypi.org/project/business-rules/",
  "project_urls": {
    "Homepage": "https://github.com/venmo/business-rules"
  },
  "release_url": "https://pypi.org/project/business-rules/1.1.1/",
  "requires_dist": [
    "six (>=1.16.0)"
  ],
  "requires_python": ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*, !=3.4.*",
  "summary": "python dsl for setting up business intelligence rules that can be configured without code",
  "version": "1.1.1",
  "releases": [],
  "developers": [
    "open-source@venmo.com",
    "venmo"
  ],
  "kwds": "business_rules boolean_rule_variable defined_variables rule_action numeric_rule_variable",
  "license_kwds": "mit",
  "libtype": "pypi",
  "id": "pypi_business_rules",
  "homepage": "https://github.com/venmo/business-rules",
  "release_count": 8,
  "dependency_ids": [
    "pypi_six"
  ]
}