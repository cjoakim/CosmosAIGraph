{
  "classifiers": [
    "programming language :: python :: implementation :: cpython",
    "programming language :: python :: implementation :: pypy",
    "programming language :: rust",
    "topic :: software development :: build tools"
  ],
  "description": "# maturin\n\n_formerly pyo3-pack_\n\n[![maturin user guide](https://img.shields.io/badge/user-guide-brightgreen?logo=readthedocs&style=flat-square)](https://maturin.rs)\n[![crates.io](https://img.shields.io/crates/v/maturin.svg?logo=rust&style=flat-square)](https://crates.io/crates/maturin)\n[![pypi](https://img.shields.io/pypi/v/maturin.svg?logo=python&style=flat-square)](https://pypi.org/project/maturin)\n[![actions status](https://img.shields.io/github/actions/workflow/status/pyo3/maturin/test.yml?branch=main&logo=github&style=flat-square)](https://github.com/pyo3/maturin/actions)\n[![freebsd](https://img.shields.io/cirrus/github/pyo3/maturin/main?logo=circleci&style=flat-square)](https://cirrus-ci.com/github/pyo3/maturin)\n[![chat on gitter](https://img.shields.io/gitter/room/nwjs/nw.js.svg?logo=gitter&style=flat-square)](https://gitter.im/pyo3/lobby)\n\nbuild and publish crates with pyo3, rust-cpython, cffi and uniffi bindings as well as rust binaries as python packages.\n\nthis project is meant as a zero configuration replacement for [setuptools-rust](https://github.com/pyo3/setuptools-rust) and [milksnake](https://github.com/getsentry/milksnake).\nit supports building wheels for python 3.7+ on windows, linux, mac and freebsd, can upload them to [pypi](https://pypi.org/) and has basic pypy and graalpy support.\n\ncheck out the [user guide](https://maturin.rs/)!\n\n## usage\n\nyou can either download binaries from the [latest release](https://github.com/pyo3/maturin/releases/latest) or install it with [pipx](https://pypa.github.io/pipx/):\n\n```shell\npipx install maturin\n```\n\n> **note**\n>\n> `pip install maturin` should also work if you don't want to use pipx.\n\nthere are four main commands:\n\n * `maturin new` creates a new cargo project with maturin configured.\n * `maturin publish` builds the crate into python packages and publishes them to pypi.\n * `maturin build` builds the wheels and stores them in a folder (`target/wheels` by default), but doesn't upload them. it's possible to upload those with [twine](https://github.com/pypa/twine) or `maturin upload`.\n * `maturin develop` builds the crate and installs it as a python module directly in the current virtualenv. note that while `maturin develop` is faster, it doesn't support all the feature that running `pip install` after `maturin build` supports.\n\n`pyo3` and `rust-cpython` bindings are automatically detected. for cffi or binaries, you need to pass `-b cffi` or `-b bin`.\nmaturin doesn't need extra configuration files and doesn't clash with an existing setuptools-rust or milksnake configuration.\nyou can even integrate it with testing tools such as [tox](https://tox.readthedocs.io/en/latest/).\nthere are examples for the different bindings in the `test-crates` folder.\n\nthe name of the package will be the name of the cargo project, i.e. the name field in the `[package]` section of `cargo.toml`.\nthe name of the module, which you are using when importing, will be the `name` value in the `[lib]` section (which defaults to the name of the package). for binaries, it's simply the name of the binary generated by cargo.\n\n## python packaging basics\n\npython packages come in two formats:\na built form called wheel and source distributions (sdist), both of which are archives.\na wheel can be compatible with any python version, interpreter (cpython and pypy, mainly), operating system and hardware architecture (for pure python wheels),\ncan be limited to a specific platform and architecture (e.g. when using ctypes or cffi) or to a specific python interpreter and version on a specific architecture and operating system (e.g. with pyo3 and rust-cpython).\n\nwhen using `pip install` on a package, pip tries to find a matching wheel and install that. if it doesn't find one, it downloads the source distribution and builds a wheel for the current platform,\nwhich requires the right compilers to be installed. installing a wheel is much faster than installing a source distribution as building wheels is generally slow.\n\nwhen you publish a package to be installable with `pip install`, you upload it to [pypi](https://pypi.org/), the official package repository.\nfor testing, you can use [test pypi](https://test.pypi.org/) instead, which you can use with `pip install --index-url https://test.pypi.org/simple/`.\nnote that for publishing for linux, [you need to use the manylinux docker container](#manylinux-and-auditwheel), while for publishing from your repository you can use the [pyo3/maturin-action github action](https://github.com/pyo3/maturin-action).\n\n## pyo3 and rust-cpython\n\nfor pyo3 and rust-cpython, maturin can only build packages for installed python versions. on linux and mac, all python versions in `path` are used.\nif you don't set your own interpreters with `-i`, a heuristic is used to search for python installations.\non windows all versions from the python launcher (which is installed by default by the python.org installer) and all conda environments except base are used. you can check which versions are picked up with the `list-python` subcommand.\n\npyo3 will set the used python interpreter in the environment variable `python_sys_executable`, which can be used from custom build scripts. maturin can build and upload wheels for pypy with pyo3, even though only pypy3.7-7.3 on linux is tested.\n\n## cffi\n\ncffi wheels are compatible with all python versions including pypy. if `cffi` isn't installed and python is running inside a virtualenv, maturin will install it, otherwise you have to install it yourself (`pip install cffi`).\n\nmaturin uses cbindgen to generate a header file, which can be customized by configuring cbindgen through a `cbindgen.toml` file inside your project root. alternatively you can use a build script that writes a header file to `$project_root/target/header.h`.\n\nbased on the header file maturin generates a module which exports an `ffi` and a `lib` object.\n\n<details>\n<summary>example of a custom build script</summary>\n\n```rust\nuse cbindgen;\nuse std::env;\nuse std::path::path;\n\nfn main() {\n    let crate_dir = env::var(\"cargo_manifest_dir\").unwrap();\n\n    let bindings = cbindgen::builder::new()\n        .with_no_includes()\n        .with_language(cbindgen::language::c)\n        .with_crate(crate_dir)\n        .generate()\n        .unwrap();\n    bindings.write_to_file(path::new(\"target\").join(\"header.h\"));\n}\n```\n\n</details>\n\n## uniffi\n\nuniffi bindings use [uniffi-rs](https://mozilla.github.io/uniffi-rs/) to generate python `ctypes` bindings\nfrom an interface definition file. uniffi wheels are compatible with all python versions including pypy.\n\n## mixed rust/python projects\n\nto create a mixed rust/python project, create a folder with your module name (i.e. `lib.name` in cargo.toml) next to your cargo.toml and add your python sources there:\n\n```\nmy-project\n\u251c\u2500\u2500 cargo.toml\n\u251c\u2500\u2500 my_project\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 bar.py\n\u251c\u2500\u2500 pyproject.toml\n\u251c\u2500\u2500 readme.md\n\u2514\u2500\u2500 src\n \u00a0\u00a0 \u2514\u2500\u2500 lib.rs\n```\n\nyou can specify a different python source directory in `pyproject.toml` by setting `tool.maturin.python-source`, for example\n\n**pyproject.toml**\n\n```toml\n[tool.maturin]\npython-source = \"python\"\nmodule-name = \"my_project._lib_name\"\n```\n\nthen the project structure would look like this:\n\n```\nmy-project\n\u251c\u2500\u2500 cargo.toml\n\u251c\u2500\u2500 python\n\u2502   \u2514\u2500\u2500 my_project\n\u2502       \u251c\u2500\u2500 __init__.py\n\u2502       \u2514\u2500\u2500 bar.py\n\u251c\u2500\u2500 pyproject.toml\n\u251c\u2500\u2500 readme.md\n\u2514\u2500\u2500 src\n \u00a0\u00a0 \u2514\u2500\u2500 lib.rs\n```\n\n> **note**\n>\n> this structure is recommended to avoid [a common `importerror` pitfall](https://github.com/pyo3/maturin/issues/490)\n\nmaturin will add the native extension as a module in your python folder. when using develop, maturin will copy the native library and for cffi also the glue code to your python folder. you should add those files to your gitignore.\n\nwith cffi you can do `from .my_project import lib` and then use `lib.my_native_function`, with pyo3/rust-cpython you can directly `from .my_project import my_native_function`.\n\nexample layout with pyo3 after `maturin develop`:\n\n```\nmy-project\n\u251c\u2500\u2500 cargo.toml\n\u251c\u2500\u2500 my_project\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bar.py\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 _lib_name.cpython-36m-x86_64-linux-gnu.so\n\u251c\u2500\u2500 readme.md\n\u2514\u2500\u2500 src\n \u00a0\u00a0 \u2514\u2500\u2500 lib.rs\n```\n\nwhen doing this also be sure to set the module name in your code to match the last part of `module-name` (don't include the package path):\n\n```rust\n#[pymodule]\n#[pyo3(name=\"_lib_name\")]\nfn my_lib_name(_py: python<'_>, m: &pymodule) -> pyresult<()> {\n    m.add_class::<mypythonrustclass>()?;\n    ok(())\n}\n```\n\n\n## python metadata\n\nmaturin supports [pep 621](https://www.python.org/dev/peps/pep-0621/), you can specify python package metadata in `pyproject.toml`.\nmaturin merges metadata from `cargo.toml` and `pyproject.toml`, `pyproject.toml` takes precedence over `cargo.toml`.\n\nto specify python dependencies, add a list `dependencies` in a `[project]` section in the `pyproject.toml`. this list is equivalent to `install_requires` in setuptools:\n\n```toml\n[project]\nname = \"my-project\"\ndependencies = [\"flask~=1.1.0\", \"toml==0.10.0\"]\n```\n\npip allows adding so called console scripts, which are shell commands that execute some function in your program. you can add console scripts in a section `[project.scripts]`.\nthe keys are the script names while the values are the path to the function in the format `some.module.path:class.function`, where the `class` part is optional. the function is called with no arguments. example:\n\n```toml\n[project.scripts]\nget_42 = \"my_project:dummyclass.get_42\"\n```\n\nyou can also specify [trove classifiers](https://pypi.org/classifiers/) in your `pyproject.toml` under `project.classifiers`:\n\n```toml\n[project]\nname = \"my-project\"\nclassifiers = [\"programming language :: python\"]\n```\n\n## source distribution\n\nmaturin supports building through `pyproject.toml`. to use it, create a `pyproject.toml` next to your `cargo.toml` with the following content:\n\n```toml\n[build-system]\nrequires = [\"maturin>=1.0,<2.0\"]\nbuild-backend = \"maturin\"\n```\n\nif a `pyproject.toml` with a `[build-system]` entry is present, maturin can build a source distribution of your package when `--sdist` is specified.\nthe source distribution will contain the same files as `cargo package`. to only build a source distribution, pass `--interpreter` without any values.\n\nyou can then e.g. install your package with `pip install .`. with `pip install . -v` you can see the output of cargo and maturin.\n\nyou can use the options `compatibility`, `skip-auditwheel`, `bindings`, `strip` and common cargo build options such as `features` under `[tool.maturin]` the same way you would when running maturin directly.\nthe `bindings` key is required for cffi and bin projects as those can't be automatically detected. currently, all builds are in release mode (see [this thread](https://discuss.python.org/t/pep-517-debug-vs-release-builds/1924) for details).\n\nfor a non-manylinux build with cffi bindings you could use the following:\n\n```toml\n[build-system]\nrequires = [\"maturin>=1.0,<2.0\"]\nbuild-backend = \"maturin\"\n\n[tool.maturin]\nbindings = \"cffi\"\ncompatibility = \"linux\"\n```\n\n`manylinux` option is also accepted as an alias of `compatibility` for backward compatibility with old version of maturin.\n\nto include arbitrary files in the sdist for use during compilation specify `include` as an array of `path` globs with `format` set to `sdist`:\n\n```toml\n[tool.maturin]\ninclude = [{ path = \"path/**/*\", format = \"sdist\" }]\n```\n\nthere's a `maturin sdist` command for only building a source distribution as workaround for [pypa/pip#6041](https://github.com/pypa/pip/issues/6041).\n\n## manylinux and auditwheel\n\nfor portability reasons, native python modules on linux must only dynamically link a set of very few libraries which are installed basically everywhere, hence the name manylinux.\nthe pypa offers special docker images and a tool called [auditwheel](https://github.com/pypa/auditwheel/) to ensure compliance with the [manylinux rules](https://peps.python.org/pep-0599/#the-manylinux2014-policy).\nif you want to publish widely usable wheels for linux pypi, **you need to use a manylinux docker image**.\n\nthe rust compiler since version 1.64 [requires at least glibc 2.17](https://blog.rust-lang.org/2022/08/01/increasing-glibc-kernel-requirements.html), so you need to use at least manylinux2014.\nfor publishing, we recommend enforcing the same manylinux version as the image with the manylinux flag, e.g. use `--manylinux 2014` if you are building in `quay.io/pypa/manylinux2014_x86_64`.\nthe [pyo3/maturin-action](https://github.com/pyo3/maturin-action) github action already takes care of this if you set e.g. `manylinux: 2014`.\n\nmaturin contains a reimplementation of auditwheel automatically checks the generated library and gives the wheel the proper.\nif your system's glibc is too new or you link other shared libraries, it will assign the `linux` tag.\nyou can also manually disable those checks and directly use native linux target with `--manylinux off`.\n\nfor full manylinux compliance you need to compile in a centos docker container. the [pyo3/maturin](https://ghcr.io/pyo3/maturin) image is based on the manylinux2014 image,\nand passes arguments to the `maturin` binary. you can use it like this:\n\n```\ndocker run --rm -v $(pwd):/io ghcr.io/pyo3/maturin build --release  # or other maturin arguments\n```\n\nnote that this image is very basic and only contains python, maturin and stable rust. if you need additional tools, you can run commands inside the manylinux container.\nsee [konstin/complex-manylinux-maturin-docker](https://github.com/konstin/complex-manylinux-maturin-docker) for a small educational example or [nanoporetech/fast-ctc-decode](https://github.com/nanoporetech/fast-ctc-decode/blob/b226ea0f2b2f4f474eff47349703d57d2ea4801b/.github/workflows/publish.yml) for a real world setup.\n\nmaturin itself is manylinux compliant when compiled for the musl target.\n\n## examples\n\n* [ballista-python](https://github.com/apache/arrow-ballista-python) - a python library that binds to apache arrow distributed query engine ballista\n* [chardetng-py](https://github.com/john-parton/chardetng-py) - python binding for the chardetng character encoding detector.\n* [connector-x](https://github.com/sfu-db/connector-x/tree/main/connectorx-python) - connectorx enables you to load data from databases into python in the fastest and most memory efficient way\n* [datafusion-python](https://github.com/apache/arrow-datafusion-python) - a python library that binds to apache arrow in-memory query engine datafusion\n* [deltalake-python](https://github.com/delta-io/delta-rs/tree/main/python) - native delta lake python binding based on delta-rs with pandas integration\n* [opendal](https://github.com/apache/incubator-opendal/tree/main/bindings/python) - opendal python binding to access data freely\n* [orjson](https://github.com/ijl/orjson) - a fast, correct json library for python\n* [polars](https://github.com/pola-rs/polars/tree/master/py-polars) - fast multi-threaded dataframe library in rust | python | node.js\n* [pydantic-core](https://github.com/pydantic/pydantic-core) - core validation logic for pydantic written in rust\n* [pyrus-cramjam](https://github.com/milesgranger/pyrus-cramjam) - thin python wrapper to de/compression algorithms in rust\n* [pyxel](https://github.com/kitao/pyxel) - a retro game engine for python\n* [roapi](https://github.com/roapi/roapi) - roapi automatically spins up read-only apis for static datasets without requiring you to write a single line of code\n* [robyn](https://github.com/sansyrox/robyn) -  a fast and extensible async python web server with a rust runtime\n* [ruff](https://github.com/charliermarsh/ruff) - an extremely fast python linter, written in rust\n* [tantivy-py](https://github.com/quickwit-oss/tantivy-py) - python bindings for tantivy\n* [watchfiles](https://github.com/samuelcolvin/watchfiles) - simple, modern and high performance file watching and code reload in python\n* [wonnx](https://github.com/webonnx/wonnx/tree/master/wonnx-py) - wonnx is a gpu-accelerated onnx inference run-time written 100% in rust\n\n## contributing\n\neveryone is welcomed to contribute to maturin! there are many ways to support the project, such as:\n\n- help maturin users with issues on github and gitter\n- improve documentation\n- write features and bugfixes\n- publish blogs and examples of how to use maturin\n\nour [contributing notes](https://github.com/pyo3/maturin/blob/main/guide/src/contributing.md) have more resources if you wish to volunteer time for maturin and are searching where to start.\n\nif you don't have time to contribute yourself but still wish to support the project's future success, some of our maintainers have github sponsorship pages:\n\n- [messense](https://github.com/sponsors/messense)\n\n## license\n\nlicensed under either of:\n\n * apache license, version 2.0, ([license-apache](https://github.com/pyo3/maturin/blob/main/license-apache) or http://www.apache.org/licenses/license-2.0)\n * mit license ([license-mit](https://github.com/pyo3/maturin/blob/main/license-mit) or http://opensource.org/licenses/mit)\n\nat your option.\n\n",
  "docs_url": null,
  "keywords": "python,cffi,packaging,pypi,pyo3",
  "license": "mit or apache-2.0",
  "name": "maturin",
  "package_url": "https://pypi.org/project/maturin/",
  "project_url": "https://pypi.org/project/maturin/",
  "project_urls": {
    "Changelog": "https://maturin.rs/changelog.html",
    "Documentation": "https://maturin.rs",
    "Homepage": "https://github.com/pyo3/maturin",
    "Issues": "https://github.com/PyO3/maturin/issues",
    "Source Code": "https://github.com/PyO3/maturin"
  },
  "release_url": "https://pypi.org/project/maturin/1.4.0/",
  "requires_dist": [
    "tomli >=1.1.0 ; python_version < '3.11'",
    "ziglang ~=0.10.0 ; extra == 'zig'",
    "patchelf ; extra == 'patchelf'"
  ],
  "requires_python": ">=3.7",
  "summary": "build and publish crates with pyo3, rust-cpython and cffi bindings as well as rust binaries as python packages",
  "version": "1.4.0",
  "releases": [],
  "developers": [
    "konstin@mailbox.org",
    "messense@icloud.com"
  ],
  "kwds": "maturin crate_dir with_crate pypy3 shields",
  "license_kwds": "mit or apache-2.0",
  "libtype": "pypi",
  "id": "pypi_maturin",
  "homepage": "https://github.com/pyo3/maturin",
  "release_count": 133,
  "dependency_ids": [
    "pypi_patchelf",
    "pypi_tomli",
    "pypi_ziglang"
  ]
}