{
  "classifiers": [
    "development status :: 3 - alpha",
    "intended audience :: developers",
    "intended audience :: end users/desktop",
    "intended audience :: science/research",
    "license :: osi approved :: mit license",
    "operating system :: os independent",
    "programming language :: python",
    "programming language :: python :: 3",
    "programming language :: python :: 3.10",
    "programming language :: python :: 3.5",
    "programming language :: python :: 3.6",
    "programming language :: python :: 3.7",
    "programming language :: python :: 3.8",
    "programming language :: python :: 3.9",
    "topic :: office/business :: financial :: spreadsheet",
    "topic :: software development :: libraries :: python modules"
  ],
  "description": "# pygsheets - google spreadsheets python api v4\n[![build status](https://travis-ci.org/nithinmurali/pygsheets.svg?branch=staging)](https://travis-ci.org/nithinmurali/pygsheets)  [![pypi version](https://badge.fury.io/py/pygsheets.svg)](https://badge.fury.io/py/pygsheets)    [![documentation status](https://readthedocs.org/projects/pygsheets/badge/?version=latest)](http://pygsheets.readthedocs.io/en/latest/?badge=latest) [![gitpod ready-to-code](https://img.shields.io/badge/gitpod-ready--to--code-blue?logo=gitpod)](https://gitpod.io/#https://github.com/nithinmurali/pygsheets)\n\na simple, intuitive library for google sheets which gets your work done.\n \nfeatures:\n\n* open, create, delete and share spreadsheets using _title_ or _key_\n* intuitive models - spreadsheet, worksheet, cell, datarange\n* control permissions of spreadsheets.\n* set cell format, text format, color, write notes\n* named and protected ranges support\n* work with range of cells easily with datarange and gridrange\n* data validation support. checkboxes, drop-downs etc.\n* conditional formatting support\n* get multiple ranges with get_values_batch and update wit update_values_batch\n\n## updates\n* version [2.0.6](https://github.com/nithinmurali/pygsheets/releases/tag/2.0.6) released\n\n## installation\n\n#### from pypi (stable)\n\n```sh\npip install pygsheets\n\n```\n\nif you are installing from pypi please see the docs [here](https://pygsheets.readthedocs.io/en/stable/).\n\n\n#### from github (recommended)\n\n```sh\npip install https://github.com/nithinmurali/pygsheets/archive/staging.zip\n\n```\n\nif you are installing from github please see the docs [here](https://pygsheets.readthedocs.io/en/staging/).\n\n## basic usage\n\nbasic features are shown here, for complete set of features see the full documentation [here](http://pygsheets.readthedocs.io/en/staging/).\n\n1. obtain oauth2 credentials from google developers console for __google spreadsheet api__ and __drive api__ and save the file as `client_secret.json` in same directory as project. [read more here.](https://pygsheets.readthedocs.io/en/latest/authorization.html)\n\n2. start using pygsheets: \n   \nsample scenario : you want to share a numpy array with your remote friend \n\n```python\nimport pygsheets\nimport numpy as np\n\ngc = pygsheets.authorize()\n\n# open spreadsheet and then worksheet\nsh = gc.open('my new sheet')\nwks = sh.sheet1\n\n# update a cell with value (just to let him know values is updated ;) )\nwks.update_value('a1', \"hey yank this numpy array\")\nmy_nparray = np.random.randint(10, size=(3, 4))\n\n# update the sheet with array\nwks.update_values('a2', my_nparray.tolist())\n\n# share the sheet with your friend\nsh.share(\"myfriend@gmail.com\")\n\n```\n\nsample scenario: you want to fill height values of students\n```python\n\n## import pygsheets and open the sheet as given above\n\nheader = wks.cell('a1')\nheader.value = 'names'\nheader.text_format['bold'] = true # make the header bold\nheader.update()\n\n# or achive the same in oneliner\nwks.cell('b1').set_text_format('bold', true).value = 'heights'\n\n# set the names\nwks.update_values('a2:a5',[['name1'],['name2'],['name3'],['name4']])\n\n# set the heights\nheights = wks.range('b2:b5', returnas='range')  # get the range as datarange object\nheights.name = \"heights\"  # name the range\nheights.update_values([[50],[60],[67],[66]]) # update the values\nwks.update_value('b6','=average(heights)') # set the avg value of heights using named range\n\n```\n\n## more examples\n\n### opening a spreadsheet\n\n```python\n# you can open a spreadsheet by its title as it appears in google docs \nsh = gc.open(\"pygsheettest\")\n\n# if you want to be specific, use a key\nsht1 = gc.open_by_key('1mwa-nmvjdqd3a65c8hsxopqdfdggpr0fgfg5nxrksczaum')\n\n# create a spreadsheet in a folder (by id)\nsht2 = gc.create(\"new sheet\", folder_name=\"my worksheets\")\n\n# open enable teamdrive support\ngc.drive.enable_team_drive(\"dqd3a65c8hsxopqdfdggpr0fgfg\")\n\n```\n\n### operations on spreadsheet [doc](http://pygsheets.readthedocs.io/en/latest/spreadsheet.html)\n\n<details> <summary>show code</summary>\n\n```python\n\nimport pygsheets\nc = pygsheets.authorize()\nsh = c.open('spreadsheet')\n\n# create a new sheet with 50 rows and 60 colums\nwks = sh.add_worksheet(\"new sheet\",rows=50,cols=60)\n\n# create a new sheet with 50 rows and 60 colums at the begin of worksheets\nwks = sh.add_worksheet(\"new sheet\",rows=50,cols=60,index=0)\n\n# or copy from another worksheet\nwks = sh.add_worksheet(\"new sheet\", src_worksheet='<other worksheet instance>')\n\n# delete this wroksheet\nsh.del_worksheet(wks)\n\n# unshare the sheet\nsh.remove_permissions(\"mynotsofriend@gmail.com\")\n\n```\n\n</details>\n\n### selecting a worksheet\n\n<details> <summary>show code</summary>\n\n```python\nimport pygsheets\nc = pygsheets.authorize()\nsh = c.open('spreadsheet')\n\n# select worksheet by id, index, title.\nwks = sh.worksheet_by_title(\"my test sheet\")\n\n# by any property\nwks = sh.worksheet('index', 0)\n\n# get a list of all worksheets\nwks_list = sh.worksheets()\n\n# or just\nwks = sh[0]\n```\n\n</details>\n\n### operations on worksheet [doc](http://pygsheets.readthedocs.io/en/latest/worksheet.html)\n\n<details> <summary>show code</summary>\n\n```python\n# get values as 2d array('matrix') which can easily be converted to an numpy aray or as 'cell' list\nvalues_mat = wks.get_values(start=(1,1), end=(20,20), returnas='matrix')\n\n# get values of - rows a1 to b10, column c, 1st row, 10th row\nwks.get_values_batch(['a1:b10', 'c', '1', (10, none)])\n\n# get all values of sheet as 2d list of cells\ncell_matrix = wks.get_all_values(returnas='matrix')\n\n# update a range of values with a cell list or matrix\nwks.update_values(crange='a1:e10', values=values_mat)\n\n# update multiple ranges with bath update\nwks.update_values_batch(['a1:a2', 'b1:b2'], [[[1],[2]], [[3],[4]]])\n\n# insert 2 rows after 20th row and fill with values\nwks.insert_rows(row=20, number=2, values=values_list)\n\n# resize by changing rows and colums\nwks.rows=30\n\n# use the worksheet as a csv\nfor row in wks:\n    print(row)\n\n# get values by indexes\n a1_value = wks[0][0]\n\n# clear all values\nwks.clear()\n\n# search for a table in the worksheet and append a row to it\nwks.append_table(values=[1,2,3,4])\n\n# export a worksheet as csv\nwks.export(pygsheets.exporttype.csv)\n\n# find/replace cells with string value\ncell_list = worksheet.find(\"query string\")\n\n# find/replace cells with regexp\nfilter_re = re.compile(r'(small|big) house')\ncell_list = worksheet.find(filter_re, searchbyregex=true)\ncell_list = worksheet.replace(filter_re, 'some house', searchbyregex=true)\n\n# move a worksheet in the same spreadsheet (update index)\nwks.index = 2 # index start at 1 , not 0\n\n# update title\nwks.title = \"newtitle\"\n\n# update hidden state\nwks.hidden = false\n\n# working with named ranges\nwks.create_named_range('a1', 'a10', 'prices')\nwks.get_named_range('prices')\nwks.get_named_ranges()  # will return a list of datarange objects\nwks.delete_named_range('prices')\n\n# apply format\nwks.apply_format(['a1:b1', 'd:e'], [\"number\", \"text\"])\n\n# plot a chart/graph\nwks.add_chart(('a1', 'a6'), [('b1', 'b6')], 'health trend')\n\n# create drop-downs\nwks.set_data_validation(start='c4', end='e7', condition_type='number_between', condition_values=[2,10], strict=true, inputmessage=\"inut between 2 and 10\")\n\n# set a formula and extend it to more cells\ncell = wks.cell('c1')\ncell.value = '=a1+b1'\nwks.apply_format('c1:c10', cell, 'userenteredvalue.formulavalue')\n\n```\n\n</details>\n\n#### pandas integration\nif you work with pandas, you can directly use the dataframes\n```python\n#set the values of a pandas dataframe to sheet\nwks.set_dataframe(df,(1,1))\n\n#you can also get the values of sheet as dataframe\ndf = wks.get_as_df()\n\n```\n\n\n### cell object [doc](http://pygsheets.readthedocs.io/en/latest/cell.html)\n\neach cell has a __value__ and cordinates (__row__, __col__, __label__) properties.\n\ngetting cell objects\n\n<details open> <summary>show code</summary>\n\n```python\nc1 = cell('a1',\"hello\")  # create a unlinked cell\nc1 = worksheet.cell('a1')  # creates a linked cell whose changes syncs instantanously\ncl.value  # getting cell value\nc1.value_unformatted #getting cell unformatted value\nc1.formula # getting cell formula if any\nc1.note # any notes on the cell\nc1.address # address object with cell position\n\ncell_list = worksheet.range('a1:c7')  # get a range of cells \ncell_list = worksheet.col(5, returnas='cell')  # return all cells in 5th column(e)\n\n```\n\n</details>\n\nmost of the functions has `returnas` param, if whose value is `cell` it will return a list of cell objects. also you can use *label* or *(row,col)* tuple interchangbly as a cell adress\n\n### cell operations\n\neach cell is directly linked with its cell in spreadsheet, hence changing the value of cell object will update the corresponding cell in spreadsheet unless you explictly unlink it\nalso not that bu default only the value of cell is fetched, so if you are directly accessing any cell properties call `cell.fetch()` beforehand. \n\ndifferent ways of updating cells\n\n<details> <summary>show code</summary>\n\n```python\n# using linked cells\nc1 = worksheet.cell('b1') # created from worksheet, so linked cell\nc1.col = 5  # now c1 correponds to e1\nc1.value = \"hoho\"  # will change the value of e1\n\n# or onliner\nworksheet.update_value('b1', 'hehe')\n\n# get a range of cells\ncell_list = worksheet.range('a1:c7')\ncell_list = worksheet.get_values(start='a1', end='c7', returnas='cells')\ncell_list = worksheet.get_row(2, returnas='cells')\n\n\n# add formula\nc1.formula = 'a1+c2'\nc1.formula # '=a1+c2'\n\n# get neighbouring cells\nc2 = c1.neighbour('topright') # you can also specify relative position as tuple eg (1,1)\n\n# set cell format\nc1.set_number_format(pygsheets.formattype.number, '00.0000')\n\n# write notes on cell\nc1.note = \"yo mom\"\n\n# set cell color\nc1.color = (1.0, 1.0, 1.0, 1.0) # red, green, blue, alpha\n\n# set text format\nc1.text_format['fontsize'] = 14\nc1.set_text_format('bold', true)\n\n# sync the changes\n c1.update()\n\n# you can unlink a cell and set all required properties and then link it\n# so yu could create a model cell and update multiple sheets\nc.unlink()\nc.note = \"offine note\"\nc.link(wks1, true)\nc.link(wks2, true)\n\n```\n\n</details>\n\n### datarange object [doc](http://pygsheets.readthedocs.io/en/latest/datarange.html)\n\nthe datarange is used to represent a range of cells in a worksheet. they can be named or protected.\nalmost all `get_` functions has a `returnas` param, set it to `range` to get a range object.\n\n<details open> <summary>show code</summary>\n\n```python\n# getting a range object\nrng = wks.get_values('a1', 'c5', returnas='range')\nrng.start_addr = 'a' # make the range unbounded on rows <datarange sheet1!a:b>\ndrange.end_addr = none # make the range unbounded on both axes <datarange sheet1>\n\n# named ranges\nrng.name = 'pricesrange'  # will make this range a named range\nrng = wks.get_named_ranges('commoditycount') # directly get a named range\nrng.name = ''  # will delete this named range\n\n#protected ranges\nrng.protected = true\nrng.editors = ('users', 'someemail@gmail.com')\n\n# setting format\n # first create a model cell with required properties\nmodel_cell = cell('a1')\nmodel_cell.color = (1.0,0,1.0,1.0) # rose color cell\nmodel_cell.format = (pygsheets.formattype.percent, '')\n\n # setting format to multiple cells in one go\nrng.apply_format(model_cell)  # will make all cell in this range rose color and percent format\n# or if you just want to apply format, you can skip fetching data while creating datarange\ndatarange('a1','a10', worksheet=wks).apply_format(model_cell)\n\n# get cells in range\ncell = rng[0][1]\n\n```\n</details>\n\n### batching calls\n\nif you are calling a lot of spreadsheet modification functions (non value update). you can merge them into a single call.\nby doing so all the requests will be merged into a single call.\n\n```python\ngc.set_batch_mode(true)\nwks.merge_cells(\"a1\", \"a2\")\nwks.merge_cells(\"b1\", \"b2\")\ndatarange(\"d1\", \"d5\", wks).apply_format(cell)\ngc.run_batch() # all the above requests are executed here\ngc.set_batch_mode(false)\n\n```\nbatching also happens when you unlink worksheet. but in that case the requests are not merged.\n\n\n## how to contribute\n\nthis library is still in development phase.\n \n* follow the [contributing to open source](https://guides.github.com/activities/contributing-to-open-source/) guide.\n* branch off of the `staging` branch, and submit pull requests back to\n  that branch.  note that the `master` branch is used for version\n  bumps and hotfixes only.\n* for quick testing the changes you have made to source, run the file `tests/manual_testing.py`. it will give you an ipython shell with lastest code loaded.\n\n### report issues/features\n\n* please report bugs and suggest features via the [github issues](https://github.com/nithinmurali/pygsheets/issues).\n* before opening an issue, search the tracker for possible duplicates.\n* if you have any usage questions, ask a question on stackoverflow with `pygsheets` tag\n\n## run tests\n* install `pip install -r requirements-dev.txt`\n* run `make test`\n\nnow that you have scrolled all the way down, **finding this library useful?**  <a href=\"https://www.buymeacoffee.com/pygsheets\" target=\"_blank\"><img src=\"https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png\" alt=\"buy me a coffee\" style=\"height: auto !important;width: auto !important;\" ></a>\n\n\n",
  "docs_url": null,
  "keywords": "spreadsheets,google-spreadsheets,pygsheets",
  "license": "mit",
  "name": "pygsheets",
  "package_url": "https://pypi.org/project/pygsheets/",
  "project_url": "https://pypi.org/project/pygsheets/",
  "project_urls": {
    "Download": "https://github.com/nithinmurali/pygsheets/tarball/2.0.6",
    "Homepage": "https://github.com/nithinmurali/pygsheets"
  },
  "release_url": "https://pypi.org/project/pygsheets/2.0.6/",
  "requires_dist": [
    "google-api-python-client (>=2.50.0)",
    "google-auth-oauthlib (>=0.7.1)",
    "enum34 (>=1.1.6) ; python_version < \"3.4\"",
    "pandas (>=0.14.0) ; extra == 'pandas'"
  ],
  "requires_python": ">=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*",
  "summary": "google spreadsheets python api v4",
  "version": "2.0.6",
  "releases": [],
  "developers": [
    "imnmfotmal@gmail.com",
    "nithin_murali"
  ],
  "kwds": "pygsheets pygsheettest sheet sheet1 spreadsheets",
  "license_kwds": "mit",
  "libtype": "pypi",
  "id": "pypi_pygsheets",
  "homepage": "https://github.com/nithinmurali/pygsheets",
  "release_count": 17,
  "dependency_ids": [
    "pypi_enum34",
    "pypi_google_api_python_client",
    "pypi_google_auth_oauthlib",
    "pypi_pandas"
  ]
}