{
  "classifiers": [
    "license :: osi approved :: mit license",
    "operating system :: os independent",
    "programming language :: python :: 3"
  ],
  "description": "<p align=\"center\">\n\t<img align=\"center\" width=60% src=\"https://csinva.io/imodels/img/imodels_logo.svg?sanitize=true&kill_cache=1\"> </img>\t <br/>\n\tpython package for concise, transparent, and accurate predictive modeling. <br/>\n\tall sklearn-compatible and easy to use. <br/>\n\t<i> for interpretability in nlp, check out our new package: <a href=\"https://github.com/csinva/imodelsx\">imodelsx</a> </i>\n</p>\n<p align=\"center\">\n  <a href=\"https://csinva.github.io/imodels/\">\ud83d\udcda docs</a> \u2022\n  <a href=\"#demo-notebooks\">\ud83d\udcd6 demo notebooks</a>\n</p>\n<p align=\"center\">\n  <img src=\"https://img.shields.io/badge/license-mit-blue.svg\">\n  <img src=\"https://img.shields.io/badge/python-3.7--3.10-blue\">\n  <a href=\"https://doi.org/10.21105/joss.03192\"><img src=\"https://joss.theoj.org/papers/10.21105/joss.03192/status.svg\"></a>\n  <a href=\"https://github.com/csinva/imodels/actions\"><img src=\"https://github.com/csinva/imodels/workflows/tests/badge.svg\"></a>\n  <!--img src=\"https://img.shields.io/github/checks-status/csinva/imodels/master\"-->\n  <img src=\"https://img.shields.io/pypi/v/imodels?color=orange\">\n  <img src=\"https://static.pepy.tech/personalized-badge/imodels?period=total&units=none&left_color=gray&right_color=orange&left_text=downloads&kill_cache=12\">\n</p>  \n\n\n\n\n\n<img align=\"center\" width=100% src=\"https://csinva.io/imodels/img/anim.gif\"> </img>\n\nmodern machine-learning models are increasingly complex, often making them difficult to interpret. this package provides a simple interface for fitting and using state-of-the-art interpretable models, all compatible with scikit-learn. these models can often replace black-box models (e.g. random forests) with simpler models (e.g. rule lists) while improving interpretability and computational efficiency, all without sacrificing predictive accuracy! simply import a classifier or regressor and use the `fit` and `predict` methods, same as standard scikit-learn models.\n\n```python\nfrom sklearn.model_selection import train_test_split\nfrom imodels import get_clean_dataset, hstreeclassifiercv # import any imodels model here\n\n# prepare data (a sample clinical dataset)\nx, y, feature_names = get_clean_dataset('csi_pecarn_pred')\nx_train, x_test, y_train, y_test = train_test_split(\n    x, y, random_state=42)\n\n# fit the model\nmodel = hstreeclassifiercv(max_leaf_nodes=4)  # initialize a tree model and specify only 4 leaf nodes\nmodel.fit(x_train, y_train, feature_names=feature_names)   # fit model\npreds = model.predict(x_test) # discrete predictions: shape is (n_test, 1)\npreds_proba = model.predict_proba(x_test) # predicted probabilities: shape is (n_test, n_classes)\nprint(model) # print the model\n```\n\n```\n------------------------------\ndecision tree with hierarchical shrinkage\nprediction is made by looking at the value in the appropriate leaf of the tree\n------------------------------\n|--- focalneurofindings2 <= 0.50\n|   |--- highriskdiving <= 0.50\n|   |   |--- torticollis2 <= 0.50\n|   |   |   |--- value: [0.10]\n|   |   |--- torticollis2 >  0.50\n|   |   |   |--- value: [0.30]\n|   |--- highriskdiving >  0.50\n|   |   |--- value: [0.68]\n|--- focalneurofindings2 >  0.50\n|   |--- value: [0.42]\n```\n\n### installation\n\ninstall with `pip install imodels` (see [here](https://github.com/csinva/imodels/blob/master/docs/troubleshooting.md) for help).\n\n### supported models\n\n| model                       | reference                                                    | description                                                  |\n| :-------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |\n| rulefit rule set            | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/rule_set/rule_fit.html), [\ud83d\udd17](https://github.com/christophm/rulefit), [\ud83d\udcc4](http://statweb.stanford.edu/~jhf/ftp/rulefit.pdf) | fits a sparse linear model on rules extracted from decision trees |\n| skope rule set              | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/rule_set/skope_rules.html#imodels.rule_set.skope_rules.skoperulesclassifier), [\ud83d\udd17](https://github.com/scikit-learn-contrib/skope-rules) | extracts rules from gradient-boosted trees, deduplicates them,<br/>then linearly combines them based on their oob precision |\n| boosted rule set            | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/rule_set/boosted_rules.html), [\ud83d\udd17](https://github.com/jaimeps/adaboost-implementation), [\ud83d\udcc4](https://www.sciencedirect.com/science/article/pii/s002200009791504x) | sequentially fits a set of rules with adaboost           |\n| slipper rule set            | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/rule_set/slipper.html), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, \u3164\u3164[\ud83d\udcc4](https://www.aaai.org/papers/aaai/1999/aaai99-049.pdf) | sequentially learns a set of rules with slipper            |\n| bayesian rule set           | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/rule_set/brs.html#imodels.rule_set.brs.bayesianrulesetclassifier), [\ud83d\udd17](https://github.com/wangtongada/boa), [\ud83d\udcc4](https://www.jmlr.org/papers/volume18/16-003/16-003.pdf) | finds concise rule set with bayesian sampling (slow)  |\n| optimal rule list           | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/rule_list/corels_wrapper.html#imodels.rule_list.corels_wrapper.optimalrulelistclassifier), [\ud83d\udd17](https://github.com/corels/pycorels), [\ud83d\udcc4](https://www.jmlr.org/papers/volume18/17-716/17-716.pdf) | fits rule list using global optimization for sparsity (corels) |\n| bayesian rule list          | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/rule_list/bayesian_rule_list/bayesian_rule_list.html#imodels.rule_list.bayesian_rule_list.bayesian_rule_list.bayesianrulelistclassifier), [\ud83d\udd17](https://github.com/tmadl/sklearn-expertsys), [\ud83d\udcc4](https://arxiv.org/abs/1602.08610) | fits compact rule list distribution with bayesian sampling (slow) |\n| greedy rule list            | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/rule_list/greedy_rule_list.html), [\ud83d\udd17](https://medium.com/@penggongting/implementing-decision-tree-from-scratch-in-python-c732e7c69aea) | uses cart to fit a list (only a single path), rather than a tree |\n| oner rule list              | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/rule_list/one_r.html), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, [\ud83d\udcc4](https://link.springer.com/article/10.1023/a:1022631118932) | fits rule list restricted to only one feature              |\n| optimal rule tree           | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/tree/gosdt/pygosdt.html#imodels.tree.gosdt.pygosdt.optimaltreeclassifier), [\ud83d\udd17](https://github.com/jimmy-lin/generalizedoptimalsparsedecisiontrees), [\ud83d\udcc4](https://arxiv.org/abs/2006.08690) | fits succinct tree using global optimization for sparsity (gosdt) |\n| greedy rule tree            | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/tree/cart_wrapper.html), [\ud83d\udd17](https://scikit-learn.org/stable/modules/tree.html), [\ud83d\udcc4](https://www.taylorfrancis.com/books/mono/10.1201/9781315139470/classification-regression-trees-leo-breiman-jerome-friedman-richard-olshen-charles-stone) | greedily fits tree using cart                              |\n| c4.5 rule tree        | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/tree/c45_tree/c45_tree.html#imodels.tree.c45_tree.c45_tree.c45treeclassifier), [\ud83d\udd17](https://github.com/raczeq/scikit-learn-c4.5-tree-classifier), [\ud83d\udcc4](https://link.springer.com/article/10.1007/bf00993309) | greedily fits tree using c4.5                           |\n| tao rule tree        | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/tree/tao.html), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, \u3164\u3164[\ud83d\udcc4](https://proceedings.neurips.cc/paper/2018/hash/185c29dc24325934ee377cfda20e414c-abstract.html) | fits tree using alternating optimization                    |\n| iterative random<br/>forest | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/tree/iterative_random_forest/iterative_random_forest.html), [\ud83d\udd17](https://github.com/yu-group/iterative-random-forest), [\ud83d\udcc4](https://www.pnas.org/content/115/8/1943) | repeatedly fit random forest, giving features with<br/>high importance a higher chance of being selected |\n| sparse integer<br/>linear model | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/algebraic/slim.html), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, \u3164\u3164[\ud83d\udcc4](https://link.springer.com/article/10.1007/s10994-015-5528-6) | sparse linear model with integer coefficients                           |\n| tree gam | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/algebraic/tree_gam.html), [\ud83d\udd17](https://github.com/interpretml/interpret), [\ud83d\udcc4](https://dl.acm.org/doi/abs/10.1145/2339530.2339556) | generalized additive model fit with short boosted trees                           |\n| <b>greedy tree sums</b> | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/tree/figs.html#imodels.tree.figs), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, \u3164\u3164[\ud83d\udcc4](https://arxiv.org/abs/2201.11931) | sum of small trees with very few total rules (figs)                          |\n| <b>hierarchical<br/> shrinkage wrapper</b> | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/tree/hierarchical_shrinkage.html), &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, \u3164\u3164[\ud83d\udcc4](https://arxiv.org/abs/2202.00858) | improve a decision tree, random forest, or<br/>gradient-boosting ensemble with ultra-fast, post-hoc regularization |\n| distillation<br/>wrapper | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/util/distillation.html)  | train a black-box model,<br/>then distill it into an interpretable model |\n| automl wrapper | [\ud83d\uddc2\ufe0f](https://csinva.io/imodels/util/automl.html)  | automatically fit and select an interpretable model |\n| more models                 | \u231b                                                            | (coming soon!) lightweight rule induction, mlrules, ... |\n\n<p align=\"center\">\ndocs <a href=\"https://csinva.io/imodels/\">\ud83d\uddc2\ufe0f</a>, reference code implementation \ud83d\udd17, research paper \ud83d\udcc4\n</br>\n</p>\n\n## demo notebooks\n\ndemos are contained in the [notebooks](notebooks) folder.\n\n<details>\n<summary><a href=\"https://github.com/csinva/imodels/blob/master/notebooks/imodels_demo.ipynb\">quickstart demo</a></summary>\nshows how to fit, predict, and visualize with different interpretable models\n</details>\n\n<details>\n<summary><a href=\"https://auto.gluon.ai/dev/tutorials/tabular_prediction/tabular-interpretability.html\">autogluon demo</a></summary>\nfit/select an interpretable model automatically using autogluon automl\n</details>\n\n<details>\n<summary><a href=\"https://colab.research.google.com/drive/1wfqvsjegygt7p0gyqiwprpiwz2eptiao#scrollto=blnlkniuowtq\">quickstart colab demo</a> <a href=\"https://colab.research.google.com/drive/1wfqvsjegygt7p0gyqiwprpiwz2eptiao#scrollto=blnlkniuowtq\"> <img src=\"https://colab.research.google.com/assets/colab-badge.svg\"></a></summary>\nshows how to fit, predict, and visualize with different interpretable models\n</details>\n\n<details>\n<summary><a href=\"https://github.com/csinva/iai-clinical-decision-rule/blob/master/notebooks/05_fit_interpretable_models.ipynb\">clinical decision rule notebook</a></summary>\nshows an example of using <code>imodels</code> for deriving a clinical decision rule\n</details>\n\n<details>\n<summary>posthoc analysis</summary>\nwe also include some demos of posthoc analysis, which occurs after fitting models:\n<a href=\"https://github.com/csinva/imodels/blob/master/notebooks/posthoc_analysis.ipynb\">posthoc.ipynb</a> shows different simple analyses to interpret a trained model and \n<a href=\"https://github.com/csinva/imodels/blob/master/notebooks/uncertainty_analysis.ipynb\">uncertainty.ipynb</a> contains basic code to get uncertainty estimates for a model\n</details>\n\n## what's the difference between the models?\n\nthe final form of the above models takes one of the following forms, which aim to be simultaneously simple to understand and highly predictive:\n\n|                           rule set                           |                        rule list                        |                        rule tree                        |                       algebraic models                       |\n| :----------------------------------------------------------: | :-----------------------------------------------------: | :-----------------------------------------------------: | :----------------------------------------------------------: |\n| <img src=\"https://csinva.io/imodels/img/rule_set.jpg\" width=\"100%\"> | <img src=\"https://csinva.io/imodels/img/rule_list.jpg\"> | <img src=\"https://csinva.io/imodels/img/rule_tree.jpg\"> | <img src=\"https://csinva.io/imodels/img/algebraic_models.jpg\"> |\n\ndifferent models and algorithms vary not only in their final form but also in different choices made during modeling, such as how they generate, select, and postprocess rules:\n\n|                  rule candidate generation                   |                       rule selection                       |                rule postprocessing|\n| :----------------------------------------------------------: | :--------------------------------------------------------: | :-------------------------------------------------------: |\n| <img src=\"https://csinva.io/imodels/img/rule_candidates.jpg\"> | <img src=\"https://csinva.io/imodels/img/rule_overfit.jpg\"> | <img src=\"https://csinva.io/imodels/img/rule_pruned.jpg\"> |\n\n<details>\n<summary>ex. rulefit vs. skoperules</summary>\nrulefit and skoperules differ only in the way they prune rules: rulefit uses a linear model whereas skoperules heuristically deduplicates rules sharing overlap.\n</details>\n\n<details>\n<summary>ex. bayesian rule lists vs. greedy rule lists</summary>\nbayesian rule lists and greedy rule lists differ in how they select rules; bayesian rule lists perform a global optimization over possible rule lists while greedy rule lists pick splits sequentially to maximize a given criterion.\n</details>\n\n<details>\n<summary>ex. fpskope vs. skoperules</summary>\nfpskope and skoperules differ only in the way they generate candidate rules: fpskope uses fpgrowth whereas skoperules extracts rules from decision trees.\n</details>\n\n## support for different tasks\n\ndifferent models support different machine-learning tasks. current support for different models is given below (each of these models can be imported directly from imodels (e.g. `from imodels import rulefitclassifier`):\n\n| model                       |                    binary classification                     |                          regression                          | notes |\n| :-------------------------- | :----------------------------------------------------------: | :----------------------------------------------------------: | --------------------------- |\n| rulefit rule set            | [rulefitclassifier](https://csinva.io/imodels/rule_set/rule_fit.html#imodels.rule_set.rule_fit.rulefitclassifier) | [rulefitregressor](https://csinva.io/imodels/rule_set/rule_fit.html#imodels.rule_set.rule_fit.rulefitregressor) |  |\n| skope rule set              | [skoperulesclassifier](https://csinva.io/imodels/rule_set/skope_rules.html#imodels.rule_set.skope_rules.skoperulesclassifier) |                                                              |  |\n| boosted rule set            | [boostedrulesclassifier](https://csinva.io/imodels/rule_set/boosted_rules.html#imodels.rule_set.boosted_rules.boostedrulesclassifier) | [boostedrulesregressor](https://csinva.io/imodels/rule_set/boosted_rules.html#imodels.rule_set.boosted_rules.boostedrulesregressor) |  |\n| slipper rule set            | [slipperclassifier](https://csinva.io/imodels/rule_set/slipper.html#imodels.rule_set.slipper.slipperclassifier) |                                                              |  |\n| bayesian rule set           | [bayesianrulesetclassifier](https://csinva.io/imodels/rule_set/brs.html#imodels.rule_set.brs.bayesianrulesetclassifier) |                                                              | fails for large problems |\n| optimal rule list (corels)  | [optimalrulelistclassifier](https://csinva.io/imodels/rule_list/corels_wrapper.html#imodels.rule_list.corels_wrapper.optimalrulelistclassifier) |                                                              | requires [corels](https://pypi.org/project/corels/), fails for large problems |\n| bayesian rule list          | [bayesianrulelistclassifier](https://csinva.io/imodels/rule_list/bayesian_rule_list/bayesian_rule_list.html#imodels.rule_list.bayesian_rule_list.bayesian_rule_list.bayesianrulelistclassifier) |                                                              |  |\n| greedy rule list            | [greedyrulelistclassifier](https://csinva.io/imodels/rule_list/greedy_rule_list.html#imodels.rule_list.greedy_rule_list.greedyrulelistclassifier) |                                                              |  |\n| oner rule list              | [onerclassifier](https://csinva.io/imodels/rule_list/one_r.html#imodels.rule_list.one_r.onerclassifier) |                                                              |  |\n| optimal rule tree (gosdt)   | [optimaltreeclassifier](https://csinva.io/imodels/tree/gosdt/pygosdt.html#imodels.tree.gosdt.pygosdt.optimaltreeclassifier) |                                                              | requires [gosdt](https://pypi.org/project/gosdt/), fails for large problems |\n| greedy rule tree (cart)     | [greedytreeclassifier](https://csinva.io/imodels/tree/cart_wrapper.html#imodels.tree.cart_wrapper.greedytreeclassifier) |      [greedytreeregressor](https://csinva.io/imodels/tree/cart_wrapper.html#imodels.tree.cart_wrapper.greedytreeregressor)                                                        |  |\n| c4.5 rule tree              | [c45treeclassifier](https://csinva.io/imodels/tree/c45_tree/c45_tree.html#imodels.tree.c45_tree.c45_tree.c45treeclassifier) |           |  |\n| tao rule tree              | [taotreeclassifier](https://csinva.io/imodels/tree/tao.html#imodels.tree.tao.taotreeclassifier) |   [taotreeregressor](https://csinva.io/imodels/tree/tao.html#imodels.tree.tao.taotreeregressor)        |  |\n| iterative random forest     | [irfclassifier](https://csinva.io/imodels/tree/iterative_random_forest/iterative_random_forest.html#imodels.tree.iterative_random_forest.iterative_random_forest.irfclassifier)                                                             |                                                              | requires [irf](https://pypi.org/project/irf/) |\n| sparse integer linear model | [slimclassifier](https://csinva.io/imodels/algebraic/slim.html#imodels.algebraic.slim.slimclassifier) | [slimregressor](https://csinva.io/imodels/algebraic/slim.html#imodels.algebraic.slim.slimregressor) | requires extra dependencies for speed |\n| tree gam | [treegamclassifier](https://csinva.io/imodels/algebraic/tree_gam.html) | [treegamregressor](https://csinva.io/imodels/algebraic/tree_gam.html) | |\n| greedy tree sums (figs) | [figsclassifier](https://csinva.io/imodels/tree/figs.html#imodels.tree.figs.figsclassifier) | [figsregressor](https://csinva.io/imodels/tree/figs.html#imodels.tree.figs.figsregressor) |                                                              |\n| hierarchical shrinkage | [hstreeclassifiercv](https://csinva.io/imodels/tree/hierarchical_shrinkage.html#imodels.tree.hierarchical_shrinkage.hstreeclassifiercv) | [hstreeregressorcv](https://csinva.io/imodels/tree/hierarchical_shrinkage.html#imodels.tree.hierarchical_shrinkage.hstreeregressorcv) | wraps any sklearn tree-based model |\n| distillation |  | [distilledregressor](https://csinva.io/imodels/util/distillation.html#imodels.util.distillation.distilledregressor) | wraps any sklearn-compatible models |\n| automl model | [autointerpretableclassifier\ufe0f](https://csinva.io/imodels/util/automl.html)  | [autointerpretableregressor\ufe0f](https://csinva.io/imodels/util/automl.html) | |\n\n\n### extras\n\n<details>\n<summary><a href=\"https://csinva.io/imodels/util/data_util.html#imodels.util.data_util.get_clean_dataset\">data-wrangling functions</a> for working with popular tabular datasets (e.g. compas).</summary>\nthese functions, in conjunction with <a href=\"https://github.com/csinva/imodels-data\">imodels-data</a> and <a href=\"https://github.com/yu-group/imodels-experiments\">imodels-experiments</a>, make it simple to download data and run experiments on new models.\n</details>\n\n<details>\n<summary><a href=\"https://csinva.io/imodels/util/explain_errors.html\">explain classification errors</a> with a simple posthoc function.</summary>\nfit an interpretable model to explain a previous model's errors (ex. in <a href=\"https://github.com/csinva/imodels/blob/master/notebooks/error_detection_demo.ipynb\">this notebook\ud83d\udcd3</a>).\n</details>\n\n<details>\n<summary><a href=\"https://csinva.io/imodels/discretization/index.html\">fast and effective discretizers</a> for data preprocessing.</summary>\n<table>\n<thead>\n<tr>\n<th>discretizer</th>\n<th>reference</th>\n<th>description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>mdlp</td>\n<td><a href=\"https://csinva.io/imodels/discretization/mdlp.html#imodels.discretization.mdlp.mdlpdiscretizer\">\ud83d\uddc2\ufe0f</a>, <a href=\"https://github.com/navicto/discretization-mdlpc\">\ud83d\udd17</a>, <a href=\"https://trs.jpl.nasa.gov/handle/2014/35171\">\ud83d\udcc4</a></td>\n<td>discretize using entropy minimization heuristic</td>\n</tr>\n<tr>\n<td>simple</td>\n<td><a href=\"https://csinva.io/imodels/discretization/simple.html#imodels.discretization.simple.simplediscretizer\">\ud83d\uddc2\ufe0f</a>, <a href=\"https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.kbinsdiscretizer.html\">\ud83d\udd17</a></td>\n<td>simple kbins discretization</td>\n</tr>\n<tr>\n<td>random forest</td>\n<td><a href=\"https://csinva.io/imodels/discretization/discretizer.html#imodels.discretization.discretizer.rfdiscretizer\">\ud83d\uddc2\ufe0f</a></td>\n<td>discretize into bins based on random forest split popularity</td>\n</tr>\n</tbody>\n</table>\n</details>\n\n<details>\n<summary><a href=\"https://csinva.io/imodels/util/index.html\">rule-based utils</a> for customizing models</summary>\nthe code here contains many useful and customizable functions for rule-based learning in the <a href=\"https://csinva.io/imodels/util/index.html\">util folder</a>. this includes functions / classes for rule deduplication, rule screening, and converting between trees, rulesets, and neural networks.\n</details>\n\n## our favorite models\n\nafter developing and playing with `imodels`, we developed a few new models to overcome limitations of existing interpretable models.\n\n### figs: fast interpretable greedy-tree sums\n\n[\ud83d\udcc4 paper](https://arxiv.org/abs/2201.11931), [\ud83d\udd17 post](https://csinva.io/imodels/figs.html), [\ud83d\udccc citation](https://scholar.google.com/scholar?hl=en&as_sdt=0%2c5&q=fast+interpretable+greedy-tree+sums&oq=fast#d=gs_cit&u=%2fscholar%3fq%3dinfo%3adnpvl74rop0j%3ascholar.google.com%2f%26output%3dcite%26scirp%3d0%26hl%3den)\n\nfast interpretable greedy-tree sums (figs) is an algorithm for fitting concise rule-based models. specifically, figs generalizes cart to simultaneously grow a flexible number of trees in a summation. the total number of splits across all the trees can be restricted by a pre-specified threshold, keeping the model interpretable. experiments across a wide array of real-world datasets show that figs achieves state-of-the-art prediction performance when restricted to just a few splits (e.g. less than 20).\n\n<p align=\"center\">\n\t<img src=\"https://demos.csinva.io/figs/diabetes_figs.svg?sanitize=true\" width=\"50%\">\n</p>  \n<p align=\"center\">\t\n\t<i><b>example figs model.</b> figs learns a sum of trees with a flexible number of trees; to make its prediction, it sums the result from each tree.</i>\n</p>\n\n### hierarchical shrinkage: post-hoc regularization for tree-based methods\n\n[\ud83d\udcc4 paper](https://arxiv.org/abs/2202.00858) (icml 2022), [\ud83d\udd17 post](https://csinva.io/imodels/shrinkage.html), [\ud83d\udccc citation](https://scholar.google.com/scholar?hl=en&as_sdt=0%2c5&q=hierarchical+shrinkage+singh&btng=&oq=hierar#d=gs_cit&u=%2fscholar%3fq%3dinfo%3azc6gtlx-al4j%3ascholar.google.com%2f%26output%3dcite%26scirp%3d0%26hl%3den)\n\nhierarchical shrinkage is an extremely fast post-hoc regularization method which works on any decision tree (or tree-based ensemble, such as random forest). it does not modify the tree structure, and instead regularizes the tree by shrinking the prediction over each node towards the sample means of its ancestors (using a single regularization parameter). experiments over a wide variety of datasets show that hierarchical shrinkage substantially increases the predictive performance of individual decision trees and decision-tree ensembles.\n\n<p align=\"center\">\n\t<img src=\"https://demos.csinva.io/shrinkage/shrinkage_intro.svg?sanitize=true\" width=\"75%\">\n</p>  \n<p align=\"center\">\t\n\t<i><b>hs example.</b> hs applies post-hoc regularization to any decision tree by shrinking each node towards its parent.</i>\n</p>\n\n### mdi+: flexible tree-based feature importance\n\n[\ud83d\udcc4 paper](https://arxiv.org/pdf/2307.01932.pdf), [\ud83d\udccc citation](https://scholar.google.com/scholar?hl=en&as_sdt=0%2c23&q=mdi%2b%3a+a+flexible+random+forest-based+feature+importance+framework&btng=#d=gs_cit&t=1690399844081&u=%2fscholar%3fq%3dinfo%3axc0lchxe_luj%3ascholar.google.com%2f%26output%3dcite%26scirp%3d0%26hl%3den)\n\nmdi+ is a novel feature importance framework, which generalizes the popular mean decrease in impurity (mdi) importance score for random forests. at its core, mdi+ expands upon a recently discovered connection between linear regression and decision trees. in doing so, mdi+ enables practitioners to (1) tailor the feature importance computation to the data/problem structure and (2) incorporate additional features or knowledge to mitigate known biases of decision trees. in both real data case studies and extensive real-data-inspired simulations, mdi+ outperforms commonly used feature importance measures (e.g., mdi, permutation-based scores, and treeshap) by substantional margins.\n\n\n## references\n\n<details>\n<summary>readings</summary>\n<ul>\n  <li>interpretable ml good quick overview: murdoch et al. 2019, <a href=\"https://arxiv.org/pdf/1901.04592.pdf\">pdf</a></li>\n\t<li>interpretable ml book: molnar 2019, <a href=\"https://christophm.github.io/interpretable-ml-book/\">pdf</a></li>\n\t<li>case for interpretable models rather than post-hoc explanation: rudin 2019, <a href=\"https://arxiv.org/pdf/1811.10154.pdf\">pdf</a></li>\n\t<li>review on evaluating interpretability: doshi-velez & kim 2017, <a href=\"https://arxiv.org/pdf/1702.08608.pdf\">pdf</a></li>\t\n</ul>\n</details>\n\n<details>\n<summary>reference implementations (also linked above)</summary>\nthe code here heavily derives from the wonderful work of previous projects. we seek to to extract out, unify, and maintain key parts of these projects.\n<ul>\n  <li><a href=\"https://github.com/corels/pycorels\">pycorels</a> - by <a href=\"https://github.com/fingoldin\">@fingoldin</a> and the <a href=\"https://github.com/corels/corels\">original corels team</a>\n  <li><a href=\"https://github.com/tmadl/sklearn-expertsys\">sklearn-expertsys</a> - by <a href=\"https://github.com/tmadl\">@tmadl</a> and <a href=\"https://github.com/kenben\">@kenben</a> based on original code by <a href=\"http://lethalletham.com/\">ben letham</a></li>\n  <li><a href=\"https://github.com/christophm/rulefit\">rulefit</a> - by <a href=\"https://github.com/christophm\">@christophm</a></li>\n  <li><a href=\"https://github.com/scikit-learn-contrib/skope-rules\">skope-rules</a> - by the <a href=\"https://github.com/scikit-learn-contrib/skope-rules/blob/master/authors.rst\">skope-rules team</a> (including <a href=\"https://github.com/ngoix\">@ngoix</a>, <a href=\"https://github.com/floriangardin\">@floriangardin</a>, <a href=\"https://github.com/datajms\">@datajms</a>, <a href=\"\">bibi ndiaye</a>, <a href=\"\">ronan gautier</a>)</li>\n  <li><a href=\"https://github.com/wangtongada/boa\">boa</a> - by <a href=\"https://github.com/wangtongada\">@wangtongada</a></li>\t\n</ul>\n</details>\n\n<details>\n<summary>related packages</summary>\n<ul>\n  <li><a href=\"https://github.com/trevorstephens/gplearn/tree/ad57cb18caafdb02cca861aea712f1bf3ed5016e\">gplearn</a>: symbolic regression/classification</li>\n  <li><a href=\"https://github.com/milescranmer/pysr\">pysr</a>: fast symbolic regression</li>\n  <li><a href=\"https://github.com/dswah/pygam\">pygam</a>: generative additive models</li>\n  <li><a href=\"https://github.com/interpretml/interpret\">interpretml</a>: boosting-based gam</li>\n  <li><a href=\"https://github.com/h2oai/h2o-3\">h20 ai</a>: gams + glms (and more)</li>\n  <li><a href=\"https://github.com/guillermo-navas-palencia/optbinning\">optbinning</a>: data discretization / scoring models</li>\t\n</ul>\n</details>\n\n<details>\n<summary>updates</summary>\n<ul>\n  <li>for updates, star the repo, <a href=\"https://github.com/csinva/csinva.github.io\">see this related repo</a>, or follow <a href=\"https://twitter.com/csinva_\">@csinva_</a></li>\n  <li>please make sure to give authors of original methods / base implementations appropriate credit!</li>\n  <li>contributing: pull requests <a href=\"https://github.com/csinva/imodels/blob/master/docs/contributing.md\">very welcome</a>!</li>\n</ul>\n</details>\n\n\nif it's useful for you, please star/cite the package, and make sure to give authors of original methods / base implementations credit:\n\n```r\n@software{\nimodels2021,\ntitle        = {imodels: a python package for fitting interpretable models},\njournal      = {journal of open source software},\npublisher    = {the open journal},\nyear         = {2021},\nauthor       = {singh, chandan and nasseri, keyan and tan, yan shuo and tang, tiffany and yu, bin},\nvolume       = {6},\nnumber       = {61},\npages        = {3192},\ndoi          = {10.21105/joss.03192},\nurl          = {https://doi.org/10.21105/joss.03192},\n}\n\n```\n",
  "docs_url": null,
  "keywords": "",
  "license": "",
  "name": "imodels",
  "package_url": "https://pypi.org/project/imodels/",
  "project_url": "https://pypi.org/project/imodels/",
  "project_urls": {
    "Homepage": "https://github.com/csinva/imodels"
  },
  "release_url": "https://pypi.org/project/imodels/1.4.1/",
  "requires_dist": [
    "matplotlib",
    "mlxtend (>=0.18.0)",
    "numpy",
    "pandas",
    "requests",
    "scipy",
    "scikit-learn",
    "tqdm",
    "dvu ; extra == 'dev'",
    "gdown ; extra == 'dev'",
    "jupyter ; extra == 'dev'",
    "jupytext ; extra == 'dev'",
    "matplotlib ; extra == 'dev'",
    "pytest ; extra == 'dev'",
    "pytest-cov ; extra == 'dev'",
    "slurmpy ; extra == 'dev'",
    "tqdm ; extra == 'dev'",
    "pmlb ; extra == 'dev'"
  ],
  "requires_python": ">=3.6",
  "summary": "implementations of various interpretable models",
  "version": "1.4.1",
  "releases": [],
  "developers": [
    "chandan_singh",
    "chandan_singh@berkeley.edu"
  ],
  "kwds": "python scikit pysr sklearn html",
  "license_kwds": "",
  "libtype": "pypi",
  "id": "pypi_imodels",
  "homepage": "https://github.com/csinva/imodels",
  "release_count": 45,
  "dependency_ids": [
    "pypi_dvu",
    "pypi_gdown",
    "pypi_jupyter",
    "pypi_jupytext",
    "pypi_matplotlib",
    "pypi_mlxtend",
    "pypi_numpy",
    "pypi_pandas",
    "pypi_pmlb",
    "pypi_pytest",
    "pypi_pytest_cov",
    "pypi_requests",
    "pypi_scikit_learn",
    "pypi_scipy",
    "pypi_slurmpy",
    "pypi_tqdm"
  ]
}