{
  "classifiers": [
    "development status :: 4 - beta",
    "intended audience :: developers",
    "license :: osi approved :: mit license",
    "programming language :: python",
    "programming language :: python :: 2",
    "programming language :: python :: 2.7",
    "programming language :: python :: 3",
    "programming language :: python :: 3.10",
    "programming language :: python :: 3.11",
    "programming language :: python :: 3.5",
    "programming language :: python :: 3.6",
    "programming language :: python :: 3.7",
    "programming language :: python :: 3.8",
    "programming language :: python :: 3.9",
    "topic :: internet :: www/http",
    "topic :: software development :: libraries"
  ],
  "description": "# about\nmicrosoft 365 & microsoft graph library for python\n\n# usage\n\n1. [installation](#installation)\n2. [working with sharepoint api](#working-with-sharepoint-api) \n3. [working with outlook api](#working-with-outlook-api) \n4. [working with onedrive and sharepoint api v2 apis](#working-with-onedrive-and-sharepoint-v2-apis)\n5. [working with teams api](#working-with-microsoft-teams-api)\n6. [working with onenote api](#working-with-microsoft-onenote-api)\n7. [working with planner api](#working-with-microsoft-planner-api)  \n\n## status\n[![downloads](https://pepy.tech/badge/office365-rest-python-client/month)](https://pepy.tech/project/office365-rest-python-client)\n[![pypi](https://img.shields.io/pypi/v/office365-rest-python-client.svg)](https://pypi.python.org/pypi/office365-rest-python-client)\n[![pypi pyversions](https://img.shields.io/pypi/pyversions/office365-rest-python-client.svg)](https://pypi.python.org/pypi/office365-rest-python-client/)\n[![build status](https://travis-ci.com/vgrem/office365-rest-python-client.svg?branch=master)](https://travis-ci.com/vgrem/office365-rest-python-client)\n\n# installation\n\nuse pip:\n\n```\npip install office365-rest-python-client\n```\n\n### note \n>\n\n>alternatively the _latest_ version could be directly installed via github:\n>```\n>pip install git+https://github.com/vgrem/office365-rest-python-client.git\n>```\n\n# authentication\nfor the following examples, relevant credentials can be found in the azure portal.\n\nsteps to access:\n1. login to the home page of the azure portal\n2. navigate to \"azure active directory\" using the three bars in the top right corner of the portal\n3. select \"app registrations\" in the navigation panel on the left\n4. search for and select your relevant application\n5. in the application's \"overview\" page, the client id can be found under \"application (client) id\"\n6. in the application's \"certificates & secrets\" page, the client secret can be found under the \"value\" of the \"client secrets.\" if there is no client secret yet, create one here.\n\n\n# working with sharepoint api\n\n   the `clientcontext` client provides the support for a legacy sharepoint rest and onedrive for business rest apis, \n   the list of supported versions: \n   -   [sharepoint 2013 rest api](https://msdn.microsoft.com/en-us/library/office/jj860569.aspx) and above \n   -   [sharepoint online rest api](https://learn.microsoft.com/en-us/sharepoint/dev/sp-add-ins/get-to-know-the-sharepoint-rest-service)\n   -   onedrive for business rest api\n\n### authentication\n\n   the following auth flows are supported:\n\n#### 1. using a sharepoint app-only principal (client credentials flow)\n\n   this auth method is compatible with sharepoint on-premises and still relevant \n   model in both sharepoint on-premises as sharepoint online, \n   the following methods are available: \n\n   - `clientcontext.with_credentials(client_credentials)` \n   - `clientcontext.with_client_credentials(client_id, client_secret)`\n  \n   usage:\n   ``` \n   client_credentials = clientcredential('{client_id}','{client_secret}')\n   ctx = clientcontext('{url}').with_credentials(client_credentials)\n   ```\n  \n   documentation:\n   - [granting access using sharepoint app-only](https://docs.microsoft.com/en-us/sharepoint/dev/solution-guidance/security-apponly-azureacs)  \n   - [wiki](https://github.com/vgrem/office365-rest-python-client/wiki/how-to-connect-to-sharepoint-online-and-and-sharepoint-2013-2016-2019-on-premises--with-app-principal)\n  \n   example: [connect_with_app_principal.py](examples/sharepoint/connect_with_app_only_principal.py)\n  \n#### 2. using username and password \n\n   usage:\n   ``` \n   user_credentials = usercredential('{username}','{password}')\n   ctx = clientcontext('{url}').with_credentials(user_credentials)\n   ```\n  \n   example: [connect_with_user_credential.py](examples/sharepoint/connect_with_user_credential.py)\n  \n#### 3. using an azure ad application (certificate credentials flow) \n\n  documentation: \n   - [granting access via azure ad app-only](https://docs.microsoft.com/en-us/sharepoint/dev/solution-guidance/security-apponly-azuread)  \n   - [wiki](https://github.com/vgrem/office365-rest-python-client/wiki/how-to-connect-to-sharepoint-online-with-certificate-credentials) \n  \n  example: [connect_with_client_certificate.py](examples/sharepoint/connect_with_client_certificate.py)\n\n#### 4. interactive\n\n   to login interactively i.e. via a local browser\n\n   prerequisite: \n   \n   > in azure portal, configure the redirect uri of your\n   \"mobile and desktop application\" as ``http://localhost``.\n\n  example: [connect_interactive.py](examples/sharepoint/connect_interactive.py)\n\n  usage:\n```python\nfrom office365.sharepoint.client_context import clientcontext\nctx = clientcontext(site_url).with_interactive(tenant_name_or_id, client_id)\nme = ctx.web.current_user.get().execute_query()\nprint(me.login_name)\n```\n\n### examples\n \nthere are **two approaches** available to perform api queries:\n\n1. `clientcontext class` - where you target sharepoint resources such as `web`, `listitem` and etc (recommended)\n \n```python\nfrom office365.runtime.auth.user_credential import usercredential\nfrom office365.sharepoint.client_context import clientcontext\nsite_url = \"https://{your-tenant-prefix}.sharepoint.com\"\nctx = clientcontext(site_url).with_credentials(usercredential(\"{username}\", \"{password}\"))\nweb = ctx.web\nctx.load(web)\nctx.execute_query()\nprint(\"web title: {0}\".format(web.properties['title']))\n```\nor alternatively via method chaining (a.k.a fluent interface): \n\n```python\nfrom office365.runtime.auth.user_credential import usercredential\nfrom office365.sharepoint.client_context import clientcontext\nsite_url = \"https://{your-tenant-prefix}.sharepoint.com\"\nctx = clientcontext(site_url).with_credentials(usercredential(\"{username}\", \"{password}\"))\nweb = ctx.web.get().execute_query()\nprint(\"web title: {0}\".format(web.properties['title']))\n```\n\n\n2. `requestoptions class` - where you construct rest queries (and no model is involved)\n\n   the example demonstrates how to read `web` properties:\n   \n```python\nimport json\nfrom office365.runtime.auth.user_credential import usercredential\nfrom office365.runtime.http.request_options import requestoptions\nfrom office365.sharepoint.client_context import clientcontext\nsite_url = \"https://{your-tenant-prefix}.sharepoint.com\"\nctx = clientcontext(site_url).with_credentials(usercredential(\"{username}\", \"{password}\"))\nrequest = requestoptions(\"{0}/_api/web/\".format(site_url))\nresponse = ctx.pending_request().execute_request_direct(request)\njson = json.loads(response.content)\nweb_title = json['d']['title']\nprint(\"web title: {0}\".format(web_title))\n```\n\nthe list of examples:\n\n- working with files\n  - [download a file](examples/sharepoint/files/download.py) \n  - [upload a file](examples/sharepoint/files/upload.py)\n\n- working with lists and list items\n  -  [create a list item](examples/sharepoint/lists/data_generator.py)\n  -  [read a list item](examples/sharepoint/lists/read_large.py)   \n  -  [update a list item](examples/sharepoint/listitems/update_batch.py)\n  -  [delete a list item](examples/sharepoint/listitems/delete.py) \n  \nrefer [examples section](examples/sharepoint) for another scenarios\n\n# working with outlook api\n\nthe list of supported apis:\n-   [outlook contacts rest api](https://msdn.microsoft.com/en-us/office/office365/api/contacts-rest-operations)\n-   [outlook calendar rest api](https://msdn.microsoft.com/en-us/office/office365/api/calendar-rest-operations)\n-   [outlook mail rest api](https://msdn.microsoft.com/en-us/office/office365/api/mail-rest-operations)\n\n\nsince outlook rest apis are available in both microsoft graph and the outlook api endpoint, \nthe following clients are available:\n\n- `graphclient` which targets outlook api `v2.0` version (*preferable* nowadays, refer [transition to microsoft graph-based outlook rest api](https://docs.microsoft.com/en-us/outlook/rest/compare-graph-outlook) for a details)   \n~~- `outlookclient` which targets outlook api `v1.0` version (not recommended for usage since `v1.0` version is being deprecated.)~~\n\n\n### authentication\n\n[the microsoft authentication library (msal) for python](https://pypi.org/project/msal/) which comes as a dependency \nis used as a default library to obtain tokens to call microsoft graph api. \n\nusing [microsoft authentication library (msal) for python](https://pypi.org/project/msal/)\n\n> note: access token is getting acquired via [client credential flow](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow)\n> in the provided examples. other forms of token acquisition can be found here: https://msal-python.readthedocs.io/en/latest/\n\n```python\nimport msal\nfrom office365.graph_client import graphclient\n\ndef acquire_token():\n    \"\"\"\n    acquire token via msal\n    \"\"\"\n    authority_url = 'https://login.microsoftonline.com/{tenant_id_or_name}'\n    app = msal.confidentialclientapplication(\n        authority=authority_url,\n        client_id='{client_id}',\n        client_credential='{client_secret}'\n    )\n    token = app.acquire_token_for_client(scopes=[\"https://graph.microsoft.com/.default\"])\n    return token\n\n\nclient = graphclient(acquire_token)\n\n```\n\nbut in terms of microsoft graph api authentication, another oauth spec compliant libraries \nsuch as [adal](https://github.com/azuread/azure-activedirectory-library-for-python) \nare supported as well.   \n\nusing [adal python](https://adal-python.readthedocs.io/en/latest/#)\n\nusage\n\n```python\nimport adal\nfrom office365.graph_client import graphclient\n\ndef acquire_token_func():\n    authority_url = 'https://login.microsoftonline.com/{tenant_id_or_name}'\n    auth_ctx = adal.authenticationcontext(authority_url)\n    token = auth_ctx.acquire_token_with_client_credentials(\n        \"https://graph.microsoft.com\",\n        \"{client_id}\",\n        \"{client_secret}\")\n    return token\n\nclient = graphclient(acquire_token_func)\n\n```\n\n#### example\n\nthe example demonstrates how to send an email via [microsoft graph endpoint](https://docs.microsoft.com/en-us/graph/api/user-sendmail?view=graph-rest-1.0&tabs=http).\n\n> note: access token is getting acquired  via [client credential flow](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow)\n\n```python\nfrom office365.graph_client import graphclient\n\nclient = graphclient(acquire_token_func)\n\nclient.me.send_mail(\n    subject=\"meet for lunch?\",\n    body=\"the new cafeteria is open.\",\n    to_recipients=[\"fannyd@contoso.onmicrosoft.com\"]\n).execute_query()\n\n```\n\n\nadditional examples & scenarios:\n\n-  [download a message](examples/outlook/messages/download.py) \n-  [list messages](examples/outlook/messages/list_all.py)\n-  [move messages to a different folder](examples/outlook/messages/move.py)\n-  [search messages](examples/outlook/messages/search.py)   \n-  [send messages](examples/outlook/messages/send.py)\n-  [send messages with attachments](examples/outlook/messages/send_with_attachment.py) \n-  [enable sending emails on behalf of another user in your organization](https://learn.microsoft.com/en-us/microsoft-365/solutions/allow-members-to-send-as-or-send-on-behalf-of-group)\n\nrefer to [examples section](examples/outlook) for other scenarios\n\n\n# working with onedrive and sharepoint v2 apis\n\n#### documentation \n\n[onedrive graph api reference](https://docs.microsoft.com/en-us/graph/api/resources/onedrive?view=graph-rest-1.0)\n\n#### authentication\n\n[the microsoft authentication library (msal) for python](https://pypi.org/project/msal/) which comes as a dependency \nis used to obtain token\n\n```python\nimport msal\n\ndef acquire_token_func():\n    \"\"\"\n    acquire token via msal\n    \"\"\"\n    authority_url = 'https://login.microsoftonline.com/{tenant_id_or_name}'\n    app = msal.confidentialclientapplication(\n        authority=authority_url,\n        client_id='{client_id}',\n        client_credential='{client_secret}'\n    )\n    token = app.acquire_token_for_client(scopes=[\"https://graph.microsoft.com/.default\"])\n    return token\n``` \n\n\n#### examples \n\n##### example: list available drives\n\nthe example demonstrates how to enumerate and print drive's url \nwhich corresponds to [`list available drives` endpoint](https://docs.microsoft.com/en-us/onedrive/developer/rest-api/api/drive_list?view=odsp-graph-online)\n\n> note: access token is getting acquired  via [client credential flow](https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow)\n\n```python\nfrom office365.graph_client import graphclient\n\ntenant_name = \"contoso.onmicrosoft.com\"\nclient = graphclient(acquire_token_func)\ndrives = client.drives.get().execute_query()\nfor drive in drives:\n    print(\"drive url: {0}\".format(drive.web_url))\n```\n\n\n##### example: download the contents of a driveitem(folder facet)\n\n```python\nfrom office365.graph_client import graphclient\nclient = graphclient(acquire_token_func)\n# retrieve drive properties \ndrive = client.users[\"{user_id_or_principal_name}\"].drive.get().execute_query()\n# download files from onedrive into local folder \nwith tempfile.temporarydirectory() as path:\n    download_files(drive.root, path)\n```\n\nwhere\n\n```python\ndef download_files(remote_folder, local_path):\n    drive_items = remote_folder.children.get().execute_query()\n    for drive_item in drive_items:\n        if drive_item.file is not none:  # is file?\n            # download file content\n            with open(os.path.join(local_path, drive_item.name), 'wb') as local_file:\n                drive_item.download(local_file).execute_query()\n```\n\nadditional examples:\n\n-  [create list column](examples/onedrive/columns/create_text.py) \n-  [download file](examples/onedrive/files/download.py)\n-  [export files](examples/onedrive/files/export.py)\n-  [upload folder](examples/onedrive/folders/upload.py)   \n-  [list drives](examples/onedrive/drives/list.py)\n-  [list files](examples/onedrive/folders/list_files.py)\n\nrefer to [onedrive examples section](examples/onedrive) for more examples.\n\n\n# working with microsoft teams api\n\n#### authentication\n\n[the microsoft authentication library (msal) for python](https://pypi.org/project/msal/) which comes as a dependency \nis used to obtain token  \n\n#### examples \n\n##### example: create a new team under a group\n\nthe example demonstrates how create a new team under a group \nwhich corresponds to [`create team` endpoint](https://docs.microsoft.com/en-us/graph/api/team-put-teams?view=graph-rest-1.0&tabs=http)\n\n```python\nfrom office365.graph_client import graphclient\nclient = graphclient(acquire_token_func)\nnew_team = client.groups[\"{group_id}\"].add_team().execute_query_retry()\n```\n\nadditional examples:\n\n-  [create a team](examples/teams/create_team.py) \n-  [create team from group](examples/teams/create_from_group.py)\n-  [list all teams](examples/teams/list_all.py)\n-  [list my teams](examples/teams/list_my_teams.py)   \n-  [send messages](examples/teams/send_message.py)\n  \nrefer to [examples section](examples/teams) for other scenarios\n\n# working with microsoft onenote api\n\nthe library supports onenote api in terms of calls to a user's onenote notebooks, sections, and pages in a personal or organization account\n\nexample: create a new page\n\n```python\nfrom office365.graph_client import graphclient\nclient = graphclient(acquire_token_func)\n\nfiles = {}\nwith open(\"./mypage.html\", 'rb') as f, \\\n    open(\"./myimage.png\", 'rb') as img_f, \\\n    open(\"./mydoc.pdf\", 'rb') as pdf_f:\n    files[\"imageblock1\"] = img_f\n    files[\"fileblock1\"] = pdf_f\n    page = client.me.onenote.pages.add(presentation_file=f, attachment_files=files).execute_query()\n```\n\n# working with microsoft planner api\n\nthe example demonstrates how to create a new planner task\nwhich corresponds to [`create plannertask` endpoint](https://docs.microsoft.com/en-us/graph/api/planner-post-tasks?view=graph-rest-1.0):\n\n```python\nfrom office365.graph_client import graphclient\n\nclient = graphclient(acquire_token_func)\ntask = client.planner.tasks.add(title=\"new task\", planid=\"--plan id goes here--\").execute_query()\n```\n\n# third party libraries and dependencies\nthe following libraries will be installed when you install the client library:\n* [requests](https://github.com/kennethreitz/requests)\n* [microsoft authentication library (msal) for python](https://pypi.org/project/msal/)\n\n\n\n",
  "docs_url": null,
  "keywords": "git",
  "license": "mit",
  "name": "office365-rest-python-client",
  "package_url": "https://pypi.org/project/Office365-REST-Python-Client/",
  "project_url": "https://pypi.org/project/Office365-REST-Python-Client/",
  "project_urls": {
    "Homepage": "https://github.com/vgrem/Office365-REST-Python-Client"
  },
  "release_url": "https://pypi.org/project/Office365-REST-Python-Client/2.5.3/",
  "requires_dist": [
    "requests",
    "msal",
    "pytz",
    "typing-extensions (>=4.0.0)",
    "requests-ntlm ; extra == 'ntlmprovider'"
  ],
  "requires_python": "",
  "summary": "microsoft 365 & microsoft graph library for python",
  "version": "2.5.3",
  "releases": [],
  "developers": [
    "dom.dinicola@gmail.com",
    "kgadek@gmail.com",
    "vadim_gremyachev",
    "vvgrem@gmail.com"
  ],
  "kwds": "onenote office365 graph_client graphclient api",
  "license_kwds": "mit",
  "libtype": "pypi",
  "id": "pypi_office365_rest_python_client",
  "homepage": "https://github.com/vgrem/office365-rest-python-client",
  "release_count": 44,
  "dependency_ids": [
    "pypi_msal",
    "pypi_pytz",
    "pypi_requests",
    "pypi_requests_ntlm",
    "pypi_typing_extensions"
  ]
}