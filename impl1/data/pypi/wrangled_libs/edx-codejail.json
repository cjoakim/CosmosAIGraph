{
  "classifiers": [
    "development status :: 5 - production/stable",
    "intended audience :: developers",
    "license :: osi approved :: apache software license",
    "operating system :: posix :: linux",
    "programming language :: python",
    "programming language :: python :: 3",
    "programming language :: python :: 3.8"
  ],
  "description": "codejail\n========\n\ncodejail manages execution of untrusted code in secure sandboxes. it is\ndesigned primarily for python execution, but can be used for other languages as\nwell.\n\nsecurity is enforced with apparmor.  if your operating system doesn't support\napparmor, then codejail won't protect the execution.\n\ncodejail is designed to be configurable, and will auto-configure itself for\npython execution if you install it properly.  the configuration is designed to\nbe flexible: it can run in safe mode or unsafe mode.  this helps support large\ndevelopment groups where only some of the developers are involved enough with\nsecure execution to configure apparmor on their development machines.\n\nif codejail is not configured for safe execution, it will execution python\nusing the same api, but will not guard against malicious code.  this allows the\nsame code to be used on safe-configured or non-safe-configured developer's\nmachines.\n\na codejail sandbox consists of several pieces: \n\n#) sandbox environment. for a python setup, this would be python and\n   associated core packages. this is denoted throughout this document\n   as **<sandenv>**. this is read-only. \n\n#) sandbox packages. these are additional packages needed for a given\n   run. for example, this might be a grader written by an instructor\n   to run over a student's code, or data that a student's code might\n   need to access. this is denoted throughout this document as\n   **<sandpack>**. this is read-only.\n\n#) untrusted packages. this is typically the code submitted by the\n   student to be tested on the server, as well as any data the code\n   may need to modify. this is denoted throughout this document as\n   **<untrusted_pack>**. this is currently read-only, but may need to \n   be read-write for some applications.\n\n#) os packages. these are standard system libraries needed to run\n   python (e.g. things in /lib). this is denoted throughout this\n   document as **<ospack>**. this is read-only, and is specified by\n   ubuntu's apparmor profile.\n\nto run, codejail requires two user accounts. one account is the main\naccount under which the code runs, which has access to create\nsandboxes. this will be referred to as **<sandbox_caller>**. the\nsecond account is the account under which the sandbox runs. this is\ntypically the account 'sandbox.'\n\ninstallation\n------------\n\nthese instructions detail how to configure your operating system so that\ncodejail can execute python code safely.  you can run codejail without these\nsteps, and you will have an unsafe codejail.  this is fine for developers'\nmachines who are unconcerned with security, and simplifies the integration of\ncodejail into your project.\n\nto secure python execution, you'll be creating a new virtualenv.  this means\nyou'll have two: the main virtualenv for your project, and the new one for\nsandboxed python code.\n\nchoose a place for the new virtualenv, call it **<sandenv>**.  it will be\nautomatically detected and used if you put it right alongside your existing\nvirtualenv, but with `-sandbox` appended.  so if your existing virtualenv is in\n`/home/chris/ve/myproj`, make **<sandenv>** be `/home/chris/ve/myproj-sandbox`.\n\nthe user running the lms is **<sandbox_caller>**, for example, you on\nyour dev machine, or `www-data` on a server.\n\nother details here that depend on your configuration:\n\n1. create the new virtualenv::\n\n    $ sudo virtualenv <sandenv>\n\n2. (optional) if you have particular packages you want available to your\n   sandboxed code, install them by activating the sandbox virtual env, and\n   using pip to install them::\n\n    $ source <sandenv>/bin/activate\n    $ pip install -r requirements/sandbox.txt\n\n3. add a sandbox user::\n\n    $ sudo addgroup sandbox\n    $ sudo adduser --disabled-login sandbox --ingroup sandbox\n\n4. let the web server run the sandboxed python as sandbox.  create the file\n   `/etc/sudoers.d/01-sandbox`::\n\n    $ sudo visudo -f /etc/sudoers.d/01-sandbox\n\n    <sandbox_caller> all=(sandbox) setenv:nopasswd:<sandenv>/bin/python\n    <sandbox_caller> all=(sandbox) setenv:nopasswd:/usr/bin/find\n    <sandbox_caller> all=(all) nopasswd:/usr/bin/pkill\n\n5. edit an apparmor profile.  this is a text file specifying the limits on the\n   sandboxed python executable.  the file must be in `/etc/apparmor.d` and must\n   be named based on the executable, with slashes replaced by dots.  for\n   example, if your sandboxed python is at `/home/chris/ve/myproj-sandbox/bin/python`,\n   then your apparmor profile must be `/etc/apparmor.d/home.chris.ve.myproj-sandbox.bin.python`::\n\n    $ sudo vim /etc/apparmor.d/home.chris.ve.myproj-sandbox.bin.python\n\n    #include <tunables/global>\n\n    <sandenv>/bin/python {\n        #include <abstractions/base>\n        #include <abstractions/python>\n\n        <sandenv>/** mr,\n        # if you have code that the sandbox must be able to access, add lines\n        # pointing to those directories:\n        /the/path/to/your/sandbox-packages/** r,\n\n        /tmp/codejail-*/ rix,\n        /tmp/codejail-*/** wrix,\n    }\n\n6. parse the profiles::\n\n    $ sudo apparmor_parser <apparmor_file>\n\n7. reactivate your project's main virtualenv again.\n\nusing codejail\n--------------\n\nif your codejail is properly configured to use safe_exec, try these\ncommands at your python terminal::\n\n    import codejail.jail_code\n    codejail.jail_code.configure('python', '<sandenv>/bin/python')\n    import codejail.safe_exec\n    codejail.safe_exec.safe_exec(\"import os\\nos.system('ls /etc')\", {})\n\nthis should fail with an exception. \n\nif you need to change the packages installed into your sandbox's virtualenv,\nyou'll need to disable apparmor, because your sandboxed python doesn't have\nthe rights to modify the files in its site-packages directory.\n\n1. disable apparmor for your sandbox::\n\n    $ sudo apt-get install apparmor-utils  # if you haven't already\n    $ sudo aa-complain /etc/apparmor.d/home.chris.ve.myproj-sandbox.bin.python\n\n2. install or otherwise change the packages installed::\n\n    $ pip install -r requirements/sandbox.txt\n\n3. re-enable apparmor for your sandbox::\n\n    $ sudo aa-enforce /etc/apparmor.d/home.chris.ve.myproj-sandbox.bin.python\n\n\ntests\n-----\n\nin order to target the sandboxed python environment(s) you have created on your\nsystem, you must set the following environment variables for testing::\n\n    $ export codejail_test_user=<owner of sandbox (usually 'sandbox')>\n    $ export codejail_test_venv=<sandenv>\n\nrun the tests with the makefile::\n\n    $ make tests\n\nif codejail is running unsafely, many of the tests will be automatically\nskipped, or will fail, depending on whether codejail thinks it should be in\nsafe mode or not.\n\n\ndesign\n------\n\ncodejail is general-purpose enough that it can be used in a variety of projects\nto run untrusted code.  it provides two layers:\n\n* `jail_code.py` offers secure execution of subprocesses.  it does this by\n  running the program in a subprocess managed by apparmor.\n\n* `safe_exec.py` offers specialized handling of python execution, using\n  jail_code to provide the semantics of python's exec statement.\n\ncodejail runs programs under apparmor.  apparmor is an os-provided feature to\nlimit the resources programs can access. to run python code with limited access\nto resources, we make a new virtualenv, then name that python executable in an\napparmor profile, and restrict resources in that profile.  codejail will\nexecute the provided python program with that executable, and apparmor will\nautomatically limit the resources it can access.  codejail also uses setrlimit\nto limit the amount of cpu time and/or memory available to the process.\n\n`codejail.jail_code` takes a program to run, files to copy into its\nenvironment, command-line arguments, and a stdin stream.  it creates a\ntemporary directory, creates or copies the needed files, spawns a subprocess to\nrun the code, and returns the output and exit status of the process.\n\n`codejail.safe_exec` emulates python's exec statement.  it takes a chunk of\npython code, and runs it using jail_code, modifying the globals dictionary as a\nside-effect.  safe_exec does this by serializing the globals into and out of\nthe subprocess as json.\n\n\n",
  "docs_url": null,
  "keywords": "edx codejail",
  "license": "apache",
  "name": "edx-codejail",
  "package_url": "https://pypi.org/project/edx-codejail/",
  "project_url": "https://pypi.org/project/edx-codejail/",
  "project_urls": {
    "Homepage": "https://github.com/openedx/codejail"
  },
  "release_url": "https://pypi.org/project/edx-codejail/3.3.3/",
  "requires_dist": [
    "six"
  ],
  "requires_python": "",
  "summary": "codejail manages execution of untrusted code in secure sandboxes. it is designed primarily for python execution, but can be used for other languages as well.",
  "version": "3.3.3",
  "releases": [],
  "developers": [
    "edx",
    "oscm@edx.org"
  ],
  "kwds": "codejail codejail_test_user codejail_test_venv sandbox_caller sandboxed",
  "license_kwds": "apache",
  "libtype": "pypi",
  "id": "pypi_edx_codejail",
  "homepage": "https://github.com/openedx/codejail",
  "release_count": 5,
  "dependency_ids": [
    "pypi_six"
  ]
}