{
  "classifiers": [
    "development status :: 5 - production/stable",
    "environment :: console",
    "intended audience :: developers",
    "license :: osi approved :: apache software license",
    "operating system :: os independent",
    "programming language :: python :: 3 :: only",
    "programming language :: python :: 3.10",
    "programming language :: python :: 3.11",
    "programming language :: python :: 3.12",
    "programming language :: python :: 3.8",
    "programming language :: python :: 3.9",
    "topic :: software development",
    "topic :: utilities",
    "typing :: typed"
  ],
  "description": "[![build status](https://github.com/bridgecrewio/detect-secrets/actions/workflows/release.yml/badge.svg)](https://github.com/bridgecrewio/detect-secrets/actions/workflows/release.yml?query=branch%3amaster++)\n[![pypi](https://img.shields.io/pypi/v/bc-detect-secrets)](https://pypi.org/project/bc-detect-secrets/)\n[![python version](https://img.shields.io/pypi/pyversions/bc-detect-secrets)](#)\n\n# detect-secrets\n\n# notice\n\nthis is a fork of the [detect-secrets](https://github.com/yelp/detect-secrets) repo by yelp and is\nofficially supported by bridgecrew.\n\n## about\n\n`detect-secrets` is an aptly named module for (surprise, surprise) **detecting secrets** within a\ncode base.\n\nhowever, unlike other similar packages that solely focus on finding secrets, this package is\ndesigned with the enterprise client in mind: providing a **backwards compatible**, systematic\nmeans of:\n\n1. preventing new secrets from entering the code base,\n2. detecting if such preventions are explicitly bypassed, and\n3. providing a checklist of secrets to roll, and migrate off to a more secure storage.\n\nthis way, you create a\n[separation of concern](https://en.wikipedia.org/wiki/separation_of_concerns):\naccepting that there may *currently* be secrets hiding in your large repository\n(this is what we refer to as a _baseline_), but preventing this issue from getting any larger,\nwithout dealing with the potentially gargantuan effort of moving existing secrets away.\n\nit does this by running periodic diff outputs against heuristically crafted regex statements,\nto identify whether any *new* secret has been committed. this way, it avoids the overhead of\ndigging through all git history, as well as the need to scan the entire repository every time.\n\nfor a look at recent changes, please see [changelog.md](changelog.md).\n\nif you are looking to contribute, please see [contributing.md](contributing.md).\n\nfor more detailed documentation, check out our other [documentation](docs/).\n\n## examples\n\n### quickstart:\n\ncreate a baseline of potential secrets currently found in your git repository.\n\n```bash\n$ detect-secrets scan > .secrets.baseline\n```\n\nor, to run it from a different directory:\n\n```bash\n$ detect-secrets -c /path/to/directory scan > /path/to/directory/.secrets.baseline\n```\n\n**scanning non-git tracked files:**\n\n```bash\n$ detect-secrets scan test_data/ --all-files > .secrets.baseline\n```\n\n### adding new secrets to baseline:\n\nthis will rescan your codebase, and:\n\n1. update/upgrade your baseline to be compatible with the latest version,\n2. add any new secrets it finds to your baseline,\n3. remove any secrets no longer in your codebase\n\nthis will also preserve any labelled secrets you have.\n\n```bash\n$ detect-secrets scan --baseline .secrets.baseline\n```\n\nfor baselines older than version 0.9, just recreate it.\n\n### alerting off newly added secrets:\n\n**scanning staged files only:**\n\n```bash\n$ git diff --staged --name-only -z | xargs -0 detect-secrets-hook --baseline .secrets.baseline\n```\n\n**scanning all tracked files:**\n\n```bash\n$ git ls-files -z | xargs -0 detect-secrets-hook --baseline .secrets.baseline\n```\n\n### viewing all enabled plugins:\n\n```bash\n$ detect-secrets scan --list-all-plugins\nartifactorydetector\nawskeydetector\nazurestoragekeydetector\nbasicauthdetector\ncloudantdetector\ndiscordbottokendetector\ngithubtokendetector\nbase64highentropystring\nhexhighentropystring\nibmcloudiamdetector\nibmcoshmacdetector\njwttokendetector\nkeyworddetector\nmailchimpdetector\nnpmdetector\nprivatekeydetector\nsendgriddetector\nslackdetector\nsoftlayerdetector\nsquareoauthdetector\nstripedetector\ntwiliokeydetector\n```\n\n### disabling plugins:\n\n```bash\n$ detect-secrets scan --disable-plugin keyworddetector --disable-plugin awskeydetector\n```\n\nif you want to **only** run a specific plugin, you can do:\n\n```bash\n$ detect-secrets scan --list-all-plugins | \\\n    grep -v 'basicauthdetector' | \\\n    sed \"s#^#--disable-plugin #g\" | \\\n    xargs detect-secrets scan test_data\n```\n\n### auditing a baseline:\n\nthis is an optional step to label the results in your baseline. it can be used to narrow down your\nchecklist of secrets to migrate, or to better configure your plugins to improve its signal-to-noise\nratio.\n\n```bash\n$ detect-secrets audit .secrets.baseline\n```\n\n### usage in other python scripts\n\n**basic use:**\n\n```python\nfrom detect_secrets import secretscollection\nfrom detect_secrets.settings import default_settings\n\nsecrets = secretscollection()\nwith default_settings():\n    secrets.scan_file('test_data/config.ini')\n\n\nimport json\nprint(json.dumps(secrets.json(), indent=2))\n```\n\n**more advanced configuration:**\n\n```python\nfrom detect_secrets import secretscollection\nfrom detect_secrets.settings import transient_settings\n\nsecrets = secretscollection()\nwith transient_settings({\n    # only run scans with only these plugins.\n    # this format is the same as the one that is saved in the generated baseline.\n    'plugins_used': [\n        # example of configuring a built-in plugin\n        {\n            'name': 'base64highentropystring',\n            'limit': 5.0,\n        },\n\n        # example of using a custom plugin\n        {\n            'name': 'hippodetector',\n            'path': 'file:///users/aaronloo/documents/github/detect-secrets/testing/plugins.py',\n        },\n    ],\n\n    # we can also specify whichever additional filters we want.\n    # this is an example of using the function `is_identified_by_ml_model` within the\n    # local file `./private-filters/example.py`.\n    'filters_used': [\n        {\n            'path': 'file://private-filters/example.py::is_identified_by_ml_model',\n        },\n    ]\n}) as settings:\n    # if we want to make any further adjustments to the created settings object (e.g.\n    # disabling default filters), we can do so as such.\n    settings.disable_filters(\n        'detect_secrets.filters.heuristic.is_prefixed_with_dollar_sign',\n        'detect_secrets.filters.heuristic.is_likely_id_string',\n    )\n\n    secrets.scan_file('test_data/config.ini')\n```\n\n## installation\n\n```bash\n$ pip install detect-secrets\n\u2728\ud83c\udf70\u2728\n```\n\ninstall via [brew](https://brew.sh/):\n\n```bash\n$ brew install detect-secrets\n```\n\n## usage\n\n`detect-secrets` comes with three different tools, and there is often confusion around which one\nto use. use this handy checklist to help you decide:\n\n1. do you want to add secrets to your baseline? if so, use **`detect-secrets scan`**.\n2. do you want to alert off new secrets not in the baseline? if so, use **`detect-secrets-hook`**.\n3. are you analyzing the baseline itself? if so, use **`detect-secrets audit`**.\n\n### adding secrets to baseline\n\n```\n$ detect-secrets scan --help\nusage: detect-secrets scan [-h] [--string [string]] [--only-allowlisted]\n                           [--all-files] [--baseline filename]\n                           [--force-use-all-plugins] [--slim]\n                           [--list-all-plugins] [-p plugin]\n                           [--base64-limit [base64_limit]]\n                           [--hex-limit [hex_limit]]\n                           [--disable-plugin disable_plugin]\n                           [-n | --only-verified]\n                           [--exclude-lines exclude_lines]\n                           [--exclude-files exclude_files]\n                           [--exclude-secrets exclude_secrets]\n                           [--word-list word_list_file] [-f filter]\n                           [--disable-filter disable_filter]\n                           [path [path ...]]\n\nscans a repository for secrets in code. the generated output is compatible\nwith `detect-secrets-hook --baseline`.\n\npositional arguments:\n  path                  scans the entire codebase and outputs a snapshot of\n                        currently identified secrets.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  --string [string]     scans an individual string, and displays configured\n                        plugins' verdict.\n  --only-allowlisted    only scans the lines that are flagged with `allowlist\n                        secret`. this helps verify that individual exceptions\n                        are indeed non-secrets.\n\nscan options:\n  --all-files           scan all files recursively (as compared to only\n                        scanning git tracked files).\n  --baseline filename   if provided, will update existing baseline by\n                        importing settings from it.\n  --force-use-all-plugins\n                        if a baseline is provided, detect-secrets will default\n                        to loading the plugins specified by that baseline.\n                        however, this may also mean it doesn't perform the\n                        scan with the latest plugins. if this flag is\n                        provided, it will always use the latest plugins\n  --slim                slim baselines are created with the intention of\n                        minimizing differences between commits. however, they\n                        are not compatible with the `audit` functionality, and\n                        slim baselines will need to be remade to be audited.\n\nplugin options:\n  configure settings for each secret scanning ruleset. by default, all\n  plugins are enabled unless explicitly disabled.\n\n  --list-all-plugins    lists all plugins that will be used for the scan.\n  -p plugin, --plugin plugin\n                        specify path to custom secret detector plugin.\n  --base64-limit [base64_limit]\n                        sets the entropy limit for high entropy strings. value\n                        must be between 0.0 and 8.0, defaults to 4.5.\n  --hex-limit [hex_limit]\n                        sets the entropy limit for high entropy strings. value\n                        must be between 0.0 and 8.0, defaults to 3.0.\n  --disable-plugin disable_plugin\n                        plugin class names to disable. e.g.\n                        base64highentropystring\n\nfilter options:\n  configure settings for filtering out secrets after they are flagged by the\n  engine.\n\n  -n, --no-verify       disables additional verification of secrets via\n                        network call.\n  --only-verified       only flags secrets that can be verified.\n  --exclude-lines exclude_lines\n                        if lines match this regex, it will be ignored.\n  --exclude-files exclude_files\n                        if filenames match this regex, it will be ignored.\n  --exclude-secrets exclude_secrets\n                        if secrets match this regex, it will be ignored.\n  --word-list word_list_file\n                        text file with a list of words, if a secret contains a\n                        word in the list we ignore it.\n  -f filter, --filter filter\n                        specify path to custom filter. may be a python module\n                        path (e.g.\n                        detect_secrets.filters.common.is_invalid_file) or a\n                        local file path (e.g.\n                        file://path/to/file.py::function_name).\n  --disable-filter disable_filter\n                        specify filter to disable. e.g.\n                        detect_secrets.filters.common.is_invalid_file\n```\n\n### blocking secrets not in baseline\n\n```\n$ detect-secrets-hook --help\nusage: detect-secrets-hook [-h] [-v] [--version] [--baseline filename]\n                           [--list-all-plugins] [-p plugin]\n                           [--base64-limit [base64_limit]]\n                           [--hex-limit [hex_limit]]\n                           [--disable-plugin disable_plugin]\n                           [-n | --only-verified]\n                           [--exclude-lines exclude_lines]\n                           [--exclude-files exclude_files]\n                           [--exclude-secrets exclude_secrets]\n                           [--word-list word_list_file] [-f filter]\n                           [--disable-filter disable_filter]\n                           [filenames [filenames ...]]\n\npositional arguments:\n  filenames             filenames to check.\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -v, --verbose         verbose mode.\n  --version             display version information.\n  --json                print detect-secrets-hook output as json\n  --baseline filename   explicitly ignore secrets through a baseline generated\n                        by `detect-secrets scan`\n\nplugin options:\n  configure settings for each secret scanning ruleset. by default, all\n  plugins are enabled unless explicitly disabled.\n\n  --list-all-plugins    lists all plugins that will be used for the scan.\n  -p plugin, --plugin plugin\n                        specify path to custom secret detector plugin.\n  --base64-limit [base64_limit]\n                        sets the entropy limit for high entropy strings. value\n                        must be between 0.0 and 8.0, defaults to 4.5.\n  --hex-limit [hex_limit]\n                        sets the entropy limit for high entropy strings. value\n                        must be between 0.0 and 8.0, defaults to 3.0.\n  --disable-plugin disable_plugin\n                        plugin class names to disable. e.g.\n                        base64highentropystring\n\nfilter options:\n  configure settings for filtering out secrets after they are flagged by the\n  engine.\n\n  -n, --no-verify       disables additional verification of secrets via\n                        network call.\n  --only-verified       only flags secrets that can be verified.\n  --exclude-lines exclude_lines\n                        if lines match this regex, it will be ignored.\n  --exclude-files exclude_files\n                        if filenames match this regex, it will be ignored.\n  --exclude-secrets exclude_secrets\n                        if secrets match this regex, it will be ignored.\n  -f filter, --filter filter\n                        specify path to custom filter. may be a python module\n                        path (e.g.\n                        detect_secrets.filters.common.is_invalid_file) or a\n                        local file path (e.g.\n                        file://path/to/file.py::function_name).\n  --disable-filter disable_filter\n                        specify filter to disable. e.g.\n                        detect_secrets.filters.common.is_invalid_file\n```\n\nwe recommend setting this up as a pre-commit hook. one way to do this is by using the\n[pre-commit](https://github.com/pre-commit/pre-commit) framework:\n\n```yaml\n# .pre-commit-config.yaml\nrepos:\n-   repo: https://github.com/yelp/detect-secrets\n    rev: v1.4.0\n    hooks:\n    -   id: detect-secrets\n        args: ['--baseline', '.secrets.baseline']\n        exclude: package.lock.json\n```\n\n#### inline allowlisting\n\nthere are times when we want to exclude a false positive from blocking a commit, without creating\na baseline to do so. you can do so by adding a comment as such:\n\n```python\nsecret = \"hunter2\"      # pragma: allowlist secret\n```\n\nor\n\n```javascript\n//  pragma: allowlist nextline secret\nconst secret = \"hunter2\";\n```\n\n### auditing secrets in baseline\n\n```bash\n$ detect-secrets audit --help\nusage: detect-secrets audit [-h] [--diff] [--stats]\n                      [--report] [--only-real | --only-false]\n                      [--json]\n                      filename [filename ...]\n\nauditing a baseline allows analysts to label results, and optimize plugins for\nthe highest signal-to-noise ratio for their environment.\n\npositional arguments:\n  filename      audit a given baseline file to distinguish the difference\n                between false and true positives.\n\noptional arguments:\n  -h, --help    show this help message and exit\n  --diff        allows the comparison of two baseline files, in order to\n                effectively distinguish the difference between various plugin\n                configurations.\n  --stats       displays the results of an interactive auditing session which\n                have been saved to a baseline file.\n  --report      displays a report with the secrets detected\n\nreporting:\n  display a summary with all the findings and the made decisions. to be used with the report mode (--report).\n\n  --only-real   only includes real secrets in the report\n  --only-false  only includes false positives in the report\n\nanalytics:\n  quantify the success of your plugins based on the labelled results in your\n  baseline. to be used with the statistics mode (--stats).\n\n  --json        outputs results in a machine-readable format.\n```\n\n## configuration\n\nthis tool operates through a system of **plugins** and **filters**.\n\n- **plugins** find secrets in code\n- **filters** ignore false positives to increase scanning precision\n\nyou can adjust both to suit your precision/recall needs.\n\n### plugins\n\nthere are three different strategies we employ to try and find secrets in code:\n\n1. regex-based rules\n\n   these are the most common type of plugin, and work well with well-structured secrets.\n   these secrets can optionally be [verified](docs/plugins.md#verified-secrets), which increases\n   scanning precision. however, solely depending on these may negatively affect the recall of your\n   scan.\n\n2. entropy detector\n\n   this searches for \"secret-looking\" strings through a variety of heuristic approaches. this\n   is great for non-structured secrets, but may require tuning to adjust the scanning precision.\n\n3. keyword detector\n\n   this ignores the secret value, and searches for variable names that are often associated with\n   assigning secrets with hard-coded values. this is great for \"non-secret-looking\" strings (e.g.\n   le3tc0de passwords), but may require tuning filters to adjust the scanning precision.\n\nwant to find a secret that we don't currently catch? you can also (easily) develop your own\nplugin, and use it with the engine! for more information, check out the\n[plugin documentation](docs/plugins.md#using-your-own-plugin).\n\n### filters\n\n`detect-secrets` comes with several different in-built filters that may suit your needs.\n\n#### --exclude-lines\n\nsometimes, you want to be able to globally allow certain lines in your scan, if they match a\nspecific pattern. you can specify a regex rule as such:\n\n```bash\n$ detect-secrets scan --exclude-lines 'password = (blah|fake)'\n```\n\nor you can specify multiple regex rules as such:\n\n```bash\n$ detect-secrets scan --exclude-lines 'password = blah' --exclude-lines 'password = fake'\n```\n\n#### --exclude-files\n\nsometimes, you want to be able to ignore certain files in your scan. you can specify a regex\npattern to do so, and if the filename meets this regex pattern, it will not be scanned:\n\n```bash\n$ detect-secrets scan --exclude-files '.*\\.signature$'\n```\n\nor you can specify multiple regex patterns as such:\n\n```bash\n$ detect-secrets scan --exclude-files '.*\\.signature$' --exclude-files '.*/i18n/.*'\n```\n\n#### --exclude-secrets\n\nsometimes, you want to be able to ignore certain secret values in your scan. you can specify\na regex rule as such:\n\n```bash\n$ detect-secrets scan --exclude-secrets '(fakesecret|\\${.*})'\n```\n\nor you can specify multiple regex rules as such:\n\n```bash\n$ detect-secrets scan --exclude-secrets 'fakesecret' --exclude-secrets '\\${.*})'\n```\n\n#### inline allowlisting\n\nsometimes, you want to apply an exclusion to a specific line, rather than globally excluding it.\nyou can do so with inline allowlisting as such:\n\n```python\napi_key = 'this-will-ordinarily-be-detected-by-a-plugin'    # pragma: allowlist secret\n```\n\nthese comments are supported in multiple languages. e.g.\n\n```java\nconst googlecredentialpassword = \"something-secret-here\";     //  pragma: allowlist secret\n```\n\nyou can also use:\n\n```python\n# pragma: allowlist nextline secret\napi_key = 'willalsobeignored'\n```\n\nthis may be a convenient way for you to ignore secrets, without needing to regenerate the entire\nbaseline again. if you need to explicitly search for these allowlisted secrets, you can also do:\n\n```bash\n$ detect-secrets scan --only-allowlisted\n```\n\nwant to write more custom logic to filter out false positives? check out how to do this in\nour [filters documentation](docs/filters.md#using-your-own-filters).\n\n## extensions\n\n### wordlist\n\nthe `--exclude-secrets` flag allows you to specify regex rules to exclude secret values. however,\nif you want to specify a large list of words instead, you can use the `--word-list` flag.\n\nto use this feature, be sure to install the `pyahocorasick` package, or simply use:\n\n```bash\n$ pip install detect-secrets[word_list]\n```\n\nthen, you can use it as such:\n\n```bash\n$ cat wordlist.txt\nnot-a-real-secret\n$ cat sample.ini\npassword = not-a-real-secret\n\n# will show results\n$ detect-secrets scan sample.ini\n\n# no results found\n$ detect-secrets scan --word-list wordlist.txt\n```\n\n### gibberish detector\n\nthe gibberish detector is a simple ml model, that attempts to determine whether a secret value\nis actually gibberish, with the assumption that **real** secret values are not word-like.\n\nto use this feature, be sure to install the `gibberish-detector` package, or use:\n\n```bash\n$ pip install detect-secrets[gibberish]\n```\n\ncheck out the [gibberish-detector](https://github.com/domanchi/gibberish-detector) package for\nmore information on how to train the model. a pre-trained model (seeded by processing rfcs) will\nbe included for easy use.\n\nyou can also specify your own model as such:\n\n```bash\n$ detect-secrets scan --gibberish-model custom.model\n```\n\nthis is not a default plugin, given that this will ignore secrets such as `password`.\n\n## caveats\n\nthis is not meant to be a sure-fire solution to prevent secrets from entering the codebase. only\nproper developer education can truly do that. this pre-commit hook merely implements several\nheuristics to try and prevent obvious cases of committing secrets.\n\n**things that won't be prevented:**\n\n- multi-line secrets\n- default passwords that don't trigger the `keyworddetector` (e.g. `login = \"hunter2\"`)\n\n## faq\n\n### general\n\n- **\"did not detect git repository.\" warning encountered, even though i'm in a git repo.**\n\n  check to see whether your `git` version is >= 1.8.5. if not, please upgrade it then try again.\n  [more details here](https://github.com/yelp/detect-secrets/issues/220).\n\n### windows\n\n- **`detect-secrets audit` displays \"not a valid baseline file!\" after creating baseline.**\n\n  ensure the file encoding of your baseline file is utf-8.\n  [more details here](https://github.com/yelp/detect-secrets/issues/272#issuecomment-619187136).\n",
  "docs_url": null,
  "keywords": "secret-management,pre-commit,security,entropy-checks",
  "license": "apache license 2.0",
  "name": "bc-detect-secrets",
  "package_url": "https://pypi.org/project/bc-detect-secrets/",
  "project_url": "https://pypi.org/project/bc-detect-secrets/",
  "project_urls": {
    "Homepage": "https://github.com/bridgecrewio/detect-secrets"
  },
  "release_url": "https://pypi.org/project/bc-detect-secrets/1.5.1/",
  "requires_dist": [
    "pyyaml",
    "requests",
    "unidiff",
    "gibberish-detector ; extra == 'gibberish'",
    "pyahocorasick ; extra == 'word_list'"
  ],
  "requires_python": ">=3.8",
  "summary": "tool for detecting secrets in the codebase",
  "version": "1.5.1",
  "releases": [],
  "developers": [
    "bridgecrew",
    "meet@bridgecrew.io"
  ],
  "kwds": "detect_secrets exclude_secrets secrets secretscollection detect",
  "license_kwds": "apache license 2.0",
  "libtype": "pypi",
  "id": "pypi_bc_detect_secrets",
  "homepage": "https://github.com/bridgecrewio/detect-secrets",
  "release_count": 45,
  "dependency_ids": [
    "pypi_gibberish_detector",
    "pypi_pyahocorasick",
    "pypi_pyyaml",
    "pypi_requests",
    "pypi_unidiff"
  ]
}