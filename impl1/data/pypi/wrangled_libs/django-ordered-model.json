{
  "classifiers": [
    "development status :: 5 - production/stable",
    "framework :: django",
    "intended audience :: developers",
    "license :: osi approved :: bsd license",
    "operating system :: os independent",
    "programming language :: python",
    "programming language :: python :: 3"
  ],
  "description": "django-ordered-model\n====================\n\n[![build status](https://secure.travis-ci.org/bfirsh/django-ordered-model.png?branch=master)](https://travis-ci.org/bfirsh/django-ordered-model)\n[![pypi version](https://badge.fury.io/py/django-ordered-model.svg)](https://badge.fury.io/py/django-ordered-model)\n[![codecov](https://codecov.io/gh/bfirsh/django-ordered-model/branch/master/graph/badge.svg)](https://codecov.io/gh/bfirsh/django-ordered-model)\n[![code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/python/black)\n\ndjango-ordered-model allows models to be ordered and provides a simple admin\ninterface for reordering them.\n\nbased on https://djangosnippets.org/snippets/998/ and\nhttps://djangosnippets.org/snippets/259/\n\nsee our [compatability notes](#compatibility-with-django-and-python) for the appropriate version to use with older django and python releases.\n\ninstallation\n------------\n\nplease install using pip:\n\n```bash\n$ pip install django-ordered-model\n```\n\nor if you have checked out the repository:\n\n```bash\n$ python setup.py install\n```\n\nor to use the latest development code from our master branch:\n\n```bash\n$ pip uninstall django-ordered-model\n$ pip install git+git://github.com/django-ordered-model/django-ordered-model.git\n```\n\nusage\n-----\n\nadd `ordered_model` to your `settings.installed_apps`.\n\ninherit your model from `orderedmodel` to make it ordered:\n\n```python\nfrom django.db import models\nfrom ordered_model.models import orderedmodel\n\n\nclass item(orderedmodel):\n    name = models.charfield(max_length=100)\n\n```\n\nthen run the usual `$ ./manage.py makemigrations` and `$ ./manage.py migrate` to update your database schema.\n\nmodel instances now have a set of methods to move them relative to each other.\nto demonstrate those methods we create two instances of `item`:\n\n```python\nfoo = item.objects.create(name=\"foo\")\nbar = item.objects.create(name=\"bar\")\n```\n\n### swap positions\n\n```python\nfoo.swap(bar)\n```\n\nthis swaps the position of two objects.\n\n### move position up on position\n\n```python\nfoo.up()\nfoo.down()\n```\n\nmoving an object up or down just makes it swap its position with the neighbouring\nobject directly above of below depending on the direction.\n\n### move to arbitrary position\n\n```python\nfoo.to(12)\nbar.to(13)\n```\n\nmove the object to an arbitrary position in the stack. this essentially sets the\norder value to the specified integer. objects between the original and the new\nposition get their order value increased or decreased according to the direction\nof the move.\n\n### move object above or below reference\n\n```python\nfoo.above(bar)\nfoo.below(bar)\n```\n\nmove the object directly above or below the reference object, increasing or\ndecreasing the order value for all objects between the two, depending on the\ndirection of the move.\n\n### move to top of stack\n\n```python\nfoo.top()\n```\n\nthis sets the order value to the lowest value found in the stack and increases\nthe order value of all objects that were above the moved object by one.\n\n### move to bottom of stack\n\n```python\nfoo.bottom()\n```\n\nthis sets the order value to the highest value found in the stack and decreases\nthe order value of all objects that were below the moved object by one.\n\n### updating fields that would be updated during save()\n\nfor performance reasons, the `delete()`, `to()`, `below()`, `above()`, `top()`, and\n`bottom()` methods use django's `update()` method to change the order of other objects\nthat are shifted as a result of one of these calls. if the model has fields that\nare typically updated in a customized save() method, or through other app level\nfunctionality such as `datetimefield(auto_now=true)`, you can add additional fields\nto be passed through to `update()`. this will only impact objects where their order\nis being shifted as a result of an operation on the target object, not the target\nobject itself.\n\n```python\nfoo.to(12, extra_update={'modified': now()})\n```\n\n### get the previous or next objects\n\n```python\nfoo.previous()\nfoo.next()\n```\n\nthe `previous()` and `next()` methods return the neighbouring objects directly above or below\nwithin the ordered stack.\n\n## subset ordering\n\nin some cases, ordering objects is required only on a subset of objects. for example,\nan application that manages contact lists for users, in a many-to-one/many relationship,\nwould like to allow each user to order their contacts regardless of how other users\nchoose their order. this option is supported via the `order_with_respect_to` parameter.\n\na simple example might look like so:\n\n```python\nclass contact(orderedmodel):\n    user = models.foreignkey(user, on_delete=models.cascade)\n    phone = models.charfield()\n    order_with_respect_to = 'user'\n```\n\nif objects are ordered with respect to more than one field, `order_with_respect_to` supports\ntuples to define multiple fields:\n\n```python\nclass model(orderedmodel)\n    # ...\n    order_with_respect_to = ('field_a', 'field_b')\n```\n\nin a many-to-many relationship you need to use a separate through model which is derived from the orderedmodel.\nfor example, an application which manages pizzas with toppings.\n\na simple example might look like so:\n\n```python\nclass topping(models.model):\n    name = models.charfield(max_length=100)\n\n\nclass pizza(models.model):\n    name = models.charfield(max_length=100)\n    toppings = models.manytomanyfield(topping, through='pizzatoppingsthroughmodel')\n\n\nclass pizzatoppingsthroughmodel(orderedmodel):\n    pizza = models.foreignkey(pizza, on_delete=models.cascade)\n    topping = models.foreignkey(topping, on_delete=models.cascade)\n    order_with_respect_to = 'pizza'\n\n    class meta:\n        ordering = ('pizza', 'order')\n```\n\nyou can also specify `order_with_respect_to` to a field on a related model. an example use-case can be made with the following models:\n\n```python\nclass itemgroup(models.model):\n    user = models.foreignkey(user, on_delete=models.cascade)\n    general_info = models.charfield(max_length=100)\n\nclass groupeditem(orderedmodel):\n    group = models.foreignkey(itemgroup, on_delete=models.cascade)\n    specific_info = models.charfield(max_length=100)\n    order_with_respect_to = 'group__user'\n```\n\nhere items are put into groups that have some general information used by its items, but the ordering of the items is independent of the group the item is in.\n\nin all cases `order_with_respect_to` must specify a `foreignkey` field on the model, or a django check `e002`, `e005` or `e006` error will be raised with further help.  \n\nwhen you want ordering on the baseclass instead of subclasses in an ordered list of objects of various classes, specify the full module path of the base class:\n\n```python\nclass basequestion(orderedmodel):\n    order_class_path = __module__ + '.basequestion'\n    question = models.textfield(max_length=100)\n\n    class meta:\n        ordering = ('order',)\n\nclass multiplechoicequestion(basequestion):\n    good_answer = models.textfield(max_length=100)\n    wrong_answer1 = models.textfield(max_length=100)\n    wrong_answer2 = models.textfield(max_length=100)\n    wrong_answer3 = models.textfield(max_length=100)\n\nclass openquestion(basequestion):\n    answer = models.textfield(max_length=100)\n```\n\ncustom manager and queryset\n-----------------\nwhen your model your extends `orderedmodel`, it inherits a custom `modelmanager` instance which in turn provides additional operations on the resulting `queryset`. for example if `item` is an `orderedmodel` subclass, the  queryset `item.objects.all()` has functions:\n\n* `above_instance(object)`,\n* `below_instance(object)`,\n* `get_min_order()`,\n* `get_max_order()`,\n* `above(index)`,\n* `below(index)`\n\nif your `model` uses a custom `modelmanager` (such as `itemmanager` below) please have it extend `orderedmodelmanager`, or else django check `e003` will be raised.\n\nif your `modelmanager` returns a custom `queryset` (such as `itemqueryset` below) please have it extend `orderedmodelqueryset`, or django check `e004` will be raised.\n\n```python\nfrom ordered_model.models import orderedmodel, orderedmodelmanager, orderedmodelqueryset\n\nclass itemqueryset(orderedmodelqueryset):\n    pass\n\nclass itemmanager(orderedmodelmanager):\n    def get_queryset(self):\n        return itemqueryset(self.model, using=self._db)\n\nclass item(orderedmodel):\n    objects = itemmanager()\n```\n\nif another django plugin requires you to use specific `model`, `queryset` or `modelmanager` classes, you might need to construct intermediate classes using multiple inheritance, [see an example in issue 270](https://github.com/django-ordered-model/django-ordered-model/issues/270).\n\ncustom ordering field\n---------------------\nextending `orderedmodel` creates a `models.positiveintegerfield` field called `order` and the appropriate migrations. it customises the default `class meta` to then order returned querysets by this field. if you wish to use an existing model field to store the ordering, subclass `orderedmodelbase` instead and set the attribute `order_field_name` to match your field name and the `ordering` attribute on `meta`:\n\n```python\nclass mymodel(orderedmodelbase):\n    ...\n    sort_order = models.positiveintegerfield(editable=false, db_index=true)\n    order_field_name = \"sort_order\"\n\n    class meta:\n        ordering = (\"sort_order\",)\n```\nsetting `order_field_name` is specific for this library to know which field to change when ordering actions are taken. the `meta` `ordering` line is existing django functionality to use a field for sorting.\nsee `tests/models.py` object `customorderfieldmodel` for an example.\n\n\nadmin integration\n-----------------\n\nto add arrows in the admin change list page to do reordering, you can use the\n`orderedmodeladmin` and the `move_up_down_links` field:\n\n```python\nfrom django.contrib import admin\nfrom ordered_model.admin import orderedmodeladmin\nfrom models import item\n\n\nclass itemadmin(orderedmodeladmin):\n    list_display = ('name', 'move_up_down_links')\n\nadmin.site.register(item, itemadmin)\n```\n\n![itemadmin screenshot](./static/items.png)\n\n\nfor a many-to-many relationship you need one of the following inlines.\n\n`orderedtabularinline` or `orderedstackedinline` just like the django admin.\n\nfor the `orderedtabularinline` it will look like this:\n\n```python\nfrom django.contrib import admin\nfrom ordered_model.admin import orderedtabularinline, orderedinlinemodeladminmixin\nfrom models import pizza, pizzatoppingsthroughmodel\n\n\nclass pizzatoppingstabularinline(orderedtabularinline):\n    model = pizzatoppingsthroughmodel\n    fields = ('topping', 'order', 'move_up_down_links',)\n    readonly_fields = ('order', 'move_up_down_links',)\n    ordering = ('order',)\n    extra = 1\n\n\nclass pizzaadmin(orderedinlinemodeladminmixin, admin.modeladmin):\n    model = pizza\n    list_display = ('name', )\n    inlines = (pizzatoppingstabularinline, )\n\n\nadmin.site.register(pizza, pizzaadmin)\n```\n\n![pizzaadmin screenshot](./static/pizza.png)\n\n\nfor the `orderedstackedinline` it will look like this:\n\n```python\nfrom django.contrib import admin\nfrom ordered_model.admin import orderedstackedinline, orderedinlinemodeladminmixin\nfrom models import pizza, pizzatoppingsthroughmodel\n\n\nclass pizzatoppingsstackedinline(orderedstackedinline):\n    model = pizzatoppingsthroughmodel\n    fields = ('topping', 'move_up_down_links',)\n    readonly_fields = ('move_up_down_links',)\n    ordering = ('order',)\n    extra = 1\n\n\nclass pizzaadmin(orderedinlinemodeladminmixin, admin.modeladmin):\n    list_display = ('name', )\n    inlines = (pizzatoppingsstackedinline, )\n\n\nadmin.site.register(pizza, pizzaadmin)\n```\n\n![pizzaadmin screenshot](./static/pizza-stacked.png)\n\n**note:** `orderedmodeladmin` requires the inline subclasses of `orderedtabularinline` and `orderedstackedinline` to be listed on `inlines` so that we register appropriate url routes. if you are using django 3.0 feature `get_inlines()` or `get_inline_instances()` to return the list of inlines dynamically, consider it a filter and still add them to `inlines` or you might encounter a \u201cno reverse match\u201d error when accessing model change view.\n\nre-ordering models\n------------------\n\nin certain cases the models will end up in a not properly ordered state. this can be caused\nby bypassing the 'delete' / 'save' methods, or when a user changes a foreign key of a object\nwhich is part of the 'order_with_respect_to' fields. you can use the following command to\nre-order one or more models.\n\n    $ ./manage.py reorder_model <app_name>.<model_name> \\\n            [<app_name>.<model_name> ... ]\n\n    the arguments are as follows:\n    - `<app_name>`: name of the application for the model.\n    - `<model_name>`: name of the model that's an orderedmodel.\n\n\ndjango rest framework\n---------------------\n\nto support updating ordering fields by django rest framework, we include a serializer `orderedmodelserializer` that intercepts writes to the ordering field, and calls `orderedmodel.to()` method to effect a re-ordering:\n\n    from rest_framework import routers, serializers, viewsets\n    from ordered_model.serializers import orderedmodelserializer\n    from tests.models import customitem\n\n    class itemserializer(serializers.hyperlinkedmodelserializer, orderedmodelserializer):\n        class meta:\n            model = customitem\n            fields = ['pkid', 'name', 'modified', 'order']\n\n    class itemviewset(viewsets.modelviewset):\n        queryset = customitem.objects.all()\n        serializer_class = itemserializer\n\n    router = routers.defaultrouter()\n    router.register(r'items', itemviewset)\n\nnote that you need to include the 'order' field (or your custom field name) in the `serializer`'s `fields` list, either explicitly or using `__all__`. see [ordered_model/serializers.py](ordered_model/serializers.py) for the implementation.\n\ntest suite\n----------\n\nto run the tests against your current environment, use:\n\n```bash\n$ pip install djangorestframework\n$ django-admin test --pythonpath=. --settings=tests.settings\n```\n\notherwise please install `tox` and run the tests for a specific environment with `-e` or all environments:\n\n```bash\n$ tox -e py36-django30\n$ tox\n```\n\ncompatibility with django and python\n-----------------------------------------\n\n|django-ordered-model version | django version      | python version    | drf (optional)\n|-----------------------------|---------------------|-------------------|----------------\n| **3.6.x**                   | **3.x**, **4.x**    | **3.5** and above | 3.12 and above\n| **3.5.x**                   | **3.x**, **4.x**    | **3.5** and above | -\n| **3.4.x**                   | **2.x**, **3.x**    | **3.5** and above | -\n| **3.3.x**                   | **2.x**             | **3.4** and above | -\n| **3.2.x**                   | **2.x**             | **3.4** and above | -\n| **3.1.x**                   | **2.x**             | **3.4** and above | -\n| **3.0.x**                   | **2.x**             | **3.4** and above | -\n| **2.1.x**                   | **1.x**             | **2.7** to 3.6    | -\n| **2.0.x**                   | **1.x**             | **2.7** to 3.6    | -\n\n\nmaintainers\n-----------\n\n * [ben firshman](https://github.com/bfirsh)\n * [chris shucksmith](https://github.com/shuckc)\n * [sardorbek imomaliev](https://github.com/imomaliev)\n",
  "docs_url": null,
  "keywords": "",
  "license": "",
  "name": "django-ordered-model",
  "package_url": "https://pypi.org/project/django-ordered-model/",
  "project_url": "https://pypi.org/project/django-ordered-model/",
  "project_urls": {
    "Homepage": "http://github.com/django-ordered-model/django-ordered-model"
  },
  "release_url": "https://pypi.org/project/django-ordered-model/3.7.4/",
  "requires_dist": [],
  "requires_python": "",
  "summary": "allows django models to be ordered and provides a simple admin interface for reordering them.",
  "version": "3.7.4",
  "releases": [],
  "developers": [
    "ben@firshman.co.uk",
    "ben_firshman"
  ],
  "kwds": "ordered_model django djangosnippets reorder_model django30",
  "license_kwds": "",
  "libtype": "pypi",
  "id": "pypi_django_ordered_model",
  "homepage": "http://github.com/django-ordered-model/django-ordered-model",
  "release_count": 34,
  "dependency_ids": []
}