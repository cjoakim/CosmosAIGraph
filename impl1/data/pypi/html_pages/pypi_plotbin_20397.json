{
  "libtype": "pypi",
  "libname": "plotbin",
  "url": "https://purl.org/cappellari/software",
  "html": "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd\"><html><head>   <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">   <link rel=\"SHORTCUT ICON\" href=\"../favicon.ico\">   <meta name=\"Author\" content=\"Michele Cappellari\">   <title>Michele Cappellari Python Programs</title>   <style type=\"text/css\">   <!--   body {font-family: Tahoma, Geneva, sans-serif}#content {position: relative;}#content img {position: fixed;top: 0;right: 0;}   -->   </style></head><body bgcolor=\"#FFF68F\"><div id=\"content\">    <a href=\"https://recognition.webofscience.com/awards/highly-cited/\" target=\"_blank\">    <img src=\"../ribbon_2022.svg\" height=\"166\" class=\"ribbon\" alt=\"Highly Cited Researcher\"></a></div><h1>Michele Cappellari <a href=\"https://www.python.org/\"><img SRC=\"python-logo.svg\" alt=\"Python\" width=\"200\"align=\"middle\"></a> Programs</h1><p>The following software is freely available. However, if you use it for published research, you are requested to cite the paper where the method is described, highlighted in red. <font color=\"Red\"><b>You are not allowed to re-distribute any of these programs (modified or not) without explicit permission from the author.</b></font><p><b>NOTE: an outdated version of my programs in the <a href=\"https://www.harrisgeospatial.com/ProductsandTechnology/Software/IDL.aspx\"><img SRC=\"idl-logo.png\" alt=\"IDL\" align=\"middle\"></a> language is also available <a href=\"https://www-astro.physics.ox.ac.uk/~cappellari/idl/\">HERE</a>, however I strongly recommend the Python version.</b><ol><li><a href=\"#mge\">MgeFit</a>: to fit Multi-Gaussian Expansion (MGE) models to galaxy images, to be used as a parametrization for galaxy photometry<li><a href=\"#jam\">JAM</a>: to construct Jeans Anisotropic Models for the stellar kinematics of axisymmetric galaxies<li><a href=\"#binning\">VorBin</a>: to perform adaptive Voronoi spatial binning of Integral-Field Spectroscopy, X-ray or imaging data, to reach a chosen constant signal-to-noise ratio per bin<li><a href=\"#ppxf\">pPXF</a>: to extract the galaxy stellar or gas kinematics or stellar population from absorption-line spectra<li><a href=\"#pafit\">PaFit</a>: to measure the global galaxy kinematical axis from integral field observations<li><a href=\"#lts\">LtsFit</a>: to robustly fit a plane or a line to data with intrinsic scatter<li><a href=\"#loess\">LOESS</a>: to uncover mean trends from noisy one-dimensional or two-dimensional data using the LOESS approach.<li><a href=\"#adamet\">AdaMet</a>: An Adaptive Metropolis package for Bayesian analisys.</ol><p>My packages above are on the <a href=\"https://pypi.org/user/micappe/\">Python Package Index (PyPI)</a>.<p>See my review on galaxy structure and evolution: <a href=\"https://arjournals.annualreviews.org/eprint/rqUatQN2NVUqeusFv4hJ/full/10.1146/annurev-astro-082214-122432\" target=\"_blank\"><img src=\"../annual_review_logo.png\" alt=\"Annual Review\" height=\"60\"></a><br clear=\"all\"><hr><p> <table BGCOLOR=\"white\" border=\"1\" width=\"50%\" align=\"right\">    <tr>    <td>        <img SRC=\"ngc4342_mge.jpg\" alt=\"NGC4342 MGE fit\" width=\"100%\">        </td>    </tr>    <tr>    <td>        <i>Illustration of the steps involved in the MGE fit to the S0 galaxy NGC 4342 using the <code>MgeFit</code> package. The figures were produced by the <code>mge_fit_example.py</code> script included in the Python distribution of the software.</i>        </td>    </tr></table><h2 id=\"mge\">1. The MGE-Fit-Sectors method</h2><big><i>Robust technique to perform Multi-Gaussian Expansion (MGE) fits to galaxy images</i></big><p>This software obtains an accurate Multi-Gaussian Expansion (MGE) parameterizations (<a href=\"https://ui.adsabs.harvard.edu/abs/1994A%26A...285..723E\">Emsellem et al. 1994</a>; <a href=\"https://ui.adsabs.harvard.edu/abs/2002MNRAS.333..400C\">Cappellari 2002</a>) for a galaxy surface brightness with the fitting algorithm of <a href=\"https://ui.adsabs.harvard.edu/abs/2002MNRAS.333..400C\"><font color=\"Red\"><b>Cappellari (2002, MNRAS, 333, 400)</b></font></a>. Given that Gaussians are not orthogonal functions, MGE fits are in general strongly degenerate, with difficult  global convergence, but the <code>MGE_FIT_SECTORS</code> method solves all problems, making MGE fitting an automated, reliable and robust process.<p>See <a href=\"https://ui.adsabs.harvard.edu/abs/2013MNRAS.432.1709C\">Cappellari et al. (2013)</a> for a large scale application of this software to the study of the M/L ratio and the Fundamental Plane of early-type galaxies and <a href=\"https://ui.adsabs.harvard.edu/abs/2012Natur.484..485C\">Cappellari et al. (2012, Nature)</a> for an application to the study of the stellar IMF.The MGE parameterization is useful in the construction of realistic dynamical models of galaxies (see <a href=\"#jam\">JAM modelling</a> below), for PSF deconvolution of images, for the correction and estimation of dust absorption effects, or for galaxy photometry.<h3>The <code>MgeFit</code> package in <a href=\"https://www.python.org/\"><img SRC=\"python-logo.svg\" alt=\"Python\" width=\"200\"align=\"middle\"></a></h3><p>The source code of the <code>MgeFit</code> package, including four test galaxy images, is on the <a href=\"https://pypi.org/user/micappe/\">Python Package Index (PyPI)</a>. It was last updated on the 31 March 2023 and the changes are documented in the <a href=\"https://pypi.org/project/mgefit/#changelog\">CHANGELOG</a>.<p><b>How to install:</b> Use \"<code>pip install mgefit</code>\". Without write access to the global <code>site-packages</code> directory, use \"<code>pip install --user mgefit</code>\".<p><b>Usage examples:</b> are in the directory \"examples\" inside the main package folder inside <a href=\"https://stackoverflow.com/a/46071447/3753826\">site-packages</a>.<p><code>MgeFit</code> requires the scientific core packages <a href=\"https://SciPy.org/\">NumPy, SciPy and Matplotlib</a>, and the examples use <a href=\"https://www.astropy.org/\">Astropy</a> to read FITS images <font color=\"red\">(it was tested with Python 3.10 using Numpy 1.22, SciPy 1.8 and Matplotlib 3.5)</font>.<p>Also included in the <code>MgeFit</code> package is the <code>mpfit</code> implementation by <a href=\"https://ui.adsabs.harvard.edu/abs/2009ASPC..411..251M\">Markwardt (2009)</a> of the MINPACK <a href=\"https://scholar.google.co.uk/citations?view_op=view_citation&amp;citation_for_view=Ouz45LcAAAAJ:9yKSN-GCB0IC\">(Mor&eacute, Garbow & Hillstrom, 1980)</a> Levenberg-Marquardt nonlinear least-squares optimization algorithm. The <code>mpfit</code> routine was translated into Python by <a href=\"https://cars.uchicago.edu/software/python/\">Mark River</a> and updated <a href=\"https://code.google.com/p/astrolibpy/\">here</a> for NumPy by <a href=\"https://www.andrew.cmu.edu/user/skoposov/\">Sergey Koposov</a>. I modified the latter version to support Python 3 and fixed some numerical instabilities. Note that <code>MgeFit</code> uses the <code>mpfit</code> implementation instead of the <code>SciPy.optimize.least_squares</code> one, because of the ability of <code>mpfit</code> to tie parameters or keep them fixed.<p><b>NOTE: I would appreciate if you drop me an e-mail (address at the bottom) when you download the above procedures. </b><br clear=\"all\"><hr><table>    <tr>        <td rowspan=2>        <img SRC=\"jam_logo.svg\" alt=\"JAM\"  width=\"100\">        </td>        <td>            <h2 id=\"jam\">2. Jeans Anisotropic MGE (JAM) Modelling</h2>        </td>    </tr>    <tr>        <td>            <big><i><b>J</b>eans <b>A</b>nisotropic <b>M</b>GE modelling of the dynamics, stellar kinematics or proper motions of axisymmetric or spherical galaxies</i></big>        </td>    </tr></table><p><table BGCOLOR=\"white\" border=\"1\"  width=\"100%\">    <tr>        <td>            <a href=\"https://ui.adsabs.harvard.edu/abs/2016ARA%26A..54..597C\"><img SRC=\"jam_models_1.jpg\" alt=\"JAM 20 galaxies\" width=\"48.5%\"><img SRC=\"jam_models_2.jpg\" alt=\"JAM 12 galaxies\" width=\"51.5%\"></a>        </td>    </tr>    <tr>        <td>            <i><b>Figure 1:</b> Examples of JAM data-model comparisons. The bi-symmetrized SAURON stellar kinematics of 6 Elliptical (left) and 6 S0 (right) fast-rotator early-type galaxies is compared to the predictions of the anisotropic Jeans models with JAM.            The kinematics varies widely for different galaxies, yet these <b>two-parameters</b> (!) models are able to correctly predict the shape of a pair of two-dimensional functions (V and V<sub>rms</sub>), once the observed surface brightness is given (this is fig.10 of <a href=\"https://ui.adsabs.harvard.edu/abs/2016ARA%26A..54..597C\">Cappellari 2016, ARA&amp;A</a>).</i>        </td>    </tr></table><p><table BGCOLOR=\"white\" border=\"1\"  width=\"25%\" align=\"right\">    <tr>        <td>            <a href=\"https://ui.adsabs.harvard.edu/abs/2020MNRAS.494.6001N\"><img SRC=\"nitschai2020.png\" alt=\"JAM of Milky Way\" width=\"100%\"></a>        </td>    </tr>    <tr>    <td>            <i><b>Figure 5:</b> This is the first dynamical modelling (using JAM<sub>sph</sub>) of the high-quality <i>Gaia</i> DR2 kinematics of the Milky Way, with full 6D phase-space coordinates. For the first time, there are no dynamical degeneracies and the model has no freedom to fit the data, yet all features are reproduced. This is an important test of galaxy dynamics. (figure taken from <a href=\"https://ui.adsabs.harvard.edu/abs/2020MNRAS.494.6001N\">Nitschai et al. 2020</a>)</i>        </td>    </tr></table><table BGCOLOR=\"white\" border=\"1\"  width=\"25%\" align=\"right\">    <tr>        <td>            <a href=\"https://ui.adsabs.harvard.edu/abs/2015MNRAS.450..128D\"><img SRC=\"jam_bh_ngc4258.jpg\" alt=\"JAM NGC4258\" width=\"100%\"></a>        </td>    </tr>    <tr>    <td>            <i><b>Figure 4: Validating black hole (BH) recovery with JAM.</b> A detailed JAM modelling accurately recovers the \"benchmark\" BH mass in NGC4258, as inferred from maser observations (figure taken from <a href=\"https://ui.adsabs.harvard.edu/abs/2015MNRAS.450..128D\">Drehmer et al. 2015</a>). An equally good agreement was found with JAM for the \"benchmark\" BH in the Milky Way (<a href=\"https://ui.adsabs.harvard.edu/abs/2017MNRAS.466.4040F\">Sec.4.1.2 of Feldmeier-Krause et al. 2017)</a>.            Other successful BH comparisons, between JAM and Schwarzschild's method, were presented e.g. in <a href=\"https://ui.adsabs.harvard.edu/abs/2010AIPC.1240..211C\">Cappellari et al. (2010)</a>, for 25 galaxies, and <a href=\"https://ui.adsabs.harvard.edu/#abs/2018MNRAS.477.3030K/abstract\">Krajnovi&#263; et al. (2018)</a>, for 7 galaxies.</i>        </td>    </tr></table><table BGCOLOR=\"white\" border=\"1\"  width=\"25%\" align=\"right\">    <tr>        <td>            <a href=\"https://ui.adsabs.harvard.edu/abs/2020MNRAS.494.4819C\"><img SRC=\"sph_vs_cyl_jam.png\" alt=\"SPH vs CYL JAM\" width=\"100%\"></a>        </td>    </tr>    <tr>        <td>            <i><b>Figure 3:</b> The JAM package includes an implementation for both the cylindrically-aligned solution JAM<sub>cyl</sub> of <a href=\"https://ui.adsabs.harvard.edu/abs/2008MNRAS.390...71C\">Cappellari (2008)</a> and the spherically-aligned solution JAM<sub>sph</sub> of <a href=\"https://ui.adsabs.harvard.edu/abs/2020MNRAS.494.4819C\">Cappellari (2020)</a>. Comparisons between these two extreme solutions allows for a robust assessment of possible systematic modeling uncertainties (see <a href=\"https://ui.adsabs.harvard.edu/abs/2020MNRAS.494.4819C\">Cappellari 2020</a> for some examples).</i>        </td>    </tr></table><table BGCOLOR=\"white\" border=\"1\"  width=\"25%\" align=\"right\">    <tr>        <td>            <a href=\"https://ui.adsabs.harvard.edu/abs/2012arXiv1211.7009C\"><img SRC=\"jam_tensor.jpg\" alt=\"JAM tensor\" width=\"100%\"></a>        </td>    </tr>    <tr>        <td>            <i><b>Figure 2:</b> Including both proper motions and radial velocities. <b>Top Panels:</b> the components of the symmetric velocity second moment tensor measured from the particles of a realistic N-body simulation. <b>Bottom Panels:</b> the corresponding JAM model predictions. <font color=\"red\"><b>Note the striking agreement!</b></font>  <a href=\"https://ui.adsabs.harvard.edu/abs/2012arXiv1211.7009C\">(Cappellari 2012)</a></i>        </td>    </tr></table><p>The JAM software in this section can be used for the dynamical modelling of galaxies or other gravitationally-bound systems of particles.It was used e.g. to measure the mass of supermassive black holes in galaxies, to infer their dark-matter content or to measure galaxy masses and density profiles.<p>JAM implements a solution of the Jeans equations which allows for orbital anisotropy (three-integrals distribution function) and also provides the full second moment tensor, including both proper motions and radial velocities, for both axisymmetric <a href=\"https://ui.adsabs.harvard.edu/abs/2012arXiv1211.7009C\">(Cappellari 2012)</a> and spherical  geometry <a href=\"https://ui.adsabs.harvard.edu/abs/2015arXiv150405533C\">(Cappellari 2015)</a>. The technique was introduced in <a href=\"https://ui.adsabs.harvard.edu/abs/2008MNRAS.390...71C\"><font color=\"Red\"><b>Cappellari (2008)</b></font></a>, for the cylindrically-aligned case, and in <a href=\"https://ui.adsabs.harvard.edu/abs/2020MNRAS.494.4819C\"><font color=\"Red\"><b>Cappellari (2020)</b></font></a>, for the spherically-aligned case <b>(Figure 3)</b>, and I called it the <b>J</b>eans <b>A</b>nisotropic <b>M</b>odelling (JAM) method. It relies on the Multi-Gaussian Expansion parameterization (<a href=\"https://ui.adsabs.harvard.edu/abs/1994A%26A...285..723E\">Emsellem et al. 1994</a>; <a href=\"https://ui.adsabs.harvard.edu/abs/2002MNRAS.333..400C\">Cappellari 2002</a>) for the galaxy surface brightness.<p>With the addition of a single extra parameter &beta;<sub>z</sub>=1-(&sigma;<sub>z</sub>/&sigma;<sub>R</sub>)<sup>2</sup> <a href=\"https://ui.adsabs.harvard.edu/abs/2008MNRAS.390...71C\">(in cylindrical alignment)</a> or &beta;=1-(&sigma;<sub>&theta;</sub>/&sigma;<sub>r</sub>)<sup>2</sup> <a href=\"https://ui.adsabs.harvard.edu/abs/2020MNRAS.494.4819C\">(in spherical alignment)</a>, the simple and user-friendly three-integrals JAM method already provides a dramatic improvement over the classic but less general two-integrals f(E,L<sub>z</sub>) <a href=\"https://ui.adsabs.harvard.edu/abs/1922MNRAS..82..122J\">Jeans (1922)</a> models. However JAM also allows for tangential anisotropy &gamma;=1-(&sigma;<sub>&phi;</sub>/&sigma;<sub>R</sub>)<sup>2</sup> and/or for spatially varying anisotropy (different for every MGE Gaussian). The JAM models provide a remarkably good descriptions of state-of-the-art integral-field stellar kinematics of real galaxies (<b>Figure 1</b>). This makes the technique well suited to measure the inclination, the dynamical M/L and angular momenta of early-type fast-rotators and spiral galaxies.<p>The JAM routines are designed for axisymmetric or spherical geometry, (i) they can provide the proper motion dispersion tensor (<a href=\"https://ui.adsabs.harvard.edu/abs/2012arXiv1211.7009C\">Cappellari 2012</a>; <a href=\"https://ui.adsabs.harvard.edu/abs/2015arXiv150405533C\">Cappellari 2015</a>; <b>Figure 2</b>), (ii) allow for the inclusion of dark matter, (iii) variable stellar M/L, (iv) spatially varying anisotropy and (v) multiple kinematic components and (vi) supermassive black holes (BH; <b>Figure 4</b>). The JAM package also includes a routine to compute the circular velocity from the MGE models. Some sample <b>applications of the JAM method</b> are given below:<ul><li>Dynamical masses for a sample of 9 passive early-type galaxies at redshift z~2 <a href=\"https://ui.adsabs.harvard.edu/abs/2009ApJ...704L..34C\">(Cappellari et al. 2009)</a></li><li>Dark matter from stellar dynamics and gravitational lensing (<a href=\"https://ui.adsabs.harvard.edu/abs/2010ApJ...719.1481V\">van de Ven et al. 2010</a>, <a href=\"https://ui.adsabs.harvard.edu/abs/2012MNRAS.423.1073B\">Barnab&egrave;  et al. 2012</a>)</li><li>Total mass profiles from two-dimensional stellar kinematics up to 4 R<sub>e</sub> <a href=\"https://ui.adsabs.harvard.edu/abs/2015ApJ...804L..21C\">(Cappellari et al. 2015)</a></li><li>A systematic variation of the stellar IMF in 260 early-type galaxies <a href=\"https://ui.adsabs.harvard.edu/abs/2012Natur.484..485C\">(Cappellari et al. 2012, Nature)</a></li><li>Discrete dynamical models of &omega; Centauri <a href=\"https://ui.adsabs.harvard.edu/abs/2013MNRAS.436.2598W\">(Watkins et al. 2013)</a></li><li>First <i>Gaia</i> DR2 dynamical model of the Milky Way with six phase-space coordinates (<a href=\"https://ui.adsabs.harvard.edu/abs/2020MNRAS.494.6001N\">Nitschai et al. 2020</a> and <a href=\"https://ui.adsabs.harvard.edu/abs/2021ApJ...916..112N\">2021</a>).</li><li>Dynamical modelling of the final (DR17) MaNGA sample of 10K galaxies with integral-field spectroscopy <a href=\"https://ui.adsabs.harvard.edu/abs/2023MNRAS.522.6326Z\">(Zhu, Lu, Cappellari et al. 2023)</a></li><li>Time-delay cosmography from dynamical models and lensing time-delay <a href=\"https://ui.adsabs.harvard.edu/abs/2023A%26A...673A...9S\">(Shajib et al. 2023)</a></li><li>Dynamical masses for 3200 LEGA-C galaxies at redshift z~0.8 <a href=\"https://ui.adsabs.harvard.edu/abs/10.1093/mnras/stad2597\">(Cappellari 2023)</a></li></ul><p>To construct dynamical models with the JAM method one needs to describe the galaxies surface brightness via the Multi-Gaussian Expansion parametrization using my <a href=\"#mge\">MGE_FIT_SECTORS</a> package above.<p><table BGCOLOR=\"white\" border=\"1\"  width=\"25%\" align=\"right\">    <tr>        <td>            <a href=\"https://ui.adsabs.harvard.edu/abs/2019MNRAS.486.4753J\"><img SRC=\"Jin2019_Fig4.png\" alt=\"Jin et al. (2019)\" width=\"100%\"></a>        </td>    </tr>    <tr>    <td>            <i><b>Figure 7: JAM works better than Schwarzschild on simulated galaxies.</b> A detailed comparison using the <a href=\"https://www.illustris-project.org/\">Illustris</a> simulations with the JAM and Schwarzschild's (SCH) dynamical models, found that JAM recovers the known enclosed total mass within 1R<sub>e</sub> more accurately than SCH. Specifically, <font color=\"red\">the 68th percentile deviation (1&sigma; error) over all 45 model fits is 1.6&times; smaller for JAM than SCH</font> (This is Fig.4 from <a href=\"https://ui.adsabs.harvard.edu/abs/2019MNRAS.486.4753J\">Jin et al. 2019</a>).</i>        </td>    </tr></table><table BGCOLOR=\"white\" border=\"1\"  width=\"33%\" align=\"right\">    <tr>        <td>            <a href=\"https://ui.adsabs.harvard.edu/abs/2018MNRAS.477..254L\"><img SRC=\"Leung2018_Fig8.png\" alt=\"Leung et al. (2018)\" width=\"100%\"></a>        </td>    </tr>    <tr>    <td>            <i><b>Figure 6: JAM works better than Schwarzschild on real galaxies.</b> A detailed comparison, for 54 real disk galaxies with <a href=\"https://califa.caha.es/\">CALIFA</a> data, between the circular velocity V<sub>CO</sub> measured from CO gas and the corresponding V<sub>JAM</sub> and V<sub>SCH</sub> from dynamical modelling of integral-field stellar kinematics using the JAM and Schwarzschild's (SCH) methods, found that JAM recovers the densities more accurately than SCH. Specifically, between 0.8-1.6 R<sub>e</sub> (inside the red boxes), where the gas is well-resolved and V<sub>c</sub> is better determined,  <font color=\"red\">the mean 1&sigma; error is 1.7&times; smaller for JAM than SCH</font> (This is Fig.8 from <a href=\"https://ui.adsabs.harvard.edu/abs/2018MNRAS.477..254L\">Leung et al. 2018</a>).</i>        </td>    </tr></table><h3>Download the <img SRC=\"jam_logo.svg\" alt=\"JAM\"  width=\"50\" align=\"middle\"> package in <a href=\"https://www.python.org/\"><img SRC=\"python-logo.svg\" alt=\"Python\" width=\"200\"align=\"middle\"></a></h3><p>The source code of the <code>JamPy</code> package is on the <a href=\"https://pypi.org/user/micappe/\">Python Package Index (PyPI)</a>. It was last updated on the 21 July 2023 and the changes are documented in the <a href=\"https://pypi.org/project/jampy/#changelog\">CHANGELOG</a>. <p><b>How to install:</b> Use \"<code>pip install jampy</code>\". Without write access to the global <code>site-packages</code> directory, use \"<code>pip install --user jampy</code>\".<p><b>Usage examples:</b> are in the directory \"examples\" inside the main package folder in <a href=\"https://stackoverflow.com/a/46071447/3753826\">site-packages</a>.<p>Also <font color=\"red\">required</font> is my <a href=\"https://pypi.org/user/micappe/\">plotbin package</a> (automatically installed by <code>pip</code>).<p>The <code>JamPy</code> package requires the scientific core packages <a href=\"https://SciPy.org/\">NumPy, SciPy and Matplotlib</a> <font color=\"red\">(it was tested with Python 3.11 using Numpy 1.24, SciPy 1.9 and Matplotlib 3.6)</font>.<h3>Download the <img SRC=\"jam_logo.svg\" alt=\"JAM\"  width=\"50\" align=\"middle\"> source code in the C language</h3>Note that the JAM Python code is extremely well vectorized. You should <b>not</b> assume the C version will be significantly faster without benchmarking with <i>identical</i> setup.<a href=\"https://www.stsci.edu/~lwatkins/\">Laura Watkins</a> has translated the JAM procedures into the C language. Her code is available <a href=\"https://github.com/lauralwatkins/cjam\">here</a>.<p><b>NOTE: I would appreciate if you drop me an e-mail (address at the bottom) when you download the above procedures. </b><br clear=\"all\"><hr><p><table BGCOLOR=\"white\" border=\"1\"  width=\"50%\" align=\"right\">    <tr>        <td>            <a href=\"2d-binning.png\"><img SRC=\"2d-binning.png\" ALT=\"Cappellari & Copin (2003)\" WIDTH=\"100%\"></a>        </td>    </tr>    <tr>        <td>            <i><b>Left: </b><a href=\"https://en.wikipedia.org/wiki/Four_color_theorem\">Four-coloring</a> of Voronoi binning;            <b>Middle: </b>Unbinned versus Voronoi binned stellar kinematics from Integral-Field Spectroscopy <a href=\"https://ui.adsabs.harvard.edu/abs/2003MNRAS.342..345C\">(Cappellari & Copin 2003)</a>;            <b>Right: </b>Voronoi binning of abundance from X-ray data <a href=\"https://ui.adsabs.harvard.edu/abs/2004MNRAS.349..952S\">(Sanders et al. 2004)</a>.</i>        </td>    </tr></table><table>    <tr>        <td rowspan=2>            <img SRC=\"vorbin_logo.svg\" alt=\"VorBin\" width=\"100\">        </td>        <td>            <h2 id=\"binning\">3. The Voronoi binning method (VorBin)</h2>        </td>    </tr>    <tr>        <td>            <big><i>Adaptively spatial bin two-dimensional data to a constant signal-to-noise ratio per bin</i></big>        </td>    </tr></table><p>The  <b>Voronoi Binning</b> method of <a href=\"https://ui.adsabs.harvard.edu/abs/2003MNRAS.342..345C\"><font color=\"Red\"><b>Cappellari & Copin (2003, MNRAS, 342, 345)</b></font></a> optimally solves the problem of preserving the maximum spatial resolution of general two-dimensional data (or higher dimensions), given a constraint on the minimum signal-to-noise ratio.<p>The <b>Voronoi binning</b> method has been applied to a <a href=\"https://scholar.google.com/citations?view_op=view_citation&amp;citation_for_view=HODNYCEAAAAJ:2osOgNQ5qMEC\">variety</a> of types of data. A review of the concepts and applications to (i) X-ray data, (ii) integral-field spectroscopy, (iii) Fabry-Perot interferometry, (iv) N-body simulations, (v) standard images and (vi) other regularly or irregularly sampled data is given in <a href=\"https://arxiv.org/abs/0912.1303\">Cappellari (2009)</a>.<h3>Download the <img SRC=\"vorbin_logo.svg\" alt=\"VorBin\" width=\"50\" align=\"middle\"> package in <a href=\"https://www.python.org/\"><img SRC=\"python-logo.svg\" alt=\"Python\" width=\"200\"align=\"middle\"></a></h3><p>The source code of the <code>VorBin</code> package, with examples and instructions, is on the <a href=\"https://pypi.org/user/micappe/\">Python Package Index (PyPI)</a>. It was last updated on the 24 February 2022 and the changes are documented in the <a href=\"https://pypi.org/project/vorbin/#changelog\">CHANGELOG</a>.<p><b>How to install:</b> Use \"<code>pip install vorbin</code>\". Without write access to the global <code>site-packages</code> directory, use \"<code>pip install --user vorbin</code>\".<p><b>User Manual:</b> Is available on <a href=\"https://pypi.org/project/vorbin/\">THIS PAGE</a> (most up-to-date) or as <a href=\"vorbin_manual.pdf\">PDF</a>.<p><b>Usage example:</b> is in the package folder inside <a href=\"https://stackoverflow.com/a/46071447/3753826\">site-packages</a>.<p>The <code>VorBin</code> package requires the scientific core packages <a href=\"https://SciPy.org/\">NumPy, SciPy and Matplotlib</a> <font color=\"red\">(it was tested with Python 3.10 using Numpy 1.22, SciPy 1.8 and Matplotlib 3.5)</font>.<p>My optional <a href=\"https://pypi.org/user/micappe/\">plotbin package</a> contains routines to visualize Voronoi 2D-binned or unbinned data like in the figures above.<h3>Download the <img SRC=\"vorbin_logo.svg\" alt=\"VorBin\" width=\"50\" align=\"middle\"> package in <a href=\"https://julialang.org/\"><img SRC=\"julia-logo.svg\" alt=\"Julia\" width=\"100\"align=\"middle\"></a></h3>VorBin was ported to the Julia language by <a href=\"https://github.com/Michael-Reefe\">Michael Reefe</a>. You can find it <a href=\"https://github.com/Michael-Reefe/VoronoiBinning.jl\">HERE</a>.<p><b>NOTE: I would appreciate if you drop me an e-mail (address at the bottom) when you download the above procedures. </b><br clear=\"all\"><hr><table>    <tr>        <td rowspan=2>            <img SRC=\"ppxf_logo.svg\" alt=\"pPXF\" width=\"100\">        </td>        <td>            <h2 id=\"ppxf\">4. Penalized PiXel-Fitting (pPXF)</h2>        </td>    </tr>    <tr>        <td>            <big><i>Stellar or gas kinematics and stellar population from galaxy spectra via full spectrum fitting with photometry</i></big>        </td>    </tr></table><p><table BGCOLOR=\"white\" border=\"1\"  width=\"50%\" align=\"right\">    <tr>        <td><a href=\"https://ui.adsabs.harvard.edu/abs/2017MNRAS.466..798C\"><img SRC=\"ppxf_fit.png\" alt=\"pPXF Fit\" width=\"100%\"></a></td></tr>    <tr>        <td><b>Figure 1: Stellar and gas kinematics fit with pPXF.</b><i>The black line (mostly hidden by the fit) is the relative flux of the observed spectrum. The red line is the pPXF fit for the stellar component, while the orange line is a fit to the gas emission lines. The green symbols at the bottom are the fit residuals, while the blue lines is the gas-only best-fitting spectrum. The main absorption and emission features are indicated at the top of the plot (taken from <a href=\"https://ui.adsabs.harvard.edu/abs/2017MNRAS.466..798C\">Cappellari 2017</a>).</i>        </td>    </tr></table><p>This software implements the Penalized PiXel-Fitting method (pPXF) to extract the stellar or gas kinematics and stellar population from absorption-line spectra of galaxies, using a  maximum penalized likelihood approach. The method was originally described in <a href=\"https://ui.adsabs.harvard.edu/abs/2004PASP..116..138C\">Cappellari & Emsellem (2004)</a> and was significantly upgraded in subsequent years and particularly in <a href=\"https://ui.adsabs.harvard.edu/abs/2017MNRAS.466..798C\">Cappellari (2017)</a> and with the inclusion of photometry and linear constraints in <a href=\"https://ui.adsabs.harvard.edu/abs/10.1093/mnras/stad2597\"><font color=\"Red\"><b>Cappellari (2023)</b></font></a>. The method is very general and robust. For this reason it was applied to a variety of situations. The following key features are implemented in the current pPXF program:<ul><li> <b>Optimal template:</b> Fitted together with the kinematics to minimize template-mismatch errors. Also useful to extract gas kinematics or derive emission-corrected line-strengths indexes. One can use synthetic templates to study the stellar population of galaxies via \"Full-Spectrum Fitting\" instead of using traditional line-strengths;</li><li><b>Regularization of templates weights:</b> To reduce the noise in the recovery of the stellar population parameters and attach a physical meaning to the output weights assigned to the templates in term of the star formation history (SFH) or metallicity distribution of an individual galaxy;</li><li><b>Multiple gaseous/stellar components:</b> Each template in pPXF can be assigned to a different kinematic component, with a different LOSVD <a href=\"https://ui.adsabs.harvard.edu/abs/2013MNRAS.428.1296J\">(Johnston et al. 2013)</a>. This allows one to extract multiple kinematic components and to fit the gas emission lines together with the stellar kinematics and population; Penalization applies to both gas and stars and regularization can still be enforced to the stellar templates;</li><li><b>Kinematic bulge/disk decomposition:</b> One can enforce a ratio between the flux of two kinematic components, e.g. to try to infer the kinematic of bulge and disk components <a href=\"https://ui.adsabs.harvard.edu/abs/2017MNRAS.466.2024T\">(Tabor et al. 2017)</a>;</li><li><b>Linear constraints on templates or kinematics:</b> One can enforce general linear constraints on either the stellar templates (e.g. require the total weights in one kinematic component to be large than a certain fraction) or the kinematic parameters (e.g. requiring the dispersion of one kinematic component to be larger than a certain fraction of that of another component).</li><li><b>Iterative sigma clipping:</b> To clean the spectra from residual bad pixels or cosmic rays;</li><li><b>Two-sided LOSVD fitting:</b> To reduce systematic errors in the kinematics, using two spectra taken at the opposite sides of the galaxy nucleus<a href=\"https://ui.adsabs.harvard.edu/abs/1992MNRAS.254..389R\">(Rix & White 1992, Sec.3.6)</a>;</li><li><b>Additive/multiplicative polynomials:</b> To correct low frequency continuum variations. Also useful for calibration purposes;</li><li><b>Inclusion of sky spectrum:</b> To deal with spectra heavily contaminated by the sky spectrum <a href=\"https://ui.adsabs.harvard.edu/abs/2009MNRAS.398..561W\">(Weijmans et al. 2009, Sec.3.1)</a>;</li><li><b>Reddening fit:</b> To determine the reddening of the spectrum using the extinction curve of <a href=\"https://ui.adsabs.harvard.edu/abs/2000ApJ...533..682C\">Calzetti et al. (2000)</a>;</li><li><b>Inclusion of covariance matrix:</b> To account for correlated errors in the spectral pixels (e.g. due to rebinning and interpolations).</li></ul><p>See <a href=\"https://ui.adsabs.harvard.edu/abs/2004MNRAS.352..721E\">Emsellem et al. (2004, SAURON)</a>, <a href=\"https://ui.adsabs.harvard.edu/abs/2011MNRAS.413..813C\">Cappellari et al. (2011, ATLAS<sup>3D</sup>)</a>, <a href=\"https://ui.adsabs.harvard.edu/abs/2017A%26A...597A..48F\">Falcon-Barroso et al. (2017, CALIFA)</a>, <a href=\"https://ui.adsabs.harvard.edu/abs/2017ApJ...835..104V\">van de Sande et al. (2017, SAMI)</a> and <a href=\"https://ui.adsabs.harvard.edu/abs/2019AJ....158..231W\">Westfall et al. (2019, MaNGA)</a> for some ever increasing large-scale applications of the pPXF method to the measurement of the stellar or gas kinematics of galaxies. <a href=\"https://ui.adsabs.harvard.edu/abs/2009ApJ...704L..34C\">Cappellari et al. (2009)</a> demonstrates the use of pPXF to measure the stellar velocity dispersion of a sample of passive galaxies at redshift z~2.<h3>Libraries of stellar templates for stars/gas kinematics with <img SRC=\"ppxf_logo.svg\" alt=\"pPXF\" width=\"50\" align=\"middle\"></h3><p>The ability of the pPXF method to fit a large set of stellar templates together with the kinematics allows the template mismatch problem to be virtually eliminated. This is particularly useful given the current availability of large stellar libraries spanning  wide ranges of physical parameters and having good spectral resolution. Excellent results have been obtained by using a few hundred template stars with pPXF, from which generally about 10-20 are selected by the program to provide detailed fits to high S/N galaxy spectra. An extensive account of the available stellar libraries is maintained by <a href=\"https://www.ucm.es/info/Astrof/invest/actividad/spectra.html\">David Montes</a>. An incomplete list of libraries that have been successfully used with pPXF for the kinematics extraction is given below:<ul><li><a href=\"https://www.noao.edu/cflib/\">Indo-U.S. Coud&eacute; Feed Spectral Library</a>: 1273 stars covering the region from 3460 - 9464 &#197 at a spectral resolution of <a href=\"https://ui.adsabs.harvard.edu/abs/2011A%26A...531A.109B\"> 1.35 &#197</a> (FWHM), &sigma;~30 km/s, R~4200. From<a href=\"https://ui.adsabs.harvard.edu/abs/2004ApJS..152..251V\">Valdes et al. (2004)</a></li><li><a href=\"https://www.ucm.es/info/Astrof/ellipt/CATRIPLET.html\">Ca II triplet</a>: 706 stars covering the region from 8348 - 9020 &#197 at a spectral resolution of 1.5 &#197 (FWHM), &sigma;~22 km/s, R~5700. From<a href=\"https://ui.adsabs.harvard.edu/abs/2001MNRAS.326..959C\">Cenarro et al. (2001)</a></li><li><a href=\"https://perso.astrophy.u-bordeaux.fr/CSoubiran/elodie_library.html\">ELODIE</a>: 1388 stars covering the region from 4000 - 6800 &#197 at a spectral resolution of 0.5 &#197 (FWHM), &sigma;~13 km/s, R~10,000. From<a href=\"https://ui.adsabs.harvard.edu/abs/2001A%26A...369.1048P\">Prugniel and Soubiran (2001)</a></li><li><a href=\"https://miles.iac.es/\">MILES Library of Stellar Spectra</a>: 985 well-calibrated stars covering the region from 3525 - 7500 &#197 at a spectral resolution of <a href=\"https://ui.adsabs.harvard.edu/abs/2011A%26A...532A..95F\"> 2.51 &#197</a> (FWHM), &sigma;~64 km/s, R~2000. From<a href=\"https://ui.adsabs.harvard.edu/abs/2006MNRAS.371..703S\">S&aacute;nchez-Bl&aacute;zquez, et al. (2006)</a> and <a href=\"https://ui.adsabs.harvard.edu/abs/2011A%26A...532A..95F\">Falc&oacute;n-Barroso et al. (2011)</a>.</li><li><a href=\"https://www.sdss.org/dr15/mastar/\">MaStar Stellar Library</a>: 10K well-calibrated stars covering the region from 3,622 - 10,354 &#197 at a spectral resolution of 3.5 &#197 (FWHM), &sigma;~70 km/s, R~1800. From<a href=\"https://ui.adsabs.harvard.edu/abs/2019ApJ...883..175Y\">Yan, et al. (2019)</a>.</li><li><a href=\"https://xsl.u-strasbg.fr/\">X-Shooter Spectral Library</a>: 683 stars covering three segments from 3,000 - 24,500 &#197 at a spectral resolution with &sigma;~13 km/s, R~10,000. From <a href=\"https://ui.adsabs.harvard.edu/abs/2022A%26A...660A..34V\">Verro, et al. (2022)</a>.</li><li><a href=\"https://www.gemini.edu/sciops/instruments/nearir-resources/?q=node/10167\">GNIRS library of  late spectral templates</a>: 40 stars with a range of CO equivalent widths, covering the K-band region from 2.18 - 2.43 &mu;m at a spectral resolution of 3.4 &#197 (FWHM), &sigma;~19 km/s, R~6600. From<a href=\"https://ui.adsabs.harvard.edu/abs/2009ApJS..185..186W\">Winge et al. (2009)</a></li><li><a href=\"https://marcs.astro.uu.se/\">MARCS <b>synthetic</b> library</a> of stellar spectra covering the wavelength region from 1300 &#197 to 20 &mu;m at a spectral resolution of &sigma;=6.4 km/s, R=20,000. This is not as reliable as an empirical stellar library but it can be very useful in special situations, due to the wide wavelength coverage and high spectral resolution. From <a href=\"https://ui.adsabs.harvard.edu/abs/2008A%26A...486..951G\">Gustafsson et al. (2008)</a></li><li><a href=\"https://cdsarc.u-strasbg.fr/viz-bin/qcat?J/A+A/442/1127\">SYNTHE <b>synthetic</b> library</a> of stellar spectra covering the wavelength region from 2500 &#197 to 1.05 &mu;m at a spectral resolution of &sigma;=6.4 km/s, R=20,000. The same caveats and advantages apply to this synthetic library as to the previous one.  From <a href=\"https://ui.adsabs.harvard.edu/abs/2005A%26A...442.1127M\">Munari et al. (2005)</a></li></ul><p><table BGCOLOR=\"white\" border=\"1\"  width=\"100%\">    <tr>        <td width=\"25%\">        <a href=\"https://ui.adsabs.harvard.edu/abs/2015MNRAS.448.3484M\"><img SRC=\"mcdermid15.jpg\" ALT=\"star formation history with pPXF\" WIDTH=\"100%\"></a>        </td>        <td width=\"40%\">        <a href=\"ppxf_population_gas_2.png\"><img SRC=\"ppxf_population_gas_2.png\" ALT=\"pPXF for Population\" WIDTH=\"100%\"></a>        </td>        <td width=\"30%\">        <a href=\"https://ui.adsabs.harvard.edu/abs/2022arXiv220814974C\"><img SRC=\"ppxf_legac.png\" ALT=\"pPXF LEGA-C\" WIDTH=\"100%\"></a>        </td>    </tr>    <tr>        <td>        <i><b>Figure 2: Star-formation history with pPXF.</b> The plot shows the star-formation history of ATLAS<SUP>3D</SUP> galaxies, in bins of different galaxy stellar mass. This was recovered with pPXF using regularization (taken from <a href=\"https://ui.adsabs.harvard.edu/abs/2015MNRAS.448.3484M\">McDermid et al. 2015</a>).        </i>        </td>        <td>        <i><b>Figure 3: Population and gas with pPXF.</b> The plots show the pPXF fit to a <a href=\"https://www.sdss.org/dr13/manga/\">MaNGA</a> spectra for the spiral galaxy <a href=\"https://skyservice.pha.jhu.edu/DR13/ImgCutout/getjpeg.aspx?ra=143.740010&amp;dec=21.705270&amp;width=400&amp;height=400\">NGC2916</a> (from <a href=\"https://www.sdss.org/dr13/\">SDSS DR13</a>). The \"Mass Fraction\" map show the pPXF solution in different age and metallicity intervals. The <b>Left Map</b> has no regularization and is noisy as the population inverse problem is ill-posed. Regularization is a standard approach to solve ill-posed problems <a href=\"https://ui.adsabs.harvard.edu/abs/2017MNRAS.466..798C\">(see Cappellari 2017, Sec.3.5)</a>. The <b>Right Map</b> show the regularized solution. The fit used 24(Ages)&times;6([M/H])=144 <a href=\"https://miles.iac.es/\">MILES</a> population templates by <a href=\"https://ui.adsabs.harvard.edu/abs/2010MNRAS.404.1639V\">Vazdekis et al. (2010)</a>, and 12 gas emission lines.</i>        </td>        <td>        <i><b>Figure 4: Spectra and photometry with pPXF.</b> The <b>top panel</b> show a fit to the 28-bands COSMOS photometry for a galaxy in the <a href=\"https://ui.adsabs.harvard.edu/abs/2021ApJS..256...44V\">LEGA-C survey</a> at redshift z&sim;0.7. The grey band indicates where the spectrum is also available. The <b>middle panel</b> is the fit to the spectrum and gas emission. The <b>bottom panel</b> shows the recovered star formation history (SFH) using 43(Ages)&times;9([M/H])=387 <a href=\"https://github.com/cconroy20/fsps\">FSPS</a> population templates (taken from <a href=\"https://ui.adsabs.harvard.edu/abs/2022arXiv220814974C\">Cappellari 2022</a>).</i>        </td>    </tr></table><h3>Libraries of models for stellar-population with <img SRC=\"ppxf_logo.svg\" alt=\"pPXF\" width=\"50\" align=\"middle\"></h3><p>pPXF is the most efficient, reliable and flexible public implementation of the so called \"Full-Spectrum Fitting\" method to study stellar populations. This technique has replaced the traditional use of line-strength indices, due to the availability of high-quality model spectra.pPXF was designed to be independent on any specific set of stellar-population models and has already been used with nearly every available one. An usage example, using the Vazdekis's models, is included with permission in the pPXF package. This can be easily adapted by users to employ pPXF with other stellar-population models. An incomplete list of the main stellar population models that were used with pPXF is the following:<ul><li>GALAXEV <a href=\"https://ui.adsabs.harvard.edu/abs/2003MNRAS.344.1000B\">Bruzual & Charlot 2003</a></li><li><a href=\"https://ui.adsabs.harvard.edu/abs/2010MNRAS.404.1639V\">Vazdekis et al. 2010</a></li><li><a href=\"https://ui.adsabs.harvard.edu/abs/2011MNRAS.418.2785M\">Maraston & Stromback 2011</a></li><li>FSPS <a href=\"https://ui.adsabs.harvard.edu/abs/2009ApJ...699..486C\">Conroy et al. 2009</a></li><li>BPASS <a href=\"https://ui.adsabs.harvard.edu/abs/2018MNRAS.479...75S\">Stanway & Eldridge 2018</a></li></ul><p>pPXF allows one to extract multiple kinematic components, with different stellar populations, from a spectrum. Gas emission lines can be fitted simultaneously, avoiding the need for masking them. This is particularly useful when studying the stellar population of galaxies with prominent emission lines (e.g. the Balmer lines) filling important absorption features (see <b>Figures 1 and 3</b>).<p><font color=\"Red\"><b>Please also cite the source of the <a href=\"https://miles.iac.es/\">E-MILES</a> stellar population models <a href=\"https://ui.adsabs.harvard.edu/abs/2016MNRAS.463.3409V\">(Vazdekis et al. 2016)</a> if you use pPXF with the included library of spectral templates.</b></font><p>A number of similar, but less optimized and less general implementations of the Full Spectrum Fitting method exist (e.g. STARLIGHT by <a href=\"https://ui.adsabs.harvard.edu/abs/2005MNRAS.358..363C\">Cid Fernandes et al. 2005</a>; STECMAP by <a href=\"https://ui.adsabs.harvard.edu/abs/2006MNRAS.365...46O\">Ocvirk, et al. 2006</a>; VESPA  by <a href=\"https://ui.adsabs.harvard.edu/abs/2007MNRAS.381.1252T\">Tojeiro et al. 2007</a>).A major limitation of most available codes is that they ignore the fact that the recovery of the star formation history and chemical composition distribution from the galaxy spectra is an ill-posed problem. A standard technique to solve ill-posed problems is regularization <a href=\"https://ui.adsabs.harvard.edu/abs/2017MNRAS.466..798C\">(see Cappellari 2017, Sec.3.5)</a>, which is invoked in pPXF via the keyword REGUL. Regularization is essential to make sense of the derived star formation histories and to explore model degeneracies (see <b>Figure 2 and 3</b>). The regularized solution has a simple Bayesian interpretation: it represents the most likely solution for the weights, given an adjustable prior on the amplitude of the fluctuations.<p>See <a href=\"https://ui.adsabs.harvard.edu/abs/2012Natur.484..485C\">Cappellari et al. (2012, Nature)</a> for an early pPXF study of the M/L and IMF of stellar populations.<h3>Download the <img SRC=\"ppxf_logo.svg\" alt=\"pPXF\" width=\"50\" align=\"middle\"> package in <a href=\"https://www.python.org/\"><img SRC=\"python-logo.svg\" alt=\"Python\" width=\"200\"align=\"middle\"></a></h3><p>The source code of the <code>ppxf</code> package, with examples and instructions, is on the <a href=\"https://pypi.org/user/micappe/\">Python Package Index (PyPI)</a>. It was last updated on the 6 July 2023 and the changes are documented in the <a href=\"https://pypi.org/project/ppxf/#changelog\">CHANGELOG</a>.<p><b>How to install:</b> Use \"<code>pip install ppxf</code>\". Without write access to the global <code>site-packages</code> directory, use \"<code>pip install --user ppxf</code>\".<p><b>User Manual:</b> Detailed documentation is on <a href=\"https://pypi.org/project/ppxf/\" target=\"_blank\">THIS PAGE</a> (always up to date) or from here as PDF <a href=\"ppxf_manual.pdf\" target=\"_blank\">ppxf_manual.pdf</a>. <p><b>Usage examples:</b> <a href=\"https://github.com/micappe/ppxf_examples\"><img SRC=\"jupyter_logo.svg\" alt=\"Jupyter\" width=\"50\" align=\"middle\"></a> Notebooks <code>ppxf</code> examples are available <a href=\"https://github.com/micappe/ppxf_examples\" target=\"_blank\">HERE</a>. Python examples are in the directory \"examples\" inside the main <code>ppxf</code> package folder inside <a href=\"https://stackoverflow.com/a/46071447/3753826\">site-packages</a>.<p><code>ppxf</code> requires the scientific core packages <a href=\"https://SciPy.org/\">NumPy, SciPy and Matplotlib</a>, and the examples use <a href=\"https://www.astropy.org/\">Astropy</a> to read FITS data <font color=\"red\">(it was tested with Python 3.10 using Numpy 1.22, SciPy 1.8 and Matplotlib 3.5)</font>.<p><b>NOTE: I would appreciate if you drop me an e-mail (address at the bottom) when you download the above procedures. </b><br clear=\"all\"><hr><p><table BGCOLOR=\"white\" border=\"1\"  width=\"35%\" align=\"right\">    <tr>        <td><img SRC=\"kin_pa.jpg\" alt=\"Kin PA\" width=\"100%\"></td></tr>    <tr>        <td><i>Best fitting symmetrized kinematics of NGC 2974</i>        </td>    </tr></table><h2 id=\"pafit\">5. Fit kinematic PA</h2><big><i>Fit the global kinematic position-angle of galaxies</i></big><p>This software implements the method presented in Appendix C of <a href=\"https://ui.adsabs.harvard.edu/abs/2006MNRAS.366..787K\"><font color=\"red\"><b>Krajnovic et al. (2006, MNRAS, 366, 787)</b></font></a> to measure the global kinematic position-angle (PA) from integral field observations of a galaxy stellar or gas kinematics.<p>See <a href=\"https://ui.adsabs.harvard.edu/abs/2007MNRAS.379..418C\">Cappellari et al. (2007)</a> and <a href=\"https://ui.adsabs.harvard.edu/abs/2011MNRAS.414.2923K\">Krajnovic et al. (2011)</a> for two large scale application of this software to the study of the stellar kinematical misalignment of early-type galaxies.See Davor's Krajnovic page for the related<a href=\"https://www.aip.de/en/members/davor-krajnovic/kinemetry/\">Kinemetry</a> package.<h3>The <code>PaFit</code> package in <a href=\"https://www.python.org/\"><img SRC=\"python-logo.svg\" alt=\"Python\" width=\"200\"align=\"middle\"></a></h3><p>The <code>PaFit</code> package is on the <a href=\"https://pypi.org/user/micappe/\">Python Package Index (PyPI)</a>. It was last updated on the 3 April 2023.<p><b>How to install:</b> Use \"<code>pip install pafit</code>\". Without write access to the global <code>site-packages</code> directory, use \"<code>pip install --user pafit</code>\".<p>Also <font color=\"red\">required</font> is my <a href=\"https://pypi.org/user/micappe/\">plotbin package</a> (automatically installed by <code>pip</code>).<p><code>PaFit</code> requires the scientific core packages <a href=\"https://SciPy.org/\">NumPy and Matplotlib</a> <font color=\"red\">(it was tested with Python 3.10 using Numpy 1.22 and Matplotlib 3.5)</font>.<p><b>NOTE: I would appreciate if you drop me an e-mail (address at the bottom) when you download FIT_KINEMATIC_PA. </b><br clear=\"all\"><hr><p><table BGCOLOR=\"white\" border=\"1\"  width=\"35%\" align=\"right\">    <tr>        <td><img SRC=\"lts_linefit.jpg\" ALT=\"lts_linefit\" width=\"100%\"></td></tr>    <tr>        <td><i><b>Figure 1:</b> Fitting of the (M/L)-&sigma; relation in the Virgo cluster using <code>LTS_LINEFIT</code> <a href=\"https://ui.adsabs.harvard.edu/abs/2013MNRAS.432.1709C\">(taken from Cappellari et al. 2013a)</a>. The green outliers above the relation are automatically removed from the fit. They turn out to be background galaxies and for this reason they do not follow the cluster relation.</i>        </td>    </tr></table><h2 id=\"lts\">6. Robust linear regression with scatter in one or two dimensions</h2><big><i>Fit lines and planes to data with errors in all variables, possible outliers and intrinsic scatter</i></big><p>This software implements the method presented in Sec. 3.2 of <a href=\"https://ui.adsabs.harvard.edu/abs/2013MNRAS.432.1709C\"><font color=\"red\"><b>Cappellari et al. (2013a, MNRAS, 432, 1709)</b></font></a> to to perform extremely robust fit of lines or planes to data with errors in all variables, possible large outliers (bada data) and unknown intrinsic scatter.<p>The code combines the Least Trimmed Squares (LTS) robust technique, proposed by <a href=\"https://scholar.google.co.uk/citations?view_op=view_citation&amp;citation_for_view=5LMM6rsAAAAJ%3AY0-TYkg6YM4C\">Rousseeuw (1984)</a> and speeded up in <a href=\"https://scholar.google.co.uk/citations?view_op=view_citation&amp;citation_for_view=5LMM6rsAAAAJ:WF5omc3nYNoC\"> Rousseeuw & Van Driessen (2006)</a>, into a least-squares fitting algorithm which allows for intrinsic scatter and errors in all coordinates. This method makes the fit converge to the correct solution even in the presence of a large number of catastrophic outliers (like in <b>Figure 1</b>), where the much simpler &sigma;-clipping approach can converge to the wrong solution.<h3>The <code>LtsFit</code> package in <a href=\"https://www.python.org/\"><img SRC=\"python-logo.svg\" alt=\"Python\" width=\"200\"align=\"middle\"></a></h3><p>The <code>LtsFit</code> package is on the <a href=\"https://pypi.org/user/micappe/\">Python Package Index (PyPI)</a>. It was last updated on the 20 July 2023.<p><b>How to install:</b> Use \"<code>pip install ltsfit</code>\". Without write access to the global <code>site-packages</code> directory, use \"<code>pip install --user ltsfit</code>\".<p><b>Usage examples:</b> are in the directory \"examples\" inside the main package folder inside <a href=\"https://stackoverflow.com/a/46071447/3753826\">site-packages</a>.<p><code>LtsFit</code> requires the scientific core packages <a href=\"https://SciPy.org/\">NumPy, SciPy and Matplotlib</a> <font color=\"red\">(it was tested with Python 3.10 using Numpy 1.22, SciPy 1.8 and Matplotlib 3.5)</font>.<p><b>NOTE: I would appreciate if you drop me an e-mail (address at the bottom) when you download <code>LTS_LINEFIT</code> and <code>LTS_PLANEFIT</code>.</b><br clear=\"all\"><hr><p><table BGCOLOR=\"white\" border=\"1\"  width=\"45%\" align=\"right\">    <tr>        <td><img SRC=\"loess.jpg\" alt=\"LOESS\" width=\"100%\"></td></tr>    <tr>        <td><i>Application of the <code>CAP_LOESS_2D</code> routine (with FRAC=0.6) to the recovery of two underlying functions from a noisy distribution of 200 scattered values. For comparison, the right panels show the distribution obtained via simple averaging on a grid, but using 100&times; more values than the ones used for the LOESS recovery. The LOESS approach achieves a comparable result while requiring a much smaller number of input values.</i>        </td>    </tr></table><h2 id=\"loess\">7. Adaptive LOESS smoothing in one or two dimensions</h2><big><i>Recover mean trends from noisy data in one or two dimension</i></big><p>This software provides an improved implementation of the one-dimensional <a href=\"https://scholar.google.co.uk/citations?view_op=view_citation&amp;citation_for_view=ds52UHcAAAAJ:u5HHmVD_uO8C\">(Cleveland 1979)</a> and two-dimensional <a href=\"https://scholar.google.co.uk/citations?view_op=view_citation&amp;citation_for_view=ds52UHcAAAAJ:u-x6o8ySG0sC\">(Cleveland & Devlin 1988)</a> Locally Weighted Regression (LOESS) method to recover the mean trends of the population from noisy data in one or two dimensions. It includes a robust approach to deal with outliers (bad data).<p>These programs were implemented and used to produce the two-dimensional maps and the one-dimensional mean trends in <a href=\"https://ui.adsabs.harvard.edu/abs/2013MNRAS.432.1862C\"><font color=\"Red\"><b>Cappellari et al. (2013b, MNRAS, 432, 1862)</b></font></a>.<h3>The <code>loess</code> package in <a href=\"https://www.python.org/\"><img SRC=\"python-logo.svg\" alt=\"Python\" width=\"200\"align=\"middle\"></a></h3><p>The <code>loess</code> package is on the <a href=\"https://pypi.org/user/micappe/\">Python Package Index (PyPI)</a>. It was last updated on the 31 Jan 2022 <font color=\"red\">(it was tested with Python 3.10 using Numpy 1.22 and Matplotlib 3.5)</font>.<p><b>How to install:</b> Use \"<code>pip install loess</code>\". Without write access to the global <code>site-packages</code> directory, use \"<code>pip install --user loess</code>\".<p><b>Usage examples:</b> are in the directory \"examples\" inside the main package folder inside <a href=\"https://stackoverflow.com/a/46071447/3753826\">site-packages</a>.<p>Also <font color=\"red\">required</font> to run the 2D example is my <a href=\"https://pypi.org/user/micappe/\">plotbin package</a> (automatically installed by <code>pip</code>).<p><b>NOTE: I would appreciate if you drop me an e-mail (address at the bottom) when you download the code.</b><br clear=\"all\"><hr><p><table BGCOLOR=\"white\" border=\"1\"  width=\"33%\" align=\"right\">    <tr>        <td><img SRC=\"corner_plot.png\" ALT=\"corner_plot\" width=\"100%\"></td></tr>    <tr>        <td><i><b>Figure 1:</b> Corner plot for the posterior of the model parameters obtained when fitting the black hole mass in the galaxy NGC1277 using the <code>jam</code> modelling method and the <code>AdaMet</code> Bayesian code <a href=\"https://ui.adsabs.harvard.edu/abs/2018MNRAS.477.3030K\">(taken from Krajnovic et al. 2018)</a>. The Python code to produce this figure is included in the <code>JamPy</code> package <a href=\"#jam\">above</a>.</i>        </td>    </tr></table><h2 id=\"adamet\">8. Adaptive Metropolis (AdaMet) for Bayesian analysis</h2><big><i>A Python package for efficient Bayesian analysis</i></big><p>This <code>AdaMet</code> package is the implementation of <a href=\"https://ui.adsabs.harvard.edu/abs/2013MNRAS.432.1709C\"><font color=\"Red\"><b>Cappellari et al. (2013a, MNRAS, 432, 1709)</b></font></a> of the Adaptive Metropolis algorithm of <a href=\"https://scholar.google.co.uk/citations?view_op=view_citation&amp;citation_for_view=p-y1OBgAAAAJ:u5HHmVD_uO8C\">Haario (2001)</a>. In many real-world applications, it was found to be more efficient and robust than the <a href=\"https://github.com/dfm/emcee\"><code>emcee</code></a> approach, whose warm-up phase scales linearly with the number of walkers. For this reason, and because of its didactic value, the <code>AdaMet</code> code is provided here as an alternative.<h3>The <code>AdaMet</code> package in <a href=\"https://www.python.org/\"><img SRC=\"python-logo.svg\" alt=\"Python\" width=\"200\"align=\"middle\"></a></h3><p>The user-friendly <code>AdaMet</code> package is on the <a href=\"https://pypi.org/user/micappe/\">Python Package Index (PyPI)</a>. It was last updated on the 6 October 2020  <font color=\"red\">(it was tested with Python 3.10 using Numpy 1.22 and Matplotlib 3.5)</font>.<p><b>How to install:</b> Use \"<code>pip install adamet</code>\". Without write access to the global <code>site-packages</code> directory, use \"<code>pip install --user adamet</code>\".<p><b>Usage examples:</b> are in the directory \"examples\" inside the main package folder inside <a href=\"https://stackoverflow.com/a/46071447/3753826\">site-packages</a>.<p>Also <font color=\"red\">required</font> for plotting is my <a href=\"https://pypi.org/user/micappe/\">plotbin package</a> (automatically installed by <code>pip</code>).<br clear=\"all\"><hr><p>Comments and suggestions are welcome to the address<font color=\"blue\">michele.cappellari<span style=\"display:none\">best</span>@physics.ox.ac.uk</font><p><i>Latest changes: 4/Sep/2023</i><p><i>Go back to Michele Cappellari <a href=\"/~cappellari/\">Homepage</a></i><p>    <a href=\"https://validator.w3.org/check?uri=https://www-astro.physics.ox.ac.uk/~cappellari/software\"><img      src=\"https://www.w3.org/Icons/valid-html40\" alt=\"Valid HTML 4.0 Transitional\" height=\"31\" width=\"88\"></a> </p><!-- Start of StatCounter Code for Default Guide --><script type=\"text/javascript\">var sc_project=11284218;var sc_invisible=1;var sc_security=\"9a9f0d4d\";var scJsHost = ((\"https:\" == document.location.protocol) ?\"https://secure.\" : \"https://www.\");document.write(\"<sc\"+\"ript type='text/javascript' src='\" +scJsHost+\"statcounter.com/counter/counter.js'></\"+\"script>\");</script><noscript><div class=\"statcounter\"><a title=\"web analytics\"href=\"https://statcounter.com/\" target=\"_blank\"><imgclass=\"statcounter\"src=\"//c.statcounter.com/11284218/0/9a9f0d4d/1/\" alt=\"webanalytics\"></a></div></noscript><!-- End of StatCounter Code for Default Guide --></body></html>",
  "embeddings": []
}