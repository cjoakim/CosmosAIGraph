{
  "libtype": "npm",
  "libname": "c8js",
  "url": "https://origin-1.github.io/c8js/",
  "html": "<!DOCTYPE html><html lang=\"en-US\">  <head>    <meta charset=\"UTF-8\"><!-- Begin Jekyll SEO tag v2.8.0 --><title>c8js</title><meta name=\"generator\" content=\"Jekyll v3.9.3\" /><meta property=\"og:title\" content=\"c8js\" /><meta property=\"og:locale\" content=\"en_US\" /><link rel=\"canonical\" href=\"https://origin-1.github.io/c8js/\" /><meta property=\"og:url\" content=\"https://origin-1.github.io/c8js/\" /><meta property=\"og:site_name\" content=\"c8js\" /><meta property=\"og:type\" content=\"website\" /><meta name=\"twitter:card\" content=\"summary\" /><meta property=\"twitter:title\" content=\"c8js\" /><script type=\"application/ld+json\">{\"@context\":\"https://schema.org\",\"@type\":\"WebSite\",\"headline\":\"c8js\",\"name\":\"c8js\",\"url\":\"https://origin-1.github.io/c8js/\"}</script><!-- End Jekyll SEO tag -->    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\">    <link rel=\"preload\" href=\"https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap\" as=\"style\" type=\"text/css\" crossorigin>    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">    <meta name=\"theme-color\" content=\"#157878\">    <meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black-translucent\">    <link rel=\"stylesheet\" href=\"/c8js/assets/css/style.css?v=64b816b75416059e4097cf2e62fd7d057e2cabf9\">    <!-- start custom head snippets, customize with your own _includes/head-custom.html file --><!-- Setup Google Analytics --><!-- You can set your favicon here --><!-- link rel=\"shortcut icon\" type=\"image/x-icon\" href=\"/c8js/favicon.ico\" --><!-- end custom head snippets -->  </head>  <body>    <a id=\"skip-to-content\" href=\"#content\">Skip to the content.</a>    <header class=\"page-header\" role=\"banner\">      <h1 class=\"project-name\">c8js</h1>      <h2 class=\"project-tagline\"> </h2>              <a href=\"https://github.com/origin-1/c8js\" class=\"btn\">View on GitHub</a>                </header>    <main id=\"content\" class=\"main-content\" role=\"main\">      <h1 id=\"c8js\">c8js</h1><p>A modern, asynchronous Node.js API for <a href=\"https://github.com/bcoe/c8\">c8</a>.</p><p><a href=\"https://www.npmjs.com/package/c8js\"><img src=\"https://img.shields.io/npm/v/c8js?logo=npm\" alt=\"npm version\" /></a></p><p>c8 leverages Node.js built-in <a href=\"https://v8.dev/blog/javascript-code-coverage\">V8 JavaScript code coverage</a> to produce <a href=\"https://istanbul.js.org/\">Istanbul</a>-compatible reports.</p><p>c8js offers a usable API to access all c8 commands programmatically in Node.js with JavaScript functions.</p><p>c8js is not a wrapper around the command line interface: it calls c8 library functions in the current thread instead of spawning an instrumenter process.</p><p><img src=\"/c8js/comparison.svg\" alt=\"Comparison without/with c8js\" /></p><h2 id=\"installation\">Installation</h2><p>Use <a href=\"https://docs.npmjs.com/cli/install\"><code class=\"language-plaintext highlighter-rouge\">npm install</code></a>:</p><p><code class=\"language-plaintext highlighter-rouge\">npm i -D c8js</code></p><h2 id=\"usage\">Usage</h2><p>c8js exports the functions <a href=\"https://origin-1.github.io/c8js/modules.html#default\"><code class=\"language-plaintext highlighter-rouge\">c8js</code></a> (the default export), <a href=\"https://origin-1.github.io/c8js/modules.html#report\"><code class=\"language-plaintext highlighter-rouge\">report</code></a>, and <a href=\"https://origin-1.github.io/c8js/modules.html#checkcoverage\"><code class=\"language-plaintext highlighter-rouge\">checkCoverage</code></a>, in place of the commands <code class=\"language-plaintext highlighter-rouge\">c8</code>, <code class=\"language-plaintext highlighter-rouge\">c8 report</code>, and <code class=\"language-plaintext highlighter-rouge\">c8 check-coverage</code> respectively.Additionally, c8js exports the function <a href=\"https://origin-1.github.io/c8js/modules.html#exec\"><code class=\"language-plaintext highlighter-rouge\">exec</code></a> that just runs a command and saves V8 coverage data.</p><p>While c8 commands accept inline arguments, c8js functions accept in-code options.All <a href=\"https://origin-1.github.io/c8js/interfaces/default.Options.html\">c8js options</a> can be used in-code with all functions, but some options are only relevant to some of the functions.In-code options override options defined in .c8rc or another configuration file.</p><p>An important difference is that all c8js functions throw exceptions in situations where c8 commands would terminate the process with a nonzero exit code.</p><p>For detailed usage information, see the <a href=\"https://origin-1.github.io/c8js/modules\"><strong>API documentation</strong></a>.</p><h2 id=\"examples\">Examples</h2><h3 id=\"run-mocha\">Run Mocha</h3><p>This will run <code class=\"language-plaintext highlighter-rouge\">mocha --check-leaks --timeout=10000 test/*.spec.js</code> and produce <code class=\"language-plaintext highlighter-rouge\">html</code> and <code class=\"language-plaintext highlighter-rouge\">text-summary</code> coverage reports.</p><div class=\"language-js highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">async</span> <span class=\"kd\">function</span> <span class=\"nx\">runMocha</span><span class=\"p\">()</span><span class=\"p\">{</span>    <span class=\"kd\">const</span> <span class=\"p\">{</span> <span class=\"na\">default</span><span class=\"p\">:</span> <span class=\"nx\">c8js</span> <span class=\"p\">}</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"k\">import</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">c8js</span><span class=\"dl\">'</span><span class=\"p\">);</span>    <span class=\"k\">await</span> <span class=\"nx\">c8js</span>    <span class=\"p\">(</span>        <span class=\"dl\">'</span><span class=\"s1\">node_modules/mocha/bin/mocha.js</span><span class=\"dl\">'</span><span class=\"p\">,</span>        <span class=\"p\">[</span><span class=\"dl\">'</span><span class=\"s1\">--check-leaks</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">--timeout=10000</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">test/*.spec.js</span><span class=\"dl\">'</span><span class=\"p\">],</span>        <span class=\"p\">{</span> <span class=\"na\">reporter</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"dl\">'</span><span class=\"s1\">html</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">text-summary</span><span class=\"dl\">'</span><span class=\"p\">]</span> <span class=\"p\">},</span>    <span class=\"p\">);</span><span class=\"p\">}</span></code></pre></div></div><h3 id=\"run-with-npx\">Run with <code class=\"language-plaintext highlighter-rouge\">npx</code></h3><p>Similar to the previous example, but uses <code class=\"language-plaintext highlighter-rouge\">npx</code> to locate and run Mocha.<code class=\"language-plaintext highlighter-rouge\">npx</code> will download packages from the npm registry if necessary.</p><div class=\"language-js highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">async</span> <span class=\"kd\">function</span> <span class=\"nx\">runMocha</span><span class=\"p\">()</span><span class=\"p\">{</span>    <span class=\"kd\">const</span> <span class=\"p\">{</span> <span class=\"na\">default</span><span class=\"p\">:</span> <span class=\"nx\">c8js</span><span class=\"p\">,</span> <span class=\"nx\">commands</span> <span class=\"p\">}</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"k\">import</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">c8js</span><span class=\"dl\">'</span><span class=\"p\">);</span>    <span class=\"k\">await</span> <span class=\"nx\">c8js</span>    <span class=\"p\">(</span>        <span class=\"nx\">commands</span><span class=\"p\">.</span><span class=\"nx\">npx</span><span class=\"p\">,</span>        <span class=\"p\">[</span><span class=\"dl\">'</span><span class=\"s1\">mocha</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">--check-leaks</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">--timeout=10000</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">test/*.spec.js</span><span class=\"dl\">'</span><span class=\"p\">],</span>        <span class=\"p\">{</span> <span class=\"na\">reporter</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"dl\">'</span><span class=\"s1\">html</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">text-summary</span><span class=\"dl\">'</span><span class=\"p\">]</span> <span class=\"p\">},</span>    <span class=\"p\">);</span><span class=\"p\">}</span></code></pre></div></div><h3 id=\"run-npm-test\">Run <code class=\"language-plaintext highlighter-rouge\">npm test</code></h3><p>This will run <code class=\"language-plaintext highlighter-rouge\">npm test</code> with the default coverage options.</p><div class=\"language-js highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">async</span> <span class=\"kd\">function</span> <span class=\"nx\">runTest</span><span class=\"p\">()</span><span class=\"p\">{</span>    <span class=\"kd\">const</span> <span class=\"p\">{</span> <span class=\"na\">default</span><span class=\"p\">:</span> <span class=\"nx\">c8js</span><span class=\"p\">,</span> <span class=\"nx\">commands</span> <span class=\"p\">}</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"k\">import</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">c8js</span><span class=\"dl\">'</span><span class=\"p\">);</span>    <span class=\"k\">await</span> <span class=\"nx\">c8js</span><span class=\"p\">(</span><span class=\"nx\">commands</span><span class=\"p\">.</span><span class=\"nx\">npm</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"dl\">'</span><span class=\"s1\">test</span><span class=\"dl\">'</span><span class=\"p\">]);</span><span class=\"p\">}</span></code></pre></div></div><h3 id=\"run-node---test-nodejs--181\">Run <code class=\"language-plaintext highlighter-rouge\">node --test</code> (Node.js \u2265 18.1)</h3><p>Node.js 18.1 introduces the command line flag <code class=\"language-plaintext highlighter-rouge\">--test</code> that launches the built-in <a href=\"https://nodejs.org/dist/latest/docs/api/test.html\">Test runner</a>.The following function shows how to run <code class=\"language-plaintext highlighter-rouge\">node --test</code> with default coverage options.</p><div class=\"language-js highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">async</span> <span class=\"kd\">function</span> <span class=\"nx\">runTest</span><span class=\"p\">()</span><span class=\"p\">{</span>    <span class=\"kd\">const</span> <span class=\"p\">{</span> <span class=\"na\">default</span><span class=\"p\">:</span> <span class=\"nx\">c8js</span> <span class=\"p\">}</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"k\">import</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">c8js</span><span class=\"dl\">'</span><span class=\"p\">);</span>    <span class=\"k\">await</span> <span class=\"nx\">c8js</span><span class=\"p\">(</span><span class=\"nx\">process</span><span class=\"p\">.</span><span class=\"nx\">execPath</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"dl\">'</span><span class=\"s1\">--test</span><span class=\"dl\">'</span><span class=\"p\">]);</span><span class=\"p\">}</span></code></pre></div></div><p><strong>NOTE:</strong> Some versions of Node.js contain <a href=\"https://github.com/nodejs/node/issues/45013\">a bug</a> that causes <code class=\"language-plaintext highlighter-rouge\">node --test</code> to crash when run from c8.The affected Node.js versions are 18.11.0, 18.12.0, 18.12.1, 19.0.0 and 19.0.1.</p><h3 id=\"sharing-options\">Sharing Options</h3><p>To use c8js in different build scripts or packages with similar settings, it is useful to export a function that calls c8js with the set of shared options.This function can be imported by each build script and invoked with specific parameters.</p><div class=\"language-js highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">// create-coverage.js</span><span class=\"k\">export</span> <span class=\"k\">async</span> <span class=\"kd\">function</span> <span class=\"nx\">createCoverage</span><span class=\"p\">(</span><span class=\"nx\">options</span><span class=\"p\">)</span><span class=\"p\">{</span>    <span class=\"kd\">const</span> <span class=\"p\">{</span> <span class=\"na\">default</span><span class=\"p\">:</span> <span class=\"nx\">c8js</span><span class=\"p\">,</span> <span class=\"nx\">commands</span> <span class=\"p\">}</span> <span class=\"o\">=</span> <span class=\"k\">await</span> <span class=\"k\">import</span><span class=\"p\">(</span><span class=\"dl\">'</span><span class=\"s1\">c8js</span><span class=\"dl\">'</span><span class=\"p\">);</span>    <span class=\"k\">await</span> <span class=\"nx\">c8js</span>    <span class=\"p\">(</span>        <span class=\"nx\">commands</span><span class=\"p\">.</span><span class=\"nx\">npm</span><span class=\"p\">,</span>        <span class=\"p\">[</span><span class=\"dl\">'</span><span class=\"s1\">test</span><span class=\"dl\">'</span><span class=\"p\">],</span>        <span class=\"p\">{</span>            <span class=\"na\">all</span><span class=\"p\">:</span>            <span class=\"kc\">true</span><span class=\"p\">,</span>            <span class=\"na\">src</span><span class=\"p\">:</span>            <span class=\"dl\">'</span><span class=\"s1\">lib</span><span class=\"dl\">'</span><span class=\"p\">,</span>            <span class=\"na\">throwExecError</span><span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">late</span><span class=\"dl\">'</span><span class=\"p\">,</span>            <span class=\"na\">watermarks</span><span class=\"p\">:</span>            <span class=\"p\">{</span>                <span class=\"na\">branches</span><span class=\"p\">:</span>   <span class=\"p\">[</span><span class=\"mi\">90</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">],</span>                <span class=\"na\">functions</span><span class=\"p\">:</span>  <span class=\"p\">[</span><span class=\"mi\">90</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">],</span>                <span class=\"na\">lines</span><span class=\"p\">:</span>      <span class=\"p\">[</span><span class=\"mi\">90</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">],</span>                <span class=\"na\">statements</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"mi\">90</span><span class=\"p\">,</span> <span class=\"mi\">100</span><span class=\"p\">],</span>            <span class=\"p\">},</span>            <span class=\"p\">...</span><span class=\"nx\">options</span><span class=\"p\">,</span>        <span class=\"p\">}</span>    <span class=\"p\">);</span><span class=\"p\">}</span></code></pre></div></div><div class=\"language-js highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">// build.js</span><span class=\"k\">import</span> <span class=\"p\">{</span> <span class=\"nx\">createCoverage</span> <span class=\"p\">}</span> <span class=\"k\">from</span> <span class=\"dl\">'</span><span class=\"s1\">./create-coverage.js</span><span class=\"dl\">'</span><span class=\"p\">;</span><span class=\"k\">await</span> <span class=\"nx\">createCoverage</span><span class=\"p\">({</span> <span class=\"na\">src</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"dl\">'</span><span class=\"s1\">lib</span><span class=\"dl\">'</span><span class=\"p\">,</span> <span class=\"dl\">'</span><span class=\"s1\">src/app</span><span class=\"dl\">'</span><span class=\"p\">],</span> <span class=\"na\">timeout</span><span class=\"p\">:</span> <span class=\"mi\">300</span> <span class=\"o\">*</span> <span class=\"mi\">1000</span> <span class=\"p\">});</span></code></pre></div></div><h2 id=\"compatibility\">Compatibility</h2><p>c8js requires Node.js 14 or later.</p>      <footer class=\"site-footer\">                  <span class=\"site-footer-owner\"><a href=\"https://github.com/origin-1/c8js\">c8js</a> is maintained by <a href=\"https://github.com/origin-1\">origin-1</a>.</span>                <span class=\"site-footer-credits\">This page was generated by <a href=\"https://pages.github.com\">GitHub Pages</a>.</span>      </footer>    </main>  </body></html>",
  "embeddings": []
}